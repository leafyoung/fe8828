---
title: "Secretary Problem"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list=ls())
```

### Step 1: make_choice function
Create the make_choice function

```{r make_choice}

make_choice <- function(N, split_number){
  
  input_list <- sample(1:N, N, replace = FALSE, rep(1/N,N))
  
  eval_group <- input_list[1:split_number]
  select_group <- input_list[(split_number+1):N]
  
  eval_best <- max(eval_group)
  
  for(i in select_group){
    
    if(i >= eval_best){
      return(i)
    }
    
  }
  
  return(tail(select_group,1))

}

choice <- make_choice(100, 35)
print(choice)

```

### Step 1.5 Test Simulation
Run the make_choice function a few hundred times, with N=100 and split_number=2.
Find the probability of getting N=100

```{r test_simulation}

N <- 100
split_number <- 2

iterations <- 1000
hit_num <- 0

for (i in 1:iterations) {
  
  try <- make_choice(N, split_number)
  
  if(try == N){
    hit_num <- hit_num + 1
  }
}

prob = (hit_num/iterations)
print(prob)

```

### Step 2: find_optimal function
Create the find_optimal function

```{r}

find_optimal <- function(N){
  
  highest_prob <- 0
  optimal_split <- 0
  
  iterations <- 1000
  
  for(i in 1:ceiling(N/2)){
    
    hit_num <- 0
    
    for(j in 1:iterations){
      
      try <- make_choice(N, i)
  
      if(try == N){
        hit_num <- hit_num + 1
      }
      
    }
    
    if((hit_num/iterations) > highest_prob){
      highest_prob <- hit_num/iterations
      optimal_split <- i
    }
    
  }
  
  results = c(optimal_split, highest_prob)
  return(results)
  
}

```

### Step 3: Find Solutions
Find solutions for when N = 3, 10, 100

```{r}
a <- find_optimal(3)
b <- find_optimal(10)
c <- find_optimal(100)

a
b
c
```

The optimal value for the split for 3 is around `r a[1]` with an approximate probability of `r a[2]*100` % getting the best.  
The optimal value for the split for 10 is around `r b[1]` with an approximate probability of  `r b[2]*100` "% getting the best.  
The optimal value for the split for 100 is around `r c[1]` with an approximate probability of `r c[2]*100` "% getting the best.  