theme(axis.text.x = element_text(angle = 45,hjust = 1))
ggplot(bank,aes(x=balance,fill=housing
))+geom_histogram(binwidth = 1000)
ggplot(data=bank,aes(age,balance))+
geom_point()+geom_smooth()+facet_grid(.~housing)
ggplot(bank, aes(age, balance))+ stat_density2d(aes(fill = ..level..), geom="polygon")+ scale_fill_continuous(high='darkred',low='orange')
ggplot(bank,aes(duration))+
geom_area(aes(fill=marital),stat="bin",alpha=0.6)
library(tidyverse)
library(lubridate)
library(bizdays)
library(dplyr)
# Use echo = TRUE for assignment is an exception, so code is visible.
knitr::opts_chunk$set(echo = TRUE, fig.align="center", collapse = TRUE, cache = TRUE)
# bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
#Student is the least likely customer group (unknown not considered as it gives no information)
group_by(bank,job) %>% summarise(PiecesOfRecord=n())
#Here displays the highest and lowest balance of each employment group
#The occupation seems not a factor affecting the balance amount
group_by(bank,job) %>%
filter(min_rank((balance))==1|min_rank(desc(balance))==1) %>%
arrange(job,balance)
# Plot the graph between the duration and the duration counts
# The number of records significantly decreases as the duration increases
bank %>%
group_by(dur_group = (duration%/% 100) * 100) %>%
summarise(count = n()) %>%
arrange(dur_group) -> durationPlot
durationPlot
plot(durationPlot$dur_group, durationPlot$count)
# Based on this data set, the married people are the most likely to have a negative balance
# Meanwhile, the married are the main customers as well as they occupy the largest portion among single, married and divorced.
c1<-group_by(bank,marital)%>%
summarise('Balance<0'= sum(balance<0))
c2<-group_by(bank,marital)%>%
summarise('0<Balance<10000'= sum(balance>0 && balance < 10000))
c3<-group_by(bank,marital)%>%
summarise('Balance>10000'= sum(balance>10000))
df<-distinct(bank,marital)%>%
arrange(marital)
df<-left_join(df,c1,by="marital")
df<-left_join(df,c2,by="marital")
df<-left_join(df,c3,by="marital")
df
#More than half of the top ten people with the greatest balance doesn't have a housing
#There is a large gap between the balance of the people ranked first ($71188) and second ($42045)
#The rest eight are holding a balance around a similar level ($20000)
df2<-arrange(bank,balance)%>%
{
bind_rows(tail(.,n=10))
}
df2
df3<-arrange(df2,housing)
df3<-mutate(df3,housing = ifelse(housing =="yes",1,0))
df3
#Among the top 30 people with the most negative balance, 25 of them has a housing
df4<-arrange(bank,balance)%>%
{
bind_rows(head(.,n=30))
}
df4
df5<-arrange(df4,housing)
df5<-mutate(df5,housing2 = ifelse(housing =="yes",T,F))
df5
group_by(df5,housing2)%>%
summarise(Total=n())
#There seems no significant balance difference between people from different education background
df6<-filter(bank,education=="primary")%>%
summarise(balance=mean(balance))%>%
rename('Primary Balance'=balance)
df7<-filter(bank,education=="secondary")%>%
summarise(balance=mean(balance))%>%
rename('Secondary Balance'=balance)
df8<-filter(bank,education=="tertiary")%>%
summarise(balance=mean(balance))%>%
rename('Tertiary Balance'=balance)
df9<-filter(bank,education=="unknown")%>%
summarise(balance=mean(balance))%>%
rename('Unknown Balance'=balance)
df10<-bind_cols(df6,df7,df8,df9)
df10
library(conflicted)
library(tidyverse)
conflict_prefer("lag", "dplyr")
conflict_prefer("filter", "dplyr")
# bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
options(dplyr.summarise.inform = FALSE)
#Insight 1: The majority of people doesn't involve with loans and a high balance is expected around age 40.
ggplot(bank,aes(x=age,y=balance,color=loan)) +
geom_point() +
theme(legend.position = "right")
#Insight 2: The largest variance of balance occurs in the tertiary education group
ggplot(bank,aes(age,balance,color=loan,alpha=0.5))+
geom_point()+
facet_grid(.~education)
#Insight 3: Most of the duration is within 1000 days. Technicians,blue-collars and people work in management are the three main customers.
ggplot(bank,aes(duration,fill=job))+
geom_histogram(binwidth = 30)
ggplot(bank,aes(duration,fill=job))+
geom_histogram(binwidth = 30,position = "fill")+
coord_flip()
#Insight 4:The highest mean of balance occurs around age 68. Older people are expected to have a greater balance.
ggplot(bank,aes(age,balance))+
stat_summary(aes(age,balance),
fun.min = min,
fun.max = max,
fun = mean,
geom = "pointrange")
#Insight 5: The largest custormer groups works in management with a tertiary background.
ggplot(bank)+
geom_bar(aes(job,fill=marital,position="fill"))+
coord_polar()
#Insight 6: Campaigns are preferred by people with an education background higher than primary. A small number of campaigns are expected for the customer majoriy.
ggplot(bank)+
geom_line(aes(x=campaign,y=balance,color=education))
Sys.setlocale("LC_TIME", "English")
library(tidyverse)
library(lubridate)
library(bizdays)
library(ggplot2)
library(Hmisc)
# Use echo = TRUE for assignment is an exception, so code is visible.
knitr::opts_chunk$set(echo = TRUE, fig.align="center", collapse = TRUE, cache = TRUE)
bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
bank2 <- mutate(bank, Month = case_when(
month == "jan" ~ 1,month == "feb" ~ 2,month == "mar" ~ 3,month == "apr" ~ 4,
month == "may" ~ 5,month == "jun" ~ 6,month == "jul" ~ 7,month == "aug" ~ 8,
month == "sep" ~ 9,month == "oct" ~ 10,month == "nov" ~ 11,month == "dec" ~ 12
))
bank2 %>% group_by(Month) %>%
summarise(balance_sum = sum(balance)) %>%
arrange(as.Date(Month,format="%b",origin = Sys.Date()))-> res1
ggplot(res1) + geom_line(aes(x=Month, y=balance_sum)) +
scale_x_discrete(limit = levels(factor(res1$Month)))
bank %>% group_by(marital) %>% summarise(mean_balance=mean(balance)) -> res2
ggplot(res2) + geom_bar(aes(x=marital, y=mean_balance),stat="identity")
bank %>% group_by(age) %>% summarise(mean_balance=mean(balance)) -> res3
ggplot(res3) + geom_bar(aes(x=age, y=mean_balance),stat="identity")+theme(text = element_text(size=12),
axis.text.x = element_text(angle=45, hjust=1))
ggplot(bank) +
geom_point(mapping = aes(x = education, y = balance)) +
facet_grid( ~ marital)
bank %>% group_by(campaign) %>% summarise(mean_balance=mean(balance)) -> res2
ggplot(res2) + geom_bar(aes(x=campaign, y=mean_balance),stat="identity")
ggplot(bank, aes(balance)) +
geom_density(aes(fill = loan), alpha = 0.7) +
xlim(1, 10) + theme(text = element_text(size=8))
Sys.setlocale("LC_TIME", "English")
library(tidyverse)
library(lubridate)
library(bizdays)
library(ggplot2)
library(Hmisc)
# Use echo = TRUE for assignment is an exception, so code is visible.
knitr::opts_chunk$set(echo = TRUE, fig.align="center", collapse = TRUE, cache = TRUE)
# bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
Sys.setlocale("LC_TIME", "English")
library(tidyverse)
library(lubridate)
library(bizdays)
library(ggplot2)
library(Hmisc)
# Use echo = TRUE for assignment is an exception, so code is visible.
knitr::opts_chunk$set(echo = TRUE, fig.align="center", collapse = TRUE, cache = TRUE)
# bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
bank %>%
group_by(education) %>%
summarise(default_ratio = sum(ifelse(default == "no",0,1))/n()) ->res1
ggplot(res1) + geom_bar(aes(x=education, y=default_ratio),stat="identity")
bank2 <- mutate(bank, Month = case_when(
month == "jan" ~ 1,month == "feb" ~ 2,month == "mar" ~ 3,month == "apr" ~ 4,
month == "may" ~ 5,month == "jun" ~ 6,month == "jul" ~ 7,month == "aug" ~ 8,
month == "sep" ~ 9,month == "oct" ~ 10,month == "nov" ~ 11,month == "dec" ~ 12
))
bank2 %>% group_by(Month) %>%
summarise(balance_sum = sum(balance)) %>%
arrange(as.Date(Month,format="%b",origin = Sys.Date()))-> res2
ggplot(res2) + geom_line(aes(x=Month, y=balance_sum)) +
scale_x_discrete(limit = levels(factor(res2$Month)))
ggplot(bank, aes(balance)) + geom_density() + xlim(0,20000)
bank %>% group_by(marital) %>% summarise(mean_balance=mean(balance)) -> res4
ggplot(res4) + geom_bar(aes(x=marital, y=mean_balance),stat="identity")
ggplot(bank) + geom_bar(aes(x=job)) +
theme(text = element_text(size=16),
axis.text.x = element_text(angle=45, hjust=1))
bank %>% group_by(age) %>% summarise(mean_balance=mean(balance)) -> res6
ggplot(res6) + geom_bar(aes(x=age, y=mean_balance),stat="identity")+theme(text = element_text(size=12),
axis.text.x = element_text(angle=45, hjust=1))
res7 <- filter(bank, job=="student",marital =="divorced")
count(res7, marital =="divorced")
Sys.setlocale("LC_TIME", "English")
library(tidyverse)
library(lubridate)
library(bizdays)
library(ggplot2)
library(Hmisc)
# Use echo = TRUE for assignment is an exception, so code is visible.
knitr::opts_chunk$set(echo = TRUE, fig.align="center", collapse = TRUE, cache = TRUE)
# bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
bank %>%
group_by(education) %>%
summarise(default_ratio = sum(ifelse(default == "no",0,1))/n()) ->res1
ggplot(res1) + geom_bar(aes(x=education, y=default_ratio),stat="identity")
bank2 <- mutate(bank, Month = case_when(
month == "jan" ~ 1,month == "feb" ~ 2,month == "mar" ~ 3,month == "apr" ~ 4,
month == "may" ~ 5,month == "jun" ~ 6,month == "jul" ~ 7,month == "aug" ~ 8,
month == "sep" ~ 9,month == "oct" ~ 10,month == "nov" ~ 11,month == "dec" ~ 12
))
bank2 %>% group_by(Month) %>%
summarise(balance_sum = sum(balance)) %>%
arrange(as.Date(Month,format="%b",origin = Sys.Date()))-> res2
ggplot(res2) + geom_line(aes(x=Month, y=balance_sum)) +
scale_x_discrete(limit = levels(factor(res2$Month)))
ggplot(bank, aes(balance)) + geom_density() + xlim(0,20000)
bank %>% group_by(marital) %>% summarise(mean_balance=mean(balance)) -> res4
ggplot(res4) + geom_bar(aes(x=marital, y=mean_balance),stat="identity")
ggplot(bank) + geom_bar(aes(x=job)) +
theme(text = element_text(size=16),
axis.text.x = element_text(angle=45, hjust=1))
bank %>% group_by(age) %>% summarise(mean_balance=mean(balance)) -> res6
ggplot(res6) + geom_bar(aes(x=age, y=mean_balance),stat="identity")+theme(text = element_text(size=12),
axis.text.x = element_text(angle=45, hjust=1))
res7 <- filter(bank, job=="student",marital =="divorced")
count(res7, marital =="divorced")
library("conflicted")
library("dplyr")
library(scales)
library(lubridate)
library(bizdays)
conflict_prefer("filter","dplyr")
conflict_prefer("tag","dplyr")
knitr::opts_chunk$set(echo = TRUE)
# bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
#View(bank)
bank <- rename(bank,p_loan="loan",term_dpt="y")
contact_percent <- nrow(filter(bank,duration<600))/nrow(bank)
hist(bank$duration/60, main="Distribution of Contact Duration", xlab="Minutes")
contact_job <- bank%>%
group_by(job)%>%
summarise(
count=n(),
mean_duration=mean(duration),
success=sum(ifelse(poutcome=="success",1,0))
) %>%
mutate(success_rate=percent(success/count))%>%
arrange(mean_duration)
bank_default_age <- mutate(bank,age_group=(age%/%10)*10) %>%
group_by(age_group)%>%
summarise(
count=n(),
dft_count=sum(ifelse(default=="yes",1,0)))%>%
mutate(dft_rate=dft_count/count)
plot(data.frame(age_group=bank_default_age$age_group,default_rate=bank_default_age$dft_rate))
bank_mblance<- bank %>%
group_by(job)%>%
summarise(
mean_balance=mean(balance))%>%
arrange(mean_balance)
print(bank_mblance)
job_marriage <- bank %>%
group_by(job)%>%
summarise(
count=n(),
single= sum(ifelse(marital=="single"|marital=="divorced",1,0)),
mean_balance=mean(balance))%>%
mutate(single_ratio=single/count)%>%
arrange(single_ratio)
print(job_marriage)
campaign_sucs1 <- bank %>%
filter(p_loan =="yes"|housing =="yes")%>%
group_by(marital)%>%
summarise(
count=n(),
camp_success= sum(ifelse(poutcome=="success",1,0)),
mean_balance=mean(balance))%>%
mutate(success_ratio=camp_success/count)%>%
mutate(loan="yes")%>%
arrange(success_ratio)
campaign_sucs2 <- bank %>%
filter(p_loan=="no", housing=="no")%>%
group_by(marital)%>%
summarise(
count=n(),
camp_success= sum(ifelse(poutcome=="success",1,0)),
mean_balance=mean(balance))%>%
mutate(success_ratio=camp_success/count)%>%
mutate(loan="no")%>%
arrange(success_ratio)%>%
rbind(.,campaign_sucs1)
campaign_sucs2$success_ratio <-  percent(campaign_sucs2$success_ratio,accuracy=0.01)
print(campaign_sucs2)
job_edu <- bank %>%
group_by(job)%>%
summarise(
count=n(),
Primary=sum(ifelse(education=="primary",1,0)),
Secondary=sum(ifelse(education=="secondary",1,0)),
Tertiary=sum(ifelse(education=="tertiary",1,0)))%>%
mutate(Primary=percent(Primary/count))%>%
mutate(Secondary=percent(Secondary/count))%>%
mutate(Tertiary=percent(Tertiary/count))%>%
arrange(.,Tertiary)
print(job_edu)
library("conflicted")
library("dplyr")
library(forcats)
library(scales)
library(lubridate)
library(bizdays)
library(ggplot2)
#library(hrbrthemes)
conflict_prefer("filter","dplyr")
conflict_prefer("tag","dplyr")
knitr::opts_chunk$set(echo = TRUE)
# bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
#View(bank)
bank <- rename(bank,p_loan="loan",term_dpt="y")
source('E:/Dropbox/MFE/FE8828/2020/Assignment-2020/init.R')
library("conflicted")
library("dplyr")
library(forcats)
library(scales)
library(lubridate)
library(bizdays)
library(ggplot2)
#library(hrbrthemes)
conflict_prefer("filter","dplyr")
conflict_prefer("tag","dplyr")
knitr::opts_chunk$set(echo = TRUE)
# bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
#View(bank)
bank <- rename(bank,p_loan=loan,term_dpt=y)
ggplot(bank, aes(x = duration/60,color = job))+geom_density()+theme(legend.position="right")+
scale_x_continuous(name="Duration (Min)")+
scale_y_continuous(name="Density")+
ggtitle("Distribution of Contact Time By Job")
contact_job <- bank%>%
group_by(job)%>%
summarise(
count=n(),
mean_duration=mean(duration),
success=sum(ifelse(poutcome=="success",1,0))
) %>%
mutate(success_rate=success/count)
ggplot(contact_job,aes(x=fct_reorder(job,success_rate),y=success_rate))+
geom_bar(stat='identity',fill="blue")+
geom_point(aes(x=fct_reorder(job,success_rate),y=mean_duration/5000),color='black',size=4)+
scale_y_continuous(
name = "Success Rate of Contact",
sec.axis = sec_axis(~.*5000,name="Mean Duration (Min)"))+
theme_bw()+
theme(
axis.title.y = element_text(color = "blue",size = 10),
axis.title.y.right = element_text(color = "black",size=10),
axis.text.x = element_text(angle=90,size=10))+
ggtitle("Success Rate vs Mean Duration Of Contact")
bank_loan <- filter(bank,poutcome=="success")%>%
mutate(Loan_Status=ifelse( (housing =="no") & (p_loan=="no"),"No Loan","Have Loan"))
ggplot(bank_loan,aes(x=age,y=balance/200))+
stat_summary(fun = "mean",geom="line")+stat_summary(fun = "mean",geom="point")+
#for self note: use fill, not color for bar chart or histogram!
geom_histogram(binwidth = 10,mapping=aes(age,fill=Loan_Status),color = "black",alpha=0.5,inherit.aes = F)+
scale_x_continuous(breaks=seq(20,80,by=10), name = "Age Group")+
scale_y_continuous(
name = "Mean Balance/200 (Line)",
sec.axis = sec_axis(~.*1,name="Number of Success (Bar)")
)+
scale_fill_manual(values= c("blue", "orange"))+
theme_bw()+
ggtitle("Breakdown Of Successful Cases By Age, Loan Status and Balance")
ggplot(bank,aes(x=reorder(job,age,FUN="mean"),fill=marital))+geom_bar(position="fill")+
theme( axis.text.x=element_text(angle=90))+
ggtitle("Marital Status By Job")
ggplot(bank, aes(age, color = marital, fill = marital, alpha = 0.3)) +
geom_density() + theme_bw()+
ggtitle("Marital Status By Age")
ggplot(bank)+geom_bar(aes(education,fill=marital),position="fill")+
ggtitle("Education vs Marital Status")
source('E:/Dropbox/MFE/FE8828/2020/Assignment-2020/init.R')
library(tidyverse)
library(lubridate)
library(bizdays)
library(conflicted)
conflict_prefer("filter","dplyr")
conflict_prefer("lag","dplyr")
# Use echo = TRUE for assignment is an exception, so code is visible.
knitr::opts_chunk$set(echo = TRUE, fig.align="center", collapse = TRUE, cache = TRUE)
# bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
bank%>%
dplyr::filter(marital == "single" & housing == "no")%>%
group_by(age)%>%
summarise(count = n()) -> res
res
ggplot(res,aes(x=age,y=count))+geom_bar(stat="identity")
distinct(bank,education)
bank %>%
group_by(education) %>%
filter(min_rank(balance) == 1 | min_rank(desc(balance)) == 1) %>%
arrange(education,balance)
distinct(bank,job)
temp <- bank %>%
group_by(job) %>%
summarise(count = n(), "balance <= 1000" = sum(balance <= 1000), "balance >= 1000" = sum(balance >= 1000))
bank %>%
group_by(job) %>%
summarise(max_age = max(age), median_age = median(age), min_age = min(age)) %>%
left_join(temp)
nrow(bank$poutcome == "unknown") == nrow(bank$pday == -1)
#means all the clients with unknown outcomes are those who have no previous contact
bank %>%
group_by(poutcome) %>%
summarise("mean_duration" = mean(duration), "mean_past_day" = mean(pdays))
df1 <- bank %>%
group_by(age,housing) %>%
summarise(mean_bal = mean(balance)) %>%
filter(age >40 & age <50)
df1
ggplot(df1,aes(x=age,y=mean_bal, fill=housing)) + geom_bar(stat="identity")
#multi-level
df_sum1 <- bank %>% group_by(job,education)%>%
summarise("mean(age)" = mean(age,na.rm = TRUE),
"mean(bal)" = mean(balance,na.rm = TRUE))
df_sum1
df_sum2 <- bank %>% group_by(job,education = "+")%>%
summarise("mean(age)" = mean(age,na.rm = TRUE),
"mean(bal)" = mean(balance,na.rm = TRUE))
df_sum2
df_sum3 <- bank %>% group_by(job = "+",education = "+")%>%
summarise("mean(age)" = mean(age,na.rm = TRUE),
"mean(bal)" = mean(balance,na.rm = TRUE))
df_sum3
mean_age_bal <- bind_rows(df_sum1,df_sum2,df_sum3)
mean_age_bal
bank %>%
mutate(education = case_when(
education == "primary" ~ 1,
education == "secondary" ~ 2,
education == "tertiary" ~ 3,
education == "unknown" ~ 0
)) %>%
group_by(education, default)%>%
summarise(n = n()) %>%
mutate(prob = n / sum(n))
library(tidyverse)
library(lubridate)
library(bizdays)
library(conflicted)
conflict_prefer("filter","dplyr")
conflict_prefer("lag","dplyr")
# Use echo = TRUE for assignment is an exception, so code is visible.
knitr::opts_chunk$set(echo = TRUE, fig.align="center", collapse = TRUE, cache = TRUE)
# bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
df1 <- bank %>%
group_by(age,housing) %>%
summarise(mean_bal = mean(balance))%>%
# case_when is a function to deal multiple choices.
mutate(age_group = case_when(
age < 30 ~ "youth",
age < 50 ~ "middle-age",
age < 60 ~ "senior",
TRUE ~ "elder" ))
df1
filter(df1,age >=20 & age <40) %>%
ggplot(aes(x=age,y=mean_bal, fill=housing)) + geom_bar(stat="identity")
filter(df1,age >=40 & age <60) %>%
ggplot(aes(x=age,y=mean_bal, fill=housing)) + geom_bar(stat="identity")
bank %>%
mutate(education = case_when(
education == "primary" ~ 1,
education == "secondary" ~ 2,
education == "tertiary" ~ 3,
education == "unknown" ~ 0
)) %>%
group_by(education, default)%>%
summarise(n = n()) %>%
mutate(prob = n / sum(n))
ggplot(bank) +
geom_bar(aes(x = education, fill = default), position = "fill")+
ylim(0,0.1)
#Because the percent of people with default record is too small, here I limit the ylim to 0-0.1 to have a clearer comparison between different education group.
distinct(bank,education)
df <- bank %>%
group_by(education) %>%
filter(min_rank(balance) == 1 | min_rank(desc(balance)) == 1) %>%
arrange(education,balance)
df
ggplot(df,aes(education,balance))+
geom_boxplot()
group_by(bank,duration,month) %>% summarize(nn = n()) %>%
ggplot(.)+
geom_point(aes(duration,month,size=nn))+
scale_y_discrete(limit = rev(levels(factor(bank$month)))) #order
library(tidyverse)
library(ggplot2)
library(knitr)
knitr::opts_chunk$set(echo = TRUE, fig.align="center", collapse = TRUE, cache = T)
# bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
AgeGrpTable <- mutate(bank, AgeGroup = (age %/% 10) * 10)
ggplot(AgeGrpTable, aes(AgeGroup, duration, group = AgeGroup)) + geom_point() + geom_boxplot() + stat_summary(fun.y = mean,geom = "point", colour="blue", size=3)
fun_mean <- function(x){
mean(x) %>%
data.frame(y=.,label=mean(x,na.rm=T))}
ggplot(bank, aes(y, duration)) + geom_boxplot() + geom_point() +
stat_summary(fun.y = mean,geom = "point", colour="blue", size=3) +
stat_summary(fun.data=fun_mean, geom="text", vjust= -0.5)
mutate(AgeGrpTable, OldOrYoung = ifelse(AgeGroup >= 60, "Old People", "Young People")) %>% ggplot(.) + geom_bar(mapping = aes(x=OldOrYoung, fill=y), position = "fill") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(bank) + geom_bar(mapping = aes(x=education, fill = contact), position = "fill") + coord_flip()
EmployTable <- mutate(bank, employment = ifelse(job == "admin." | job == "blue-collar" | job == "entrepreneur" |job == "management" |job == "self-employed" |job == "services" |job == "technician", "Employed", "No Job"))
ggplot(EmployTable) + geom_bar(aes(x = employment, fill = marital), position = "fill")
ggplot(bank) + geom_bar(mapping = aes(x=education, fill = marital), position = "fill")
library(tidyverse)
library(lubridate)
