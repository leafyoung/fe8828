for (i in seq_along(n)){
n[i] = ((i-1) %/% 20)+1
m[i] = ((i-1) %% 20) +1 }
a$x <- n; a$y <- m
cols <- c("False Neg" = "red", "Actual Pos" = "blue", "False Pos" = "green", "Actual Neg" = "grey")
ggplot(a) +
geom_point(aes(y, x,colour = color),
size = 4, shape="circle") + scale_colour_manual(values = cols) + scale_y_reverse() +
theme_bw() +
theme(axis.title.x=element_blank(), axis.title.y=element_blank(),
axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),panel.border = element_blank())    }
, width = 400, height = 200)
output$distPlot3 <- renderPlot({
a <- test()
a <- filter(a, (color == 'Actual Pos') | (color == 'False Pos') )
n <- rep(1,nrow(a)); m <- rep(1,nrow(a))
for (i in seq_along(n)){
n[i] = ((i-1) %/% 20)+1
m[i] = ((i-1) %% 20) +1 }
a$x <- n; a$y <- m
cols <- c("False Neg" = "red", "Actual Pos" = "blue", "False Pos" = "darkgreen", "Actual Neg" = "grey")
ggplot(a) +
geom_point(aes(y, x,colour = color),
size = 4, shape="circle") + scale_colour_manual(values = cols) +scale_y_reverse() +
theme_bw() +
theme(axis.title.x=element_blank(), axis.title.y=element_blank(),
axis.line=element_blank(),axis.text.x=element_blank(),
axis.text.y=element_blank(),axis.ticks=element_blank(),panel.border = element_blank())    }
, width = 400, height = 200)
}
# Run the application
shinyApp(ui = ui, server = server)
---
title: "ASM4_2"
output: html_document
---
## R Markdown
```{r}
library(alphavantager)
library(shiny)
setwd("C:/Users/YANG XUANRUI/Desktop/NTU/course/MT2-Programming Web Applications in Finance/Assignment4/data")
# av_api_key("WZST1Q60LI2GUIVW")
# AIG <- av_get("AIG", av_fun = "TIME_SERIES_DAILY_ADJUSTED")
# BRK <- av_get("BRK.B", av_fun = "TIME_SERIES_DAILY_ADJUSTED")
# AON <- av_get("AON", av_fun = "TIME_SERIES_DAILY_ADJUSTED")
# MET <- av_get("MET", av_fun = "TIME_SERIES_DAILY_ADJUSTED")
# SPY <- av_get("SPY", av_fun = "TIME_SERIES_DAILY_ADJUSTED")
# write.csv(AIG, file = "AIG.csv", row.names = TRUE, na = "")
# write.csv(BRK, file = "BRK.csv", row.names = TRUE, na = "")
# write.csv(AON, file = "AON.csv", row.names = TRUE, na = "")
# write.csv(MET, file = "MET.csv", row.names = TRUE, na = "")
# write.csv(SPY, file = "SPY.csv", row.names = TRUE, na = "")
AIG <- read.csv("AIG.csv", header = TRUE)
BRK <- read.csv("BRK.csv", header = TRUE)
AON <- read.csv("AON.csv", header = TRUE)
MET <- read.csv("MET.csv", header = TRUE)
SPY <- read.csv("SPY.csv", header = TRUE)
```
```{r}
initial <- 1e6
r_f <- 1/250
## Distributed invested capital to four stocks
AIG_n <- (inv * 0.25 *0.9) %/% AIG$adjusted_close[1]
AON_n <- (inv * 0.25 *0.9) %/% AON$adjusted_close[1]
BRK_n <- (inv * 0.25 *0.9) %/% BRK$adjusted_close[1]
MET_n <- (inv * 0.25 *0.9) %/% MET$adjusted_close[1]
AIG_value <- AIG_n * AIG$adjusted_close
AON_value <- AON_n * AON$adjusted_close
BRK_value <- BRK_n * BRK$adjusted_close
MET_value <- MET_n * MET$adjusted_close
cash <- initial - AIG_value[1] - AON_value[1] - BRK_value[1]- MET_value[1]
Tot_value <- AIG_value + AON_value + BRK_value +  MET_value
Return <- Tot_value[-1]/Tot_value[-length(Tot_value)]
```
library(alphavantager)
library(shiny)
setwd("C:/Users/YANG XUANRUI/Desktop/NTU/course/MT2-Programming Web Applications in Finance/Assignment4/data")
# av_api_key("WZST1Q60LI2GUIVW")
# AIG <- av_get("AIG", av_fun = "TIME_SERIES_DAILY_ADJUSTED")
# BRK <- av_get("BRK.B", av_fun = "TIME_SERIES_DAILY_ADJUSTED")
# AON <- av_get("AON", av_fun = "TIME_SERIES_DAILY_ADJUSTED")
# MET <- av_get("MET", av_fun = "TIME_SERIES_DAILY_ADJUSTED")
# SPY <- av_get("SPY", av_fun = "TIME_SERIES_DAILY_ADJUSTED")
# write.csv(AIG, file = "AIG.csv", row.names = TRUE, na = "")
# write.csv(BRK, file = "BRK.csv", row.names = TRUE, na = "")
# write.csv(AON, file = "AON.csv", row.names = TRUE, na = "")
# write.csv(MET, file = "MET.csv", row.names = TRUE, na = "")
# write.csv(SPY, file = "SPY.csv", row.names = TRUE, na = "")
AIG <- read.csv("AIG.csv", header = TRUE)
BRK <- read.csv("BRK.csv", header = TRUE)
AON <- read.csv("AON.csv", header = TRUE)
MET <- read.csv("MET.csv", header = TRUE)
SPY <- read.csv("SPY.csv", header = TRUE)
initial <- 1e6
r_f <- 1/250
## Distributed invested capital to four stocks
AIG_n <- (inv * 0.25 *0.9) %/% AIG$adjusted_close[1]
inv <- initial * 0.9
initial <- 1e6
inv <- initial * 0.9
r_f <- 1/250
## Distributed invested capital to four stocks
AIG_n <- (inv * 0.25 *0.9) %/% AIG$adjusted_close[1]
AON_n <- (inv * 0.25 *0.9) %/% AON$adjusted_close[1]
BRK_n <- (inv * 0.25 *0.9) %/% BRK$adjusted_close[1]
MET_n <- (inv * 0.25 *0.9) %/% MET$adjusted_close[1]
AIG_value <- AIG_n * AIG$adjusted_close
AON_value <- AON_n * AON$adjusted_close
BRK_value <- BRK_n * BRK$adjusted_close
MET_value <- MET_n * MET$adjusted_close
cash <- initial - AIG_value[1] - AON_value[1] - BRK_value[1]- MET_value[1]
Tot_value <- AIG_value + AON_value + BRK_value +  MET_value
Return <- Tot_value[-1]/Tot_value[-length(Tot_value)]
Return <- Tot_value[-1]/Tot_value[-length(Tot_value)]-1
initial <- 1e6
inv <- initial * 0.9
r_f <- 1/250
## Distributed invested capital to four stocks
AIG_n <- (inv * 0.25 *0.9) %/% AIG$adjusted_close[1]
AON_n <- (inv * 0.25 *0.9) %/% AON$adjusted_close[1]
BRK_n <- (inv * 0.25 *0.9) %/% BRK$adjusted_close[1]
MET_n <- (inv * 0.25 *0.9) %/% MET$adjusted_close[1]
AIG_value <- AIG_n * AIG$adjusted_close
AON_value <- AON_n * AON$adjusted_close
BRK_value <- BRK_n * BRK$adjusted_close
MET_value <- MET_n * MET$adjusted_close
Tot_value <- AIG_value + AON_value + BRK_value +  MET_value
Return <- Tot_value[-1]/Tot_value[-length(Tot_value)]-1
cash <- rep(1,length(AIG_n))
cash[1] <- initial - AIG_value[1] - AON_value[1] - BRK_value[1]- MET_value[1]
for( i in 2:length(cash)){
cash[i] <- cash[i-1] * (0.01/250+1
}
initial <- 1e6
inv <- initial * 0.9
r_f <- 1/250
## Distributed invested capital to four stocks
AIG_n <- (inv * 0.25 *0.9) %/% AIG$adjusted_close[1]
AON_n <- (inv * 0.25 *0.9) %/% AON$adjusted_close[1]
BRK_n <- (inv * 0.25 *0.9) %/% BRK$adjusted_close[1]
MET_n <- (inv * 0.25 *0.9) %/% MET$adjusted_close[1]
AIG_value <- AIG_n * AIG$adjusted_close
AON_value <- AON_n * AON$adjusted_close
BRK_value <- BRK_n * BRK$adjusted_close
MET_value <- MET_n * MET$adjusted_close
Tot_value <- AIG_value + AON_value + BRK_value +  MET_value
Return <- Tot_value[-1]/Tot_value[-length(Tot_value)]-1
cash <- rep(1,length(AIG_n))
cash[1] <- initial - AIG_value[1] - AON_value[1] - BRK_value[1]- MET_value[1]
for( i in 2:length(cash)){
cash[i] <- cash[i-1] * (0.01/250+1)
}
cash <- rep(1,length(AIG_n))
rep(3.4)
rep(3,4)
initial <- 1e6
inv <- initial * 0.9
r_f <- 1/250
## Distributed invested capital to four stocks
AIG_n <- (inv * 0.25 *0.9) %/% AIG$adjusted_close[1]
AON_n <- (inv * 0.25 *0.9) %/% AON$adjusted_close[1]
BRK_n <- (inv * 0.25 *0.9) %/% BRK$adjusted_close[1]
MET_n <- (inv * 0.25 *0.9) %/% MET$adjusted_close[1]
AIG_value <- AIG_n * AIG$adjusted_close
AON_value <- AON_n * AON$adjusted_close
BRK_value <- BRK_n * BRK$adjusted_close
MET_value <- MET_n * MET$adjusted_close
Tot_value <- AIG_value + AON_value + BRK_value +  MET_value
Return <- Tot_value[-1]/Tot_value[-length(Tot_value)]-1
cash <- rep(1,100)
cash[1] <- initial - AIG_value[1] - AON_value[1] - BRK_value[1]- MET_value[1]
for( i in 2:length(cash)){
cash[i] <- cash[i-1] * (0.01/250+1)
}
Return
View(SPY)
View(SPY)
## Assign value
initial <- 1e6
inv <- initial * 0.9
r_f <- 1/250
## Stocks
AIG_n <- (inv * 0.25 *0.9) %/% AIG$adjusted_close[1]
AON_n <- (inv * 0.25 *0.9) %/% AON$adjusted_close[1]
BRK_n <- (inv * 0.25 *0.9) %/% BRK$adjusted_close[1]
MET_n <- (inv * 0.25 *0.9) %/% MET$adjusted_close[1]
AIG_value <- AIG_n * AIG$adjusted_close
AON_value <- AON_n * AON$adjusted_close
BRK_value <- BRK_n * BRK$adjusted_close
MET_value <- MET_n * MET$adjusted_close
Tot_value <- AIG_value + AON_value + BRK_value +  MET_value
Return_stock <- Tot_value[-1]/Tot_value[-length(Tot_value)]-1
#cash
cash <- rep(1,100)
cash[1] <- initial - AIG_value[1] - AON_value[1] - BRK_value[1]- MET_value[1]
for( i in 2:length(cash))    { cash[i] <- cash[i-1] * (0.01/250+1) }
# SPY
SPY_value <- SPY$adjusted_close
Return_SPY <- SPY_value[-1]/SPY_value[-length(SPY_value)]
library(ggplot2)
##plot
ggplot(Return_stock, aes(Return_stock)) + geom_histogram()
##plot
Return <- data.frame(Return_SPY，Return_stock)
##plot
Return <- data.frame(Return_SPY，Return_stock)
##plot
Return <- data.frame(SPY=Return_SPY，Stock=Return_stock)
##plot
Return <- data.frame(Return_SPY,Return_stock)
##plot
Return <- data.frame(Return_SPY,Return_stock)
ggplot(Return, aes(Return_stock)) + geom_histogram()
View(Return)
View(AIG)
View(AIG)
View(AON)
##plot
## 1. Plot a histogram of daily return
Return <- data.frame(date= AIG$timestamp,Return_SPY,Return_stock)
##plot
## 1. Plot a histogram of daily return
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
rel_ret <-
## 3. Plot relative valuation for the different allocation (stocks and cash) (Hint: bar chart)
library(tidyverse)
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
Rel_ret <- Return$Return_stock-Return$Return_SPY
ggplot(Return, aes(x=date, y=Rel_ret)) + geom_bar()
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
Rel_ret <- Return$Return_stock-Return$Return_SPY
ggplot(Return, aes(x=date, y=Rel_ret)) + geom_point()
## 3. Plot relative valuation for the different allocation (stocks and cash) (Hint: bar chart)
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
Rel_ret <- Return$Return_stock-Return$Return_SPY
ggplot(Return, aes(x=date, y=Rel_ret)) + geom_line()
## 3. Plot relative valuation for the different allocation (stocks and cash) (Hint: bar chart)
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
Rel_ret <- Return$Return_stock-Return$Return_SPY
ggplot(Return, aes(=Rel_ret)) + geom_line()
ggplot(Return, aes(y=Rel_ret)) + geom_line()
ggplot(Return, aes(y=Rel_ret)) + geom_bar()
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
Rel_ret <- Return$Return_stock-Return$Return_SPY
ggplot(Return, aes(x=date, y=Rel_ret)) + geom_bar() +
theme(axis.text.x = element_text(angle=90, hjust=1))
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
Rel_ret <- Return$Return_stock-Return$Return_SPY
ggplot(Return, aes(x=date, y=Rel_ret)) + geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle=90, hjust=1))
## 3. Plot relative valuation for the different allocation (stocks and cash) (Hint: bar chart)
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
Rel_ret <- Return$Return_stock-Return$Return_SPY
ggplot(Return, aes(x=date, y=Rel_ret)) + geom_line(stat="identity") +
theme(axis.text.x = element_text(angle=90, hjust=1))
## 3. Plot relative valuation for the different allocation (stocks and cash) (Hint: bar chart)
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
Rel_ret <- Return$Return_stock-Return$Return_SPY
ggplot(Return, aes(y=Rel_ret)) + geom_line(stat="identity") +
theme(axis.text.x = element_text(angle=90, hjust=1))
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
plot(y=Return$Rel_ret)
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
plot(Return$Rel_ret)
## 3. Plot relative valuation for the different allocation (stocks and cash) (Hint: bar chart)
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
plot(Return$Rel_ret,type="l")
## 3. Plot relative valuation for the different allocation (stocks and cash) (Hint: bar chart)
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
plot(Tot_value,type="l")
plot(Return$Rel_ret,type="l") #relativity return
## 3. Plot relative valuation for the different allocation (stocks and cash) (Hint: bar chart)
Tol_valuie
Tol_value
Tot_value
AIG_n*AIG$adjusted_close[1]+AON_n*AON$adjusted_close[1]+BRK_n*BRK$adjusted_close[1]+MET_n*MET$adjusted_close[1]
AIG_n*AIG$adjusted_close[1]
AIG_n <- (inv * 0.25) %/% AIG$adjusted_close[1]
AON_n <- (inv * 0.25) %/% AON$adjusted_close[1]
BRK_n <- (inv * 0.25) %/% BRK$adjusted_close[1]
MET_n <- (inv * 0.25) %/% MET$adjusted_close[1]
AIG_n*AIG$adjusted_close[1]+AON_n*AON$adjusted_close[1]+BRK_n*BRK$adjusted_close[1]+MET_n*MET$adjusted_close[1]
## Assign value
initial <- 1e6
inv <- initial * 0.9
r_f <- 1/250
## Stocks
AIG_n <- (inv * 0.25) %/% AIG$adjusted_close[1]
AON_n <- (inv * 0.25) %/% AON$adjusted_close[1]
BRK_n <- (inv * 0.25) %/% BRK$adjusted_close[1]
MET_n <- (inv * 0.25) %/% MET$adjusted_close[1]
AIG_value <- AIG_n * AIG$adjusted_close
AON_value <- AON_n * AON$adjusted_close
BRK_value <- BRK_n * BRK$adjusted_close
MET_value <- MET_n * MET$adjusted_close
Tot_value <- AIG_value + AON_value + BRK_value +  MET_value
Return_stock <- Tot_value[-1]/Tot_value[-length(Tot_value)]-1
#cash
cash <- rep(1,100)
cash[1] <- initial - AIG_value[1] - AON_value[1] - BRK_value[1]- MET_value[1]
for( i in 2:length(cash))    { cash[i] <- cash[i-1] * (0.01/250+1) }
# SPY
SPY_value <- SPY$adjusted_close
Return_SPY <- SPY_value[-1]/SPY_value[-length(SPY_value)]
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
plot(Tot_value,type="l")
plot(Return$Rel_ret,type="l") #relativity return
## 3. Plot relative valuation for the different allocation (stocks and cash) (Hint: bar chart)
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
plot(Tot_value,type="l")
plot(Return$Rel_ret,type="l") #relativity return
## 3. Plot relative valuation for the different allocation (stocks and cash) (Hint: bar chart)
valuation_AIG <- data.frame(date=AIG$timestamp,company="AIG",AIG_value)
valuation_AON <- data.frame(date=AON$timestamp,company="AON",AIG_value)
valuation_BRK <- data.frame(date=BRK$timestamp,company="BRK",AIG_value)
valuation_MET <- data.frame(date=MET$timestamp,company="MET",AIG_value)
valuation_cash <- data.frame(date=MET$timestamp,company="cash",cash)
valuation <- bind_rows(valuation_AIG, valuation_AON, valuation_BRK, valuation_MET, valuation_cash)
ggplot(valuation) + geom_bar(mapping = aes(x = date, fill = job), position = "fill")
valuation
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
plot(Tot_value,type="l")
plot(Return$Rel_ret,type="l") #relativity return
## 3. Plot relative valuation for the different allocation (stocks and cash) (Hint: bar chart)
valuation_AIG <- data.frame(date=AIG$timestamp,company="AIG",AIG_value)
valuation_AON <- data.frame(date=AON$timestamp,company="AON",AIG_value)
valuation_BRK <- data.frame(date=BRK$timestamp,company="BRK",AIG_value)
valuation_MET <- data.frame(date=MET$timestamp,company="MET",AIG_value)
valuation_cash <- data.frame(date=MET$timestamp,company="cash",cash)
valuation <- bind_rows(valuation_AIG, valuation_AON, valuation_BRK, valuation_MET, valuation_cash)
ggplot(valuation) + geom_bar(mapping = aes(x = date, fill = company), position = "fill")
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
plot(Tot_value,type="l")
plot(Return$Rel_ret,type="l") #relativity return
## 3. Plot relative valuation for the different allocation (stocks and cash) (Hint: bar chart)
valuation_AIG <- data.frame(date=AIG$timestamp,company="AIG",AIG_value)
valuation_AON <- data.frame(date=AON$timestamp,company="AON",AIG_value)
valuation_BRK <- data.frame(date=BRK$timestamp,company="BRK",AIG_value)
valuation_MET <- data.frame(date=MET$timestamp,company="MET",AIG_value)
valuation_cash <- data.frame(date=MET$timestamp,company="cash",cash)
valuation <- bind_rows(valuation_AIG, valuation_AON, valuation_BRK, valuation_MET, valuation_cash)
ggplot(valuation) + geom_bar(mapping = aes(x = date, fill = company, stat="identity"), position = "fill")
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
plot(Tot_value,type="l")
plot(Return$Rel_ret,type="l") #relativity return
## 3. Plot relative valuation for the different allocation (stocks and cash) (Hint: bar chart)
valuation_AIG <- data.frame(date=AIG$timestamp,company="AIG",AIG_value)
valuation_AON <- data.frame(date=AON$timestamp,company="AON",AIG_value)
valuation_BRK <- data.frame(date=BRK$timestamp,company="BRK",AIG_value)
valuation_MET <- data.frame(date=MET$timestamp,company="MET",AIG_value)
valuation_cash <- data.frame(date=MET$timestamp,company="cash",cash)
valuation <- bind_rows(valuation_AIG, valuation_AON, valuation_BRK, valuation_MET, valuation_cash)
ggplot(valuation) + geom_bar(mapping = aes(x = date, fill = company, stat="identity"), position = "fill") +
theme(text = element_text(size=8),
axis.text.x = element_text(angle = 45, hjust = 1))
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
plot(Tot_value,type="l")
plot(Return$Rel_ret,type="l") #relativity return
## 3. Plot relative valuation for the different allocation (stocks and cash) (Hint: bar chart)
valuation_AIG <- data.frame(date=AIG$timestamp,company="AIG",AIG_value)
valuation_AON <- data.frame(date=AON$timestamp,company="AON",AIG_value)
valuation_BRK <- data.frame(date=BRK$timestamp,company="BRK",AIG_value)
valuation_MET <- data.frame(date=MET$timestamp,company="MET",AIG_value)
valuation_cash <- data.frame(date=MET$timestamp,company="cash",cash)
valuation <- bind_rows(valuation_AIG, valuation_AON, valuation_BRK, valuation_MET, valuation_cash)
ggplot(valuation) + geom_bar(mapping = aes(x = date, fill = company, stat="identity"), position = "fill") +
theme(text = element_text(size=8),
axis.text.x = element_text(angle = 90, hjust = 1))
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
plot(Tot_value,type="l")
plot(Return$Rel_ret,type="l") #relativity return
## 3. Plot relative valuation for the different allocation (stocks and cash) (Hint: bar chart)
valuation_AIG <- data.frame(date=AIG$timestamp,company="AIG",AIG_value)
valuation_AON <- data.frame(date=AON$timestamp,company="AON",AIG_value)
valuation_BRK <- data.frame(date=BRK$timestamp,company="BRK",AIG_value)
valuation_MET <- data.frame(date=MET$timestamp,company="MET",AIG_value)
valuation_cash <- data.frame(date=MET$timestamp,company="cash",cash)
valuation <- bind_rows(valuation_AIG, valuation_AON, valuation_BRK, valuation_MET, valuation_cash)
ggplot(valuation) + geom_bar(mapping = aes(x = date, fill = company, stat="identity"), position = "fill") +
theme(text = element_text(size=4),
axis.text.x = element_text(angle = 90, hjust = 1))
?geom_bar
valuation_AIG <- data.frame(date=AIG$timestamp,company="AIG",value=AIG_value)
valuation_AON <- data.frame(date=AON$timestamp,company="AON",value=AON_value)
valuation_BRK <- data.frame(date=BRK$timestamp,company="BRK",value=BRK_value)
valuation_MET <- data.frame(date=MET$timestamp,company="MET",value=MET_value)
valuation_cash <- data.frame(date=MET$timestamp,company="cash", value = cash)
valuation <- bind_rows(valuation_AIG, valuation_AON, valuation_BRK, valuation_MET, valuation_cash)
ggplot(valuation) + geom_bar
ggplot(valuation) + geom_bar( mapping = aes(x = date, y=value, fill = company),
stat="identity" ,position = "fill") +
theme(text = element_text(size=4),
axis.text.x = element_text(angle = 90, hjust = 1))
##plot
## 1. Plot a histogram of daily return
Rel_ret <- Return$Return_stock-Return$Return_SPY
Return <- data.frame(date= AIG$timestamp[-1],Return_SPY,Return_stock, Rel_ret)
ggplot(Return, aes(Return_stock)) + geom_histogram()
## 2. Plot total valuation, and relativity return for your investment portfolio and S&P
plot(Tot_value,type="l")
plot(Return$Rel_ret,type="l") #relativity return
## 3. Plot relative valuation for the different allocation (stocks and cash) (Hint: bar chart)
valuation_AIG <- data.frame(date=AIG$timestamp,company="AIG",value=AIG_value)
valuation_AON <- data.frame(date=AON$timestamp,company="AON",value=AON_value)
valuation_BRK <- data.frame(date=BRK$timestamp,company="BRK",value=BRK_value)
valuation_MET <- data.frame(date=MET$timestamp,company="MET",value=MET_value)
valuation_cash <- data.frame(date=MET$timestamp,company="cash", value = cash)
valuation <- bind_rows(valuation_AIG, valuation_AON, valuation_BRK, valuation_MET, valuation_cash)
ggplot(valuation) + geom_bar( mapping = aes(x = date, y=value, fill = company),
stat="identity" ,position = "fill") +
theme(text = element_text(size=8),
axis.text.x = element_text(angle = 90, hjust = 1))
