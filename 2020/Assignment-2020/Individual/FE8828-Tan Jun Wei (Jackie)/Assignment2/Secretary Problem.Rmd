---
title: "Secretary Problem"
output: html_notebook
---
For each of 10000 trials, 
1) We create a list of N numbers {1,...,N}.
2) We split this list into 2 groups: evaluation group and selection group. 
3) We note the best candidate in our evaluation group. (Taking max value of the group)
4) We run sequentially across the selection group and select the first candidate > best candidate. 

Then, we calculate the probability of hiring N out of 10000 trials. 

```{r make_choice}
make_choice <- function(N, split_number) {
  count <- 0
  trials <- 10000
  for (i in 1:trials) {
    rand_seq <- sample(1:N, N)
    split_rule <- c(split_number, N - split_number)
    groups <- split(rand_seq, rep(seq_along(split_rule), split_rule))
    best <- max(groups[[1]])
    for (i in groups[[2]]) {
      if (i > best) {
        if (i == N)
          count <- count + 1
        break
      }
    }
  }
  count / trials
}
```

`r make_choice(100,50)`

In function find_optimal(), we will call make_choice() for each of the split_number from 1 to N/2 and find the optimal split for each N. 
```{r find_optimal}
find_optimal <- function(N) {
  prob_outcome = c()
  for (i in 1:ceiling(N/2)) {
    prob_outcome <- append(prob_outcome, make_choice(N, i))
  }
  prob_outcome
}
```

Then we test the functions with N = 3, N = 10 and N = 100. 
```{r}
prob_outcome = find_optimal(3)
print(paste("If N = 3, the optimal number to split is", which.max(prob_outcome), "which has the probability of",max(prob_outcome),"for hiring the best."))
```
```{r}
prob_outcome = find_optimal(10)
print(paste("If N = 10, the optimal number to split is", which.max(prob_outcome), "which has the probability of",max(prob_outcome),"for hiring the best."))
```
```{r}
prob_outcome = find_optimal(100)
print(paste("If N = 100, the optimal number to split is", which.max(prob_outcome), "which has the probability of",max(prob_outcome),"for hiring the best."))
```
