<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Dr.Â Yang Ye  &lt;Email:yy@runchee.com&gt;" />
  <meta name="copyright" content="FE8828 Programming Web Applications in Finance. Copyright (c) 2018, Yang Ye" />
  <meta name="font-size-adjustment" content="1" />
  <title>FE8828 Programming Web Applications in Finance</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <style type="text/css">
body
{
margin: 0 0 0 0;
padding: 0 0 0 0;
width: 100%;
height: 100%;
color: black;
background-color: white;
font-family: "Gill Sans MT", "Gill Sans", GillSans, sans-serif;
font-size: 14pt;
}
div.toolbar {
position: fixed; z-index: 200;
top: auto; bottom: 0; left: 0; right: 0;
height: 1.2em; text-align: right;
padding-left: 1em;
padding-right: 1em; font-size: 60%;
color: DimGray;
background-color: rgb(240,240,240);
border-top: solid 1px rgb(180,180,180);
}
div.toolbar span.copyright {
color: DimGray;
margin-left: 0.5em;
}
div.initial_prompt {
position: absolute;
z-index: 1000;
bottom: 1.2em;
width: 100%;
background-color: rgb(200,200,200);
opacity: 0.35;
background-color: rgb(200,200,200, 0.35);
cursor: pointer;
}
div.initial_prompt p.help {
text-align: center;
}
div.initial_prompt p.close {
text-align: right;
font-style: italic;
}
div.slidy_toc {
position: absolute;
z-index: 300;
width: 60%;
max-width: 30em;
height: 30em;
overflow: auto;
top: auto;
right: auto;
left: 4em;
bottom: 4em;
padding: 1em;
background: rgb(240,240,240);
border-style: solid;
border-width: 2px;
font-size: 60%;
}
div.slidy_toc .toc_heading {
text-align: center;
width: 100%;
margin: 0;
margin-bottom: 1em;
border-bottom-style: solid;
border-bottom-color: rgb(180,180,180);
border-bottom-width: 1px;
}
div.slide {
z-index: 20;
margin: 0 0 0 0;
padding-top: 0;
padding-bottom: 0;
padding-left: 20px;
padding-right: 20px;
border-width: 0;
clear: both;
top: 0;
bottom: 0;
left: 0;
right: 0;
line-height: 120%;
background-color: transparent;
}
div.background {
display: none;
}
div.handout {
margin-left: 20px;
margin-right: 20px;
}
div.slide.titlepage {
text-align: center;
}
div.slide.titlepage h1 {
padding-top: 10%;
margin-right: 0;
}
div.slide h1 {
padding-left: 0;
padding-right: 20pt;
padding-top: 4pt;
padding-bottom: 4pt;
margin-top: 0;
margin-left: 0;
margin-right: 60pt;
margin-bottom: 0.5em;
display: block; font-size: 160%;
line-height: 1.2em;
background: transparent;
}
@media screen and (max-device-width: 1024px)
{
div.slide { font-size: 100%; }
}
@media screen and (max-device-width: 800px)
{
div.slide { font-size: 200%; }
div.slidy_toc {
top: 1em;
left: 1em;
right: auto;
width: 80%;
font-size: 180%;
}
}
div.toc-heading {
width: 100%;
border-bottom: solid 1px rgb(180,180,180);
margin-bottom: 1em;
text-align: center;
}
img {
image-rendering: optimize-quality;
}
pre {
font-size: 80%;
font-weight: bold;
line-height: 120%;
padding-top: 0.2em;
padding-bottom: 0.2em;
padding-left: 1em;
padding-right: 1em;
border-style: solid;
border-left-width: 1em;
border-top-width: thin;
border-right-width: thin;
border-bottom-width: thin;
border-color: #95ABD0;
color: #00428C;
background-color: #E4E5E7;
}
li pre { margin-left: 0; }
blockquote { font-style: italic }
img { background-color: transparent }
p.copyright { font-size: smaller }
.center { text-align: center }
.footnote { font-size: smaller; margin-left: 2em; }
a img { border-width: 0; border-style: none }
a:visited { color: navy }
a:link { color: navy }
a:hover { color: red; text-decoration: underline }
a:active { color: red; text-decoration: underline }
a {text-decoration: none}
.toolbar a:link {color: blue}
.toolbar a:visited {color: blue}
.toolbar a:active {color: red}
.toolbar a:hover {color: red}
ul { list-style-type: square; }
ul ul { list-style-type: disc; }
ul ul ul { list-style-type: circle; }
ul ul ul ul { list-style-type: disc; }
li { margin-left: 0.5em; margin-top: 0.5em; }
li li { font-size: 85%; font-style: italic }
li li li { font-size: 85%; font-style: normal }
div dt
{
margin-left: 0;
margin-top: 1em;
margin-bottom: 0.5em;
font-weight: bold;
}
div dd
{
margin-left: 2em;
margin-bottom: 0.5em;
}
p,pre,ul,ol,blockquote,h2,h3,h4,h5,h6,dl,table {
margin-left: 1em;
margin-right: 1em;
}
p.subhead { font-weight: bold; margin-top: 2em; }
.smaller { font-size: smaller }
.bigger { font-size: 130% }
td,th { padding: 0.2em }
ul {
margin: 0.5em 1.5em 0.5em 1.5em;
padding: 0;
}
ol {
margin: 0.5em 1.5em 0.5em 1.5em;
padding: 0;
}
ul { list-style-type: square; }
ul ul { list-style-type: disc; }
ul ul ul { list-style-type: circle; }
ul ul ul ul { list-style-type: disc; }
ul li { list-style: square;
margin: 0.1em 0em 0.6em 0;
padding: 0 0 0 0;
line-height: 140%;
}
ol li { margin: 0.1em 0em 0.6em 1.5em;
padding: 0 0 0 0px;
line-height: 140%;
list-style-type: decimal;
}
li ul li { font-size: 85%; font-style: italic;
list-style-type: disc;
background: transparent;
padding: 0 0 0 0;
}
li li ul li { font-size: 85%; font-style: normal;
list-style-type: circle;
background: transparent;
padding: 0 0 0 0;
}
li li li ul li {
list-style-type: disc;
background: transparent;
padding: 0 0 0 0;
}
li ol li {
list-style-type: decimal;
}
li li ol li {
list-style-type: decimal;
}

ol.outline li:hover { cursor: pointer }
ol.outline li.nofold:hover { cursor: default }
ul.outline li:hover { cursor: pointer }
ul.outline li.nofold:hover { cursor: default }
ol.outline { list-style:decimal; }
ol.outline ol { list-style-type:lower-alpha }
ol.outline li.nofold {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAIACAMzMzOvr/ywAAAAACQAJAAACD4SPoRvG614Dctb4MEMcFAA7) no-repeat 0px 0.5em;
}
ol.outline li.unfolded {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAKEDAMPD/8zMzOvr/////ywAAAAACQAJAAACEYyPoivG614LAlg7ZZbxoR8UADs=) no-repeat 0px 0.5em;
}
ol.outline li.folded {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAKEDAMPD/8zMzOvr/////ywAAAAACQAJAAACFIyPoiu2sJyCyoF7W3hxz850CFIAADs=) no-repeat 0px 0.5em;
}
ol.outline li.unfolded:hover {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAKEDAAAAAAAA/8PD/////ywAAAAACQAJAAACEYSPoivG614DIlg7ZZbxoQ8UADs=) no-repeat 0px 0.5em;
}
ol.outline li.folded:hover {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAKEDAAAAAAAA/8PD/////ywAAAAACQAJAAACFISPoiu2sZyCyoV7G3hxz850CFIAADs=) no-repeat 0px 0.5em;
}
ul.outline li.nofold {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAIACAMzMzOvr/ywAAAAACQAJAAACD4SPoRvG614Dctb4MEMcFAA7) no-repeat 0px 0.5em;
}
ul.outline li.unfolded {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAKEDAMPD/8zMzOvr/////ywAAAAACQAJAAACEYyPoivG614LAlg7ZZbxoR8UADs=) no-repeat 0px 0.5em;
}
ul.outline li.folded {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAKEDAMPD/8zMzOvr/////ywAAAAACQAJAAACFIyPoiu2sJyCyoF7W3hxz850CFIAADs=) no-repeat 0px 0.5em;
}
ul.outline li.unfolded:hover {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAKEDAAAAAAAA/8PD/////ywAAAAACQAJAAACEYSPoivG614DIlg7ZZbxoQ8UADs=) no-repeat 0px 0.5em;
}
ul.outline li.folded:hover {
padding: 0 0 0 20px;
background: transparent url(data:image/gif;base64,R0lGODdhCQAJAKEDAAAAAAAA/8PD/////ywAAAAACQAJAAACFISPoiu2sZyCyoV7G3hxz850CFIAADs=) no-repeat 0px 0.5em;
}

a.titleslide { font-weight: bold; font-style: italic }

img.hidden { display: none; visibility: hidden }
div.initial_prompt { display: none; visibility: hidden }
div.slide {
visibility: visible;
position: inherit;
}
div.handout {
border-top-style: solid;
border-top-width: thin;
border-top-color: black;
}
@media screen {
.hidden { display: none; visibility: visible }
div.slide.hidden { display: block; visibility: visible }
div.handout.hidden { display: block; visibility: visible }
div.background { display: none; visibility: hidden }
body.single_slide div.initial_prompt { display: block; visibility: visible }
body.single_slide div.background { display: block; visibility: visible }
body.single_slide div.background.hidden { display: none; visibility: hidden }
body.single_slide .invisible { visibility: hidden }
body.single_slide .hidden { display: none; visibility: hidden }
body.single_slide div.slide { position: absolute }
body.single_slide div.handout { display: none; visibility: hidden }
}
@media print {
.hidden { display: block; visibility: visible }
div.slide pre { font-size: 60%; padding-left: 0.5em; }
div.toolbar { display: none; visibility: hidden; }
div.slidy_toc { display: none; visibility: hidden; }
div.background { display: none; visibility: hidden; }
div.slide { page-break-before: always }

div.slide.first-slide { page-break-before: avoid }
}


.jslider table {
margin-left: 0em;
margin-right: 0em;
}

table.dataTable, .shiny-datatable-output div {
font-size: 14pt;
}

.dataTables_info, .dataTables_paginate {
font-size: 19px;
}

pre.sourceCode, code.sourceCode {
font-size: 80%;
}

label, button, input, select, textarea {
font-size: 14pt;
}

ul.nav, ul.nav li {
list-style-type: none;
}
</style>
  <script src="data:application/javascript;base64,Lyogc2xpZHkuanMKCiAgIENvcHlyaWdodCAoYykgMjAwNS0yMDEzIFczQyAoTUlULCBFUkNJTSwgS2VpbyksIEFsbCBSaWdodHMgUmVzZXJ2ZWQuCiAgIFczQyBsaWFiaWxpdHksIHRyYWRlbWFyaywgZG9jdW1lbnQgdXNlIGFuZCBzb2Z0d2FyZSBsaWNlbnNpbmcKICAgcnVsZXMgYXBwbHksIHNlZToKCiAgIGh0dHA6Ly93d3cudzMub3JnL0NvbnNvcnRpdW0vTGVnYWwvY29weXJpZ2h0LWRvY3VtZW50cwogICBodHRwOi8vd3d3LnczLm9yZy9Db25zb3J0aXVtL0xlZ2FsL2NvcHlyaWdodC1zb2Z0d2FyZQoKICAgRGVmaW5lcyBzaW5nbGUgbmFtZSAidzNjX3NsaWR5IiBpbiBnbG9iYWwgbmFtZXNwYWNlCiAgIEFkZHMgZXZlbnQgaGFuZGxlcnMgd2l0aG91dCB0cmFtcGxpbmcgb24gYW55IG90aGVycwoqLwoKLy8gdGhlIHNsaWR5IG9iamVjdCBpbXBsZW1lbnRhdGlvbgp2YXIgdzNjX3NsaWR5ID0gewogIC8vIGNsYXNzaWZ5IHdoaWNoIGtpbmQgb2YgYnJvd3NlciB3ZSdyZSBydW5uaW5nIHVuZGVyCiAgbnNfcG9zOiAodHlwZW9mIHdpbmRvdy5wYWdlWU9mZnNldCE9J3VuZGVmaW5lZCcpLAogIGtodG1sOiAoKG5hdmlnYXRvci51c2VyQWdlbnQpLmluZGV4T2YoIktIVE1MIikgPj0gMCA/IHRydWUgOiBmYWxzZSksCiAgb3BlcmE6ICgobmF2aWdhdG9yLnVzZXJBZ2VudCkuaW5kZXhPZigiT3BlcmEiKSA+PSAwID8gdHJ1ZSA6IGZhbHNlKSwKICBpcGFkOiAoKG5hdmlnYXRvci51c2VyQWdlbnQpLmluZGV4T2YoImlQYWQiKSA+PSAwID8gdHJ1ZSA6IGZhbHNlKSwKICBpcGhvbmU6ICgobmF2aWdhdG9yLnVzZXJBZ2VudCkuaW5kZXhPZigiaVBob25lIikgPj0gMCA/IHRydWUgOiBmYWxzZSksCiAgYW5kcm9pZDogKChuYXZpZ2F0b3IudXNlckFnZW50KS5pbmRleE9mKCJBbmRyb2lkIikgPj0gMCA/IHRydWUgOiBmYWxzZSksCiAgaWU6ICh0eXBlb2YgZG9jdW1lbnQuYWxsICE9ICJ1bmRlZmluZWQiICYmICF0aGlzLm9wZXJhKSwKICBpZTY6ICghdGhpcy5uc19wb3MgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNU0lFIDYiKSAhPSAtMSksCiAgaWU3OiAoIXRoaXMubnNfcG9zICYmIG5hdmlnYXRvci51c2VyQWdlbnQuaW5kZXhPZigiTVNJRSA3IikgIT0gLTEpLAogIGllODogKCF0aGlzLm5zX3BvcyAmJiBuYXZpZ2F0b3IudXNlckFnZW50LmluZGV4T2YoIk1TSUUgOCIpICE9IC0xKSwKICBpZTk6ICghdGhpcy5uc19wb3MgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCJNU0lFIDkiKSAhPSAtMSksCgogIC8vIGRhdGEgZm9yIHN3aXBlIGFuZCBkb3VibGUgdGFwIGRldGVjdGlvbiBvbiB0b3VjaCBzY3JlZW5zCiAgbGFzdF90YXA6IDAsCiAgcHJldl90YXA6IDAsCiAgc3RhcnRfeDogMCwKICBzdGFydF95OiAwLAogIGRlbHRhX3g6IDAsCiAgZGVsdGFfeTogMCwKCiAgLy8gYXJlIHdlIHJ1bm5pbmcgYXMgWEhUTUw/IChkb2Vzbid0IHdvcmsgb24gT3BlcmEpCiAgaXNfeGh0bWw6IC94bWwvLnRlc3QoZG9jdW1lbnQuY29udGVudFR5cGUpLAoKICBzbGlkZV9udW1iZXI6IDAsIC8vIGludGVnZXIgc2xpZGUgY291bnQ6IDAsIDEsIDIsIC4uLgogIHNsaWRlX251bWJlcl9lbGVtZW50OiBudWxsLCAvLyBlbGVtZW50IGNvbnRhaW5pbmcgc2xpZGUgbnVtYmVyCiAgc2xpZGVzOiBbXSwgLy8gc2V0IHRvIGFycmF5IG9mIHNsaWRlIGRpdidzCiAgbm90ZXM6IFtdLCAvLyBzZXQgdG8gYXJyYXkgb2YgaGFuZG91dCBkaXYncwogIGJhY2tncm91bmRzOiBbXSwgLy8gc2V0IHRvIGFycmF5IG9mIGJhY2tncm91bmQgZGl2J3MKICBvYnNlcnZlcnM6IFtdLCAvLyBsaXN0IG9mIG9ic2VydmVyIGZ1bmN0aW9ucwogIHRvb2xiYXI6IG51bGwsIC8vIGVsZW1lbnQgY29udGFpbmluZyB0b29sYmFyCiAgdGl0bGU6IG51bGwsIC8vIGRvY3VtZW50IHRpdGxlCiAgbGFzdF9zaG93bjogbnVsbCwgLy8gbGFzdCBpbmNyZW1lbnRhbGx5IHNob3duIGl0ZW0KICBlb3M6IG51bGwsICAvLyBzcGFuIGVsZW1lbnQgZm9yIGVuZCBvZiBzbGlkZSBpbmRpY2F0b3IKICB0b2M6IG51bGwsIC8vIHRhYmxlIG9mIGNvbnRlbnRzCiAgb3V0bGluZTogbnVsbCwgLy8gb3V0bGluZSBlbGVtZW50IHdpdGggdGhlIGZvY3VzCiAgc2VsZWN0ZWRfdGV4dF9sZW46IDAsIC8vIGxlbmd0aCBvZiBkcmFnIHNlbGVjdGlvbiBvbiBkb2N1bWVudAogIHZpZXdfYWxsOiAwLCAgLy8gMSB0byB2aWV3IGFsbCBzbGlkZXMgKyBoYW5kb3V0cwogIHdhbnRfdG9vbGJhcjogdHJ1ZSwgIC8vIHVzZXIgcHJlZmVyZW5jZSB0byBzaG93L2hpZGUgdG9vbGJhcgogIG1vdXNlX2NsaWNrX2VuYWJsZWQ6IHRydWUsIC8vIGVuYWJsZXMgbGVmdCBjbGljayBmb3IgbmV4dCBzbGlkZQogIHNjcm9sbF9oYWNrOiAwLCAvLyBJRSB3b3JrIGFyb3VuZCBmb3IgcG9zaXRpb246IGZpeGVkCiAgZGlzYWJsZV9zbGlkZV9jbGljazogZmFsc2UsICAvLyB1c2VkIGJ5IGNsaWNrZWQgYW5jaG9ycwoKICBsYW5nOiAiZW4iLCAvLyB1cGRhdGVkIHRvIGxhbmd1YWdlIHNwZWNpZmllZCBieSBodG1sIGZpbGUKCiAgaGVscF9hbmNob3I6IG51bGwsIC8vIHVzZWQgZm9yIGtleWJvYXJkIGZvY3VzIGhhY2sgaW4gc2hvd1Rvb2xiYXIoKQogIGhlbHBfcGFnZTogImh0dHA6Ly93d3cudzMub3JnL1RhbGtzL1Rvb2xzL1NsaWR5Mi9oZWxwL2hlbHAuaHRtbCIsCiAgaGVscF90ZXh0OiAiTmF2aWdhdGUgd2l0aCBtb3VzZSBjbGljaywgc3BhY2UgYmFyLCBDdXJzb3IgTGVmdC9SaWdodCwgIiArCiAgICAgICAgICAgICAib3IgUGcgVXAgYW5kIFBnIERuLiBVc2UgUyBhbmQgQiB0byBjaGFuZ2UgZm9udCBzaXplLiIsCgogIHNpemVfaW5kZXg6IDAsCiAgc2l6ZV9hZGp1c3RtZW50OiAwLAogIHNpemVzOiAgbmV3IEFycmF5KCIxMHB0IiwgIjEycHQiLCAiMTRwdCIsICIxNnB0IiwgIjE4cHQiLCAiMjBwdCIsCiAgICAgICAgICAgICAgICAgICAgIjIycHQiLCAiMjRwdCIsICIyNnB0IiwgIjI4cHQiLCAiMzBwdCIsICIzMnB0IiksCgogIC8vIG5lZWRlZCBmb3IgZWZmaWNpZW50IHJlc2l6aW5nCiAgbGFzdF93aWR0aDogMCwKICBsYXN0X2hlaWdodDogMCwKCgogIC8vIE5lZWRlZCBmb3IgY3Jvc3MgYnJvd3NlciBzdXBwb3J0IGZvciByZWxhdGl2ZSB3aWR0aC9oZWlnaHQgb24KICAvLyBvYmplY3QgZWxlbWVudHMuIFRoZSB3b3JrIGFyb3VuZCBpcyB0byBzYXZlIHdpZHRoL2hlaWdodCBhdHRyaWJ1dGVzCiAgLy8gYW5kIHRoZW4gdG8gcmVjb21wdXRlIGFic29sdXRlIHdpZHRoL2hlaWdodCBkaW1lbnNpb25zIG9uIHJlc2l6aW5nCiAgIG9iamVjdHM6IFtdLAoKICAvLyBhdHRhY2ggaW5pdGlhbGlhdGlvbiBldmVudCBoYW5kbGVycwogIHNldF91cDogZnVuY3Rpb24gKCkgewogICAgdmFyIGluaXQgPSBmdW5jdGlvbigpIHsgdzNjX3NsaWR5LmluaXQoKTsgfTsKICAgIGlmICh0eXBlb2Ygd2luZG93LmFkZEV2ZW50TGlzdGVuZXIgIT0gInVuZGVmaW5lZCIpCiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCJsb2FkIiwgaW5pdCwgZmFsc2UpOwogICAgZWxzZQogICAgICB3aW5kb3cuYXR0YWNoRXZlbnQoIm9ubG9hZCIsIGluaXQpOwogIH0sCgogIGhpZGVfc2xpZGVzOiBmdW5jdGlvbiAoKSB7CiAgICBpZiAoZG9jdW1lbnQuYm9keSAmJiAhdzNjX3NsaWR5LmluaXRpYWxpemVkKQogICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLnZpc2liaWxpdHkgPSAiaGlkZGVuIjsKICAgIGVsc2UKICAgICAgc2V0VGltZW91dCh3M2Nfc2xpZHkuaGlkZV9zbGlkZXMsIDUwKTsKICB9LAoKICAvLyBoYWNrIHRvIHBlcnN1YWRlIElFIHRvIGNvbXB1dGUgY29ycmVjdCBkb2N1bWVudCBoZWlnaHQKICAvLyBhcyBuZWVkZWQgZm9yIHNpbXVsYXRpbmcgZml4ZWQgcG9zaXRpb25pbmcgb2YgdG9vbGJhcgogIGllX2hhY2s6IGZ1bmN0aW9uICgpIHsKICAgIHdpbmRvdy5yZXNpemVCeSgwLC0xKTsKICAgIHdpbmRvdy5yZXNpemVCeSgwLCAxKTsKICB9LAoKICBpbml0OiBmdW5jdGlvbiAoKSB7CiAgICAvL2FsZXJ0KCJzbGlkeSBzdGFydGluZyB0ZXN0IDEwIik7CiAgICBkb2N1bWVudC5ib2R5LnN0eWxlLnZpc2liaWxpdHkgPSAidmlzaWJsZSI7CiAgICB0aGlzLmluaXRfbG9jYWxpemF0aW9uKCk7CiAgICB0aGlzLmFkZF90b29sYmFyKCk7CiAgICB0aGlzLndyYXBfaW1wbGljaXRfc2xpZGVzKCk7CiAgICB0aGlzLmNvbGxlY3Rfc2xpZGVzKCk7CiAgICB0aGlzLmNvbGxlY3Rfbm90ZXMoKTsKICAgIHRoaXMuY29sbGVjdF9iYWNrZ3JvdW5kcygpOwogICAgdGhpcy5vYmplY3RzID0gZG9jdW1lbnQuYm9keS5nZXRFbGVtZW50c0J5VGFnTmFtZSgib2JqZWN0Iik7CiAgICB0aGlzLnBhdGNoX2FuY2hvcnMoKTsKICAgIHRoaXMuc2xpZGVfbnVtYmVyID0gdGhpcy5maW5kX3NsaWRlX251bWJlcihsb2NhdGlvbi5ocmVmKTsKICAgIHdpbmRvdy5vZmZzY3JlZW5idWZmZXJpbmcgPSB0cnVlOwogICAgdGhpcy5zaXplX2FkanVzdG1lbnQgPSB0aGlzLmZpbmRfc2l6ZV9hZGp1c3QoKTsKICAgIHRoaXMudGltZV9sZWZ0ID0gdGhpcy5maW5kX2R1cmF0aW9uKCk7CiAgICB0aGlzLmhpZGVfaW1hZ2VfdG9vbGJhcigpOyAgLy8gc3VwcHJlc3MgSUUgaW1hZ2UgdG9vbGJhciBwb3B1cAogICAgdGhpcy5pbml0X291dGxpbmVyKCk7ICAvLyBhY3RpdmF0ZSBmb2xkL3VuZm9sZCBzdXBwb3J0CiAgICB0aGlzLnRpdGxlID0gZG9jdW1lbnQudGl0bGU7CiAgICB0aGlzLmtleWJvYXJkbGVzcyA9ICh0aGlzLmlwYWR8fHRoaXMuaXBob25lfHx0aGlzLmFuZHJvaWQpOwoKICAgIGlmICh0aGlzLmtleWJvYXJkbGVzcykKICAgIHsKICAgICAgdzNjX3NsaWR5LnJlbW92ZV9jbGFzcyh3M2Nfc2xpZHkudG9vbGJhciwgImhpZGRlbiIpCiAgICAgIHRoaXMud2FudF90b29sYmFyID0gMDsKICAgIH0KCiAgICAvLyB3b3JrIGFyb3VuZCBmb3Igb3BlcmEgYnVnCiAgICB0aGlzLmlzX3hodG1sID0gKGRvY3VtZW50LmJvZHkudGFnTmFtZSA9PSAiQk9EWSIgPyBmYWxzZSA6IHRydWUpOwoKICAgIGlmICh0aGlzLnNsaWRlcy5sZW5ndGggPiAwKQogICAgewogICAgICB2YXIgc2xpZGUgPSB0aGlzLnNsaWRlc1t0aGlzLnNsaWRlX251bWJlcl07CiAgIAogICAgICBpZiAodGhpcy5zbGlkZV9udW1iZXIgPiAwKQogICAgICB7CiAgICAgICAgdGhpcy5zZXRfdmlzaWJpbGl0eV9hbGxfaW5jcmVtZW50YWwoInZpc2libGUiKTsKICAgICAgICB0aGlzLmxhc3Rfc2hvd24gPSB0aGlzLnByZXZpb3VzX2luY3JlbWVudGFsX2l0ZW0obnVsbCk7CiAgICAgICAgdGhpcy5zZXRfZW9zX3N0YXR1cyh0cnVlKTsKICAgICAgfQogICAgICBlbHNlCiAgICAgIHsKICAgICAgICB0aGlzLmxhc3Rfc2hvd24gPSBudWxsOwogICAgICAgIHRoaXMuc2V0X3Zpc2liaWxpdHlfYWxsX2luY3JlbWVudGFsKCJoaWRkZW4iKTsKICAgICAgICB0aGlzLnNldF9lb3Nfc3RhdHVzKCF0aGlzLm5leHRfaW5jcmVtZW50YWxfaXRlbSh0aGlzLmxhc3Rfc2hvd24pKTsKICAgICAgfQoKICAgICAgdGhpcy5zZXRfbG9jYXRpb24oKTsKICAgICAgdGhpcy5hZGRfY2xhc3ModGhpcy5zbGlkZXNbMF0sICJmaXJzdC1zbGlkZSIpOwogICAgICB3M2Nfc2xpZHkuc2hvd19zbGlkZShzbGlkZSk7CiAgICB9CgogICAgdGhpcy50b2MgPSB0aGlzLnRhYmxlX29mX2NvbnRlbnRzKCk7CgogICAgdGhpcy5hZGRfaW5pdGlhbF9wcm9tcHQoKTsKCiAgICAvLyBiaW5kIGV2ZW50IGhhbmRsZXJzIHdpdGhvdXQgaW50ZXJmZXJpbmcgd2l0aCBjdXN0b20gcGFnZSBzY3JpcHRzCiAgICAvLyBUYXAgZXZlbnRzIGJlaGF2ZSB0b28gd2VpcmRseSB0byBzdXBwb3J0IGNsaWNrcyByZWxpYWJseSBvbgogICAgLy8gaVBob25lIGFuZCBpUGFkLCBzbyBleGNsdWRlIHRoZXNlIGZyb20gY2xpY2sgaGFuZGxlcgoKICAgIGlmICghdGhpcy5rZXlib2FyZGxlc3MpCiAgICB7CiAgICAgIHRoaXMuYWRkX2xpc3RlbmVyKGRvY3VtZW50LmJvZHksICJjbGljayIsIHRoaXMubW91c2VfYnV0dG9uX2NsaWNrKTsKICAgICAgdGhpcy5hZGRfbGlzdGVuZXIoZG9jdW1lbnQuYm9keSwgIm1vdXNlZG93biIsIHRoaXMubW91c2VfYnV0dG9uX2Rvd24pOwogICAgfQoKICAgIHRoaXMuYWRkX2xpc3RlbmVyKGRvY3VtZW50LCAia2V5ZG93biIsIHRoaXMua2V5X2Rvd24pOwogICAgdGhpcy5hZGRfbGlzdGVuZXIoZG9jdW1lbnQsICJrZXlwcmVzcyIsIHRoaXMua2V5X3ByZXNzKTsKICAgIHRoaXMuYWRkX2xpc3RlbmVyKHdpbmRvdywgInJlc2l6ZSIsIHRoaXMucmVzaXplZCk7CiAgICB0aGlzLmFkZF9saXN0ZW5lcih3aW5kb3csICJzY3JvbGwiLCB0aGlzLnNjcm9sbGVkKTsKICAgIHRoaXMuYWRkX2xpc3RlbmVyKHdpbmRvdywgInVubG9hZCIsIHRoaXMudW5sb2FkZWQpOwoKICAgIHRoaXMuYWRkX2xpc3RlbmVyKGRvY3VtZW50LCAiZ2VzdHVyZWNoYW5nZSIsIGZ1bmN0aW9uICgpCiAgICB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0pOwoKICAgIHRoaXMuYXR0YWNoX3RvdWNoX2hhbmRlcnModGhpcy5zbGlkZXMpOwoKICAgIC8vIHRoaXMgc2VlbXMgdG8gYmUgYSBkZWJ1Z2dpbmcgaGFjawogICAgLy9pZiAoIWRvY3VtZW50LmJvZHkub25jbGljaykKICAgIC8vICBkb2N1bWVudC5ib2R5Lm9uY2xpY2sgPSBmdW5jdGlvbiAoKSB7IH07CgogICAgdGhpcy5zaW5nbGVfc2xpZGVfdmlldygpOwoKICAgIC8vdGhpcy5zZXRfbG9jYXRpb24oKTsKCiAgICB0aGlzLnJlc2l6ZWQoKTsKCiAgICBpZiAodGhpcy5pZTcpCiAgICAgIHNldFRpbWVvdXQodzNjX3NsaWR5LmllX2hhY2ssIDEwMCk7CgogICAgdGhpcy5zaG93X3Rvb2xiYXIoKTsKCiAgICAvLyBmb3IgYmFjayBidXR0b24gZGV0ZWN0aW9uCiAgICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7IHczY19zbGlkeS5jaGVja19sb2NhdGlvbigpOyB9LCAyMDApOwogICAgdzNjX3NsaWR5LmluaXRpYWxpemVkID0gdHJ1ZTsKICB9LAoKICAvLyBjcmVhdGUgZGl2IGVsZW1lbnQgd2l0aCBsaW5rcyB0byBlYWNoIHNsaWRlCiAgdGFibGVfb2ZfY29udGVudHM6IGZ1bmN0aW9uICgpIHsKICAgIHZhciB0b2MgPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJkaXYiKTsKICAgIHRoaXMuYWRkX2NsYXNzKHRvYywgInNsaWR5X3RvYyBoaWRkZW4iKTsKICAgIC8vdG9jLnNldEF0dHJpYnV0ZSgidGFiaW5kZXgiLCAiMCIpOwoKICAgIHZhciBoZWFkaW5nID0gdGhpcy5jcmVhdGVfZWxlbWVudCgiZGl2Iik7CiAgICB0aGlzLmFkZF9jbGFzcyhoZWFkaW5nLCAidG9jLWhlYWRpbmciKTsKICAgIGhlYWRpbmcuaW5uZXJIVE1MID0gdGhpcy5sb2NhbGl6ZSgiVGFibGUgb2YgQ29udGVudHMiKTsKCiAgICB0b2MuYXBwZW5kQ2hpbGQoaGVhZGluZyk7CiAgICB2YXIgcHJldmlvdXMgPSBudWxsOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zbGlkZXMubGVuZ3RoOyArK2kpCiAgICB7CiAgICAgIHZhciB0aXRsZSA9IHRoaXMuaGFzX2NsYXNzKHRoaXMuc2xpZGVzW2ldLCAidGl0bGUiKTsKICAgICAgdmFyIG51bSA9IGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKChpICsgMSkgKyAiLiAiKTsKCiAgICAgIHRvYy5hcHBlbmRDaGlsZChudW0pOwoKICAgICAgdmFyIGEgPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJhIik7CiAgICAgIGEuc2V0QXR0cmlidXRlKCJocmVmIiwgIiMoIiArIChpKzEpICsgIikiKTsKCiAgICAgIGlmICh0aXRsZSkKICAgICAgICB0aGlzLmFkZF9jbGFzcyhhLCAidGl0bGVzbGlkZSIpOwoKICAgICAgdmFyIG5hbWUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0aGlzLnNsaWRlX25hbWUoaSkpOwogICAgICBhLmFwcGVuZENoaWxkKG5hbWUpOwogICAgICBhLm9uY2xpY2sgPSB3M2Nfc2xpZHkudG9jX2NsaWNrOwogICAgICBhLm9ua2V5ZG93biA9IHczY19zbGlkeS50b2Nfa2V5X2Rvd247CiAgICAgIGEucHJldmlvdXMgPSBwcmV2aW91czsKCiAgICAgIGlmIChwcmV2aW91cykKICAgICAgICBwcmV2aW91cy5uZXh0ID0gYTsKCiAgICAgIHRvYy5hcHBlbmRDaGlsZChhKTsKCiAgICAgIGlmIChpID09IDApCiAgICAgICAgdG9jLmZpcnN0ID0gYTsKCiAgICAgIGlmIChpIDwgdGhpcy5zbGlkZXMubGVuZ3RoIC0gMSkKICAgICAgewogICAgICAgIHZhciBiciA9IHRoaXMuY3JlYXRlX2VsZW1lbnQoImJyIik7CiAgICAgICAgdG9jLmFwcGVuZENoaWxkKGJyKTsKICAgICAgfQoKICAgICAgcHJldmlvdXMgPSBhOwogICAgfQoKICAgIHRvYy5mb2N1cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHRoaXMuZmlyc3QpCiAgICAgICAgdGhpcy5maXJzdC5mb2N1cygpOwogICAgfQoKICAgIHRvYy5vbm1vdXNldXAgPSB3M2Nfc2xpZHkubW91c2VfYnV0dG9uX3VwOwoKICAgIHRvYy5vbmNsaWNrID0gZnVuY3Rpb24gKGUpIHsKICAgICAgZXx8KGU9d2luZG93LmV2ZW50KTsKCiAgICAgIGlmICh3M2Nfc2xpZHkuc2VsZWN0ZWRfdGV4dF9sZW4gPD0gMCkKICAgICAgICAgdzNjX3NsaWR5LmhpZGVfdGFibGVfb2ZfY29udGVudHModHJ1ZSk7CgogICAgICB3M2Nfc2xpZHkuc3RvcF9wcm9wYWdhdGlvbihlKTsKICAgIAogICAgICBpZiAoZS5jYW5jZWwgIT0gdW5kZWZpbmVkKQogICAgICAgIGUuY2FuY2VsID0gdHJ1ZTsKICAgICAgCiAgICAgIGlmIChlLnJldHVyblZhbHVlICE9IHVuZGVmaW5lZCkKICAgICAgICBlLnJldHVyblZhbHVlID0gZmFsc2U7CiAgICAgIAogICAgICByZXR1cm4gZmFsc2U7CiAgICB9OwoKICAgIGRvY3VtZW50LmJvZHkuaW5zZXJ0QmVmb3JlKHRvYywgZG9jdW1lbnQuYm9keS5maXJzdENoaWxkKTsKICAgIHJldHVybiB0b2M7CiAgfSwKCiAgaXNfc2hvd25fdG9jOiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gIXczY19zbGlkeS5oYXNfY2xhc3ModzNjX3NsaWR5LnRvYywgImhpZGRlbiIpOwogIH0sCgogIHNob3dfdGFibGVfb2ZfY29udGVudHM6IGZ1bmN0aW9uICgpIHsKICAgIHczY19zbGlkeS5yZW1vdmVfY2xhc3ModzNjX3NsaWR5LnRvYywgImhpZGRlbiIpOwogICAgdmFyIHRvYyA9IHczY19zbGlkeS50b2M7CiAgICB0b2MuZm9jdXMoKTsKCiAgICBpZiAodzNjX3NsaWR5LmllNyAmJiB3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyID09IDApCiAgICAgIHNldFRpbWVvdXQodzNjX3NsaWR5LmllX2hhY2ssIDEwMCk7CiAgfSwKCiAgaGlkZV90YWJsZV9vZl9jb250ZW50czogZnVuY3Rpb24gKGZvY3VzKSB7CiAgICB3M2Nfc2xpZHkuYWRkX2NsYXNzKHczY19zbGlkeS50b2MsICJoaWRkZW4iKTsKCiAgICBpZiAoZm9jdXMgJiYgIXczY19zbGlkeS5vcGVyYSAmJgogICAgICAgICF3M2Nfc2xpZHkuaGFzX2NsYXNzKHczY19zbGlkeS50b2MsICJoaWRkZW4iKSkKICAgICAgdzNjX3NsaWR5LnNldF9mb2N1cygpOwogIH0sCgogIHRvZ2dsZV90YWJsZV9vZl9jb250ZW50czogZnVuY3Rpb24gKCkgewogICAgaWYgKHczY19zbGlkeS5pc19zaG93bl90b2MoKSkKICAgICAgdzNjX3NsaWR5LmhpZGVfdGFibGVfb2ZfY29udGVudHModHJ1ZSk7CiAgICBlbHNlCiAgICAgIHczY19zbGlkeS5zaG93X3RhYmxlX29mX2NvbnRlbnRzKCk7CiAgfSwKCiAgLy8gY2FsbGVkIG9uIGNsaWNraW5nIHRvYyBlbnRyeQogIHRvY19jbGljazogZnVuY3Rpb24gKGUpIHsKICAgIGlmICghZSkKICAgICAgZSA9IHdpbmRvdy5ldmVudDsKCiAgICB2YXIgdGFyZ2V0ID0gdzNjX3NsaWR5LmdldF90YXJnZXQoZSk7CgogICAgaWYgKHRhcmdldCAmJiB0YXJnZXQubm9kZVR5cGUgPT0gMSkKICAgIHsKICAgICAgdmFyIHVyaSA9IHRhcmdldC5nZXRBdHRyaWJ1dGUoImhyZWYiKTsKCiAgICAgIGlmICh1cmkpCiAgICAgIHsKICAgICAgICAvL2FsZXJ0KCJnb2luZyB0byAiICsgdXJpKTsKICAgICAgICB2YXIgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwogICAgICAgIHczY19zbGlkeS5oaWRlX3NsaWRlKHNsaWRlKTsKICAgICAgICB3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyID0gdzNjX3NsaWR5LmZpbmRfc2xpZGVfbnVtYmVyKHVyaSk7CiAgICAgICAgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwogICAgICAgIHczY19zbGlkeS5sYXN0X3Nob3duID0gbnVsbDsKICAgICAgICB3M2Nfc2xpZHkuc2V0X2xvY2F0aW9uKCk7CiAgICAgICAgdzNjX3NsaWR5LnNldF92aXNpYmlsaXR5X2FsbF9pbmNyZW1lbnRhbCgiaGlkZGVuIik7CiAgICAgICAgdzNjX3NsaWR5LnNldF9lb3Nfc3RhdHVzKCF3M2Nfc2xpZHkubmV4dF9pbmNyZW1lbnRhbF9pdGVtKHczY19zbGlkeS5sYXN0X3Nob3duKSk7CiAgICAgICAgdzNjX3NsaWR5LnNob3dfc2xpZGUoc2xpZGUpOwogICAgICAgIC8vdGFyZ2V0LmZvY3VzKCk7CgogICAgICAgIHRyeQogICAgICAgIHsKICAgICAgICAgIGlmICghdzNjX3NsaWR5Lm9wZXJhKQogICAgICAgICAgICB3M2Nfc2xpZHkuc2V0X2ZvY3VzKCk7CiAgICAgICAgfQogICAgICAgIGNhdGNoIChlKQogICAgICAgIHsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICB3M2Nfc2xpZHkuaGlkZV90YWJsZV9vZl9jb250ZW50cyh0cnVlKTsKICAgIGlmICh3M2Nfc2xpZHkuaWU3KSB3M2Nfc2xpZHkuaWVfaGFjaygpOwogICAgdzNjX3NsaWR5LnN0b3BfcHJvcGFnYXRpb24oZSk7CiAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChlKTsKICB9LAoKICAvLyBjYWxsZWQgb25rZXlkb3duIGZvciB0b2MgZW50cnkKICB0b2Nfa2V5X2Rvd246IGZ1bmN0aW9uIChldmVudCkgewogICAgdmFyIGtleTsKCiAgICBpZiAoIWV2ZW50KQogICAgICB2YXIgZXZlbnQgPSB3aW5kb3cuZXZlbnQ7CgogICAgLy8ga2x1ZGdlIGFyb3VuZCBOUy9JRSBkaWZmZXJlbmNlcyAKICAgIGlmICh3aW5kb3cuZXZlbnQpCiAgICAgIGtleSA9IHdpbmRvdy5ldmVudC5rZXlDb2RlOwogICAgZWxzZSBpZiAoZXZlbnQud2hpY2gpCiAgICAgIGtleSA9IGV2ZW50LndoaWNoOwogICAgZWxzZQogICAgICByZXR1cm4gdHJ1ZTsgLy8gWWlrZXMhIHVua25vd24gYnJvd3NlcgoKICAgIC8vIGlnbm9yZSBldmVudCBpZiBrZXkgdmFsdWUgaXMgemVybwogICAgLy8gYXMgZm9yIGFsdCBvbiBPcGVyYSBhbmQgS29ucXVlcm9yCiAgICBpZiAoIWtleSkKICAgICAgcmV0dXJuIHRydWU7CgogICAgLy8gY2hlY2sgZm9yIGNvbmN1cnJlbnQgY29udHJvbC9jb21tYW5kL2FsdCBrZXkKICAgIC8vIGJ1dCBhcmUgdGhlc2Ugb25seSBwcmVzZW50IG9uIG1vdXNlIGV2ZW50cz8KCiAgICBpZiAoZXZlbnQuY3RybEtleSB8fCBldmVudC5hbHRLZXkpCiAgICAgIHJldHVybiB0cnVlOwoKICAgIGlmIChrZXkgPT0gMTMpCiAgICB7CiAgICAgIHZhciB1cmkgPSB0aGlzLmdldEF0dHJpYnV0ZSgiaHJlZiIpOwoKICAgICAgaWYgKHVyaSkKICAgICAgewogICAgICAgIC8vYWxlcnQoImdvaW5nIHRvICIgKyB1cmkpOwogICAgICAgdmFyIHNsaWRlID0gdzNjX3NsaWR5LnNsaWRlc1t3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyXTsKICAgICAgICB3M2Nfc2xpZHkuaGlkZV9zbGlkZShzbGlkZSk7CiAgICAgICAgdzNjX3NsaWR5LnNsaWRlX251bWJlciA9IHczY19zbGlkeS5maW5kX3NsaWRlX251bWJlcih1cmkpOwogICAgICAgIHNsaWRlID0gdzNjX3NsaWR5LnNsaWRlc1t3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyXTsKICAgICAgICB3M2Nfc2xpZHkubGFzdF9zaG93biA9IG51bGw7CiAgICAgICAgdzNjX3NsaWR5LnNldF9sb2NhdGlvbigpOwogICAgICAgIHczY19zbGlkeS5zZXRfdmlzaWJpbGl0eV9hbGxfaW5jcmVtZW50YWwoImhpZGRlbiIpOwogICAgICAgIHczY19zbGlkeS5zZXRfZW9zX3N0YXR1cyghdzNjX3NsaWR5Lm5leHRfaW5jcmVtZW50YWxfaXRlbSh3M2Nfc2xpZHkubGFzdF9zaG93bikpOwogICAgICAgIHczY19zbGlkeS5zaG93X3NsaWRlKHNsaWRlKTsKICAgICAgICAvL3RhcmdldC5mb2N1cygpOwoKICAgICAgICB0cnkKICAgICAgICB7CiAgICAgICAgICBpZiAoIXczY19zbGlkeS5vcGVyYSkKICAgICAgICAgICAgdzNjX3NsaWR5LnNldF9mb2N1cygpOwogICAgICAgIH0KICAgICAgICBjYXRjaCAoZSkKICAgICAgICB7CiAgICAgICAgfQogICAgICB9CgogICAgICB3M2Nfc2xpZHkuaGlkZV90YWJsZV9vZl9jb250ZW50cyh0cnVlKTsKCiAgICAgIGlmIChzZWxmLmllNykKICAgICAgIHczY19zbGlkeS5pZV9oYWNrKCk7CgogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CiAgICB9CgogICAgaWYgKGtleSA9PSA0MCAmJiB0aGlzLm5leHQpCiAgICB7CiAgICAgIHRoaXMubmV4dC5mb2N1cygpOwogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CiAgICB9CgogICAgaWYgKGtleSA9PSAzOCAmJiB0aGlzLnByZXZpb3VzKQogICAgewogICAgICB0aGlzLnByZXZpb3VzLmZvY3VzKCk7CiAgICAgIHJldHVybiB3M2Nfc2xpZHkuY2FuY2VsKGV2ZW50KTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9LAoKICB0b3VjaHN0YXJ0OiBmdW5jdGlvbiAoZSkKICB7CiAgICAvLyBhIGRvdWJsZSB0b3VjaCBvZnRlbiBzdGFydHMgd2l0aCBhCiAgICAvLyBzaW5nbGUgdG91Y2ggZHVlIHRvIGZpbmdlcnMgdG91Y2hpbmcKICAgIC8vIGRvd24gYXQgc2xpZ2h0bHkgZGlmZmVyZW50IHRpbWVzCiAgICAvLyB0aHVzIGF2b2lkIGNhbGxpbmcgcHJldmVudERlZmF1bHQgaGVyZQogICAgdGhpcy5wcmV2X3RhcCA9IHRoaXMubGFzdF90YXA7CiAgICB0aGlzLmxhc3RfdGFwID0gKG5ldyBEYXRlKS5nZXRUaW1lKCk7CgogICAgdmFyIHRhcF9kZWxheSA9IHRoaXMubGFzdF90YXAgLSB0aGlzLnByZXZfdGFwOwoKICAgIGlmICh0YXBfZGVsYXkgPD0gMjAwKQogICAgewogICAgICAvLyBkb3VibGUgdGFwCiAgICB9CgogICAgdmFyIHRvdWNoID0gZS50b3VjaGVzWzBdOwoKICAgIHRoaXMucGFnZVggPSB0b3VjaC5wYWdlWDsKICAgIHRoaXMucGFnZVkgPSB0b3VjaC5wYWdlWTsKICAgIHRoaXMuc2NyZWVuWCA9IHRvdWNoLnNjcmVlblg7CiAgICB0aGlzLnNjcmVlblkgPSB0b3VjaC5zY3JlZW5ZOwogICAgdGhpcy5jbGllbnRYID0gdG91Y2guY2xpZW50WDsKICAgIHRoaXMuY2xpZW50WSA9IHRvdWNoLmNsaWVudFk7CgogICAgdGhpcy5kZWx0YV94ID0gdGhpcy5kZWx0YV95ID0gMDsKICB9LAoKICB0b3VjaG1vdmU6IGZ1bmN0aW9uIChlKQogIHsKICAgIC8vIG92ZXJyaWRlIG5hdGl2ZSBnZXN0dXJlcyBmb3Igc2luZ2xlIHRvdWNoCiAgICBpZiAoZS50b3VjaGVzLmxlbmd0aCA+IDEpCiAgICAgIHJldHVybjsKCiAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICB2YXIgdG91Y2ggPSBlLnRvdWNoZXNbMF07CiAgICB0aGlzLmRlbHRhX3ggPSB0b3VjaC5wYWdlWCAtIHRoaXMucGFnZVg7CiAgICB0aGlzLmRlbHRhX3kgPSB0b3VjaC5wYWdlWSAtIHRoaXMucGFnZVk7CiAgfSwKCiAgdG91Y2hlbmQ6IGZ1bmN0aW9uIChlKQogIHsKICAgIC8vIGRlZmF1bHQgYmVoYXZpb3IgZm9yIG11bHRpLXRvdWNoCiAgICBpZiAoZS50b3VjaGVzLmxlbmd0aCA+IDEpCiAgICAgIHJldHVybjsKCiAgICB2YXIgZGVsYXkgPSAobmV3IERhdGUpLmdldFRpbWUoKSAtIHRoaXMubGFzdF90YXA7CiAgICB2YXIgZHggPSB0aGlzLmRlbHRhX3g7CiAgICB2YXIgZHkgPSB0aGlzLmRlbHRhX3k7CiAgICB2YXIgYWJzX2R4ID0gTWF0aC5hYnMoZHgpOwogICAgdmFyIGFic19keSA9IE1hdGguYWJzKGR5KTsKCiAgICBpZiAoZGVsYXkgPCA1MDAgJiYgKGFic19keCA+IDEwMCB8fCBhYnNfZHkgPiAxMDApKQogICAgewogICAgICBpZiAoYWJzX2R4ID4gMC41ICogYWJzX2R5KQogICAgICB7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwoKICAgICAgICBpZiAoZHggPCAwKQogICAgICAgICAgdzNjX3NsaWR5Lm5leHRfc2xpZGUodHJ1ZSk7CiAgICAgICAgZWxzZQogICAgICAgICAgdzNjX3NsaWR5LnByZXZpb3VzX3NsaWRlKHRydWUpOwogICAgICB9CiAgICAgIGVsc2UgaWYgKGFic19keSA+IDIgKiBhYnNfZHgpCiAgICAgIHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgdzNjX3NsaWR5LnRvZ2dsZV90YWJsZV9vZl9jb250ZW50cygpOwogICAgICB9CiAgICB9CiAgfSwKCiAgLy8gIyMjIE9CU09MRVRFICMjIwogIGJlZm9yZV9wcmludDogZnVuY3Rpb24gKCkgewogICAgdGhpcy5zaG93X2FsbF9zbGlkZXMoKTsKICAgIHRoaXMuaGlkZV90b29sYmFyKCk7CiAgICBhbGVydCgiYmVmb3JlIHByaW50Iik7CiAgfSwKCiAgLy8gIyMjIE9CU09MRVRFICMjIwogIGFmdGVyX3ByaW50OiBmdW5jdGlvbiAoKSB7CiAgICBpZiAoIXRoaXMudmlld19hbGwpCiAgICB7CiAgICAgIHRoaXMuc2luZ2xlX3NsaWRlX3ZpZXcoKTsKICAgICAgdGhpcy5zaG93X3Rvb2xiYXIoKTsKICAgIH0KICAgIGFsZXJ0KCJhZnRlciBwcmludCIpOwogIH0sCgogIC8vICMjIyBPQlNPTEVURSAjIyMKICBwcmludF9zbGlkZXM6IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuYmVmb3JlX3ByaW50KCk7CiAgICB3aW5kb3cucHJpbnQoKTsKICAgIHRoaXMuYWZ0ZXJfcHJpbnQoKTsKICB9LAoKICAvLyAjIyMgT0JTT0xFVEUgPz8gIyMjCiAgdG9nZ2xlX3ZpZXc6IGZ1bmN0aW9uICgpIHsKICAgIGlmICh0aGlzLnZpZXdfYWxsKQogICAgewogICAgICB0aGlzLnNpbmdsZV9zbGlkZV92aWV3KCk7CiAgICAgIHRoaXMuc2hvd190b29sYmFyKCk7CiAgICAgIHRoaXMudmlld19hbGwgPSAwOwogICAgfQogICAgZWxzZQogICAgewogICAgICB0aGlzLnNob3dfYWxsX3NsaWRlcygpOwogICAgICB0aGlzLmhpZGVfdG9vbGJhcigpOwogICAgICB0aGlzLnZpZXdfYWxsID0gMTsKICAgIH0KICB9LAoKICAvLyBwcmVwYXJlIGZvciBwcmludGluZyAgIyMjIE9CU09MRVRFICMjIwogIHNob3dfYWxsX3NsaWRlczogZnVuY3Rpb24gKCkgewogICAgdGhpcy5yZW1vdmVfY2xhc3MoZG9jdW1lbnQuYm9keSwgInNpbmdsZV9zbGlkZSIpOwogICAgdGhpcy5zZXRfdmlzaWJpbGl0eV9hbGxfaW5jcmVtZW50YWwoInZpc2libGUiKTsKICB9LAoKICAvLyByZXN0b3JlIGFmdGVyIHByaW50aW5nICAjIyMgT0JTT0xFVEUgIyMjCiAgc2luZ2xlX3NsaWRlX3ZpZXc6IGZ1bmN0aW9uICgpIHsKICAgIHRoaXMuYWRkX2NsYXNzKGRvY3VtZW50LmJvZHksICJzaW5nbGVfc2xpZGUiKTsKICAgIHRoaXMuc2V0X3Zpc2liaWxpdHlfYWxsX2luY3JlbWVudGFsKCJ2aXNpYmxlIik7CiAgICB0aGlzLmxhc3Rfc2hvd24gPSB0aGlzLnByZXZpb3VzX2luY3JlbWVudGFsX2l0ZW0obnVsbCk7CiAgfSwKCiAgLy8gc3VwcHJlc3MgSUUncyBpbWFnZSB0b29sYmFyIHBvcCB1cAogIGhpZGVfaW1hZ2VfdG9vbGJhcjogZnVuY3Rpb24gKCkgewogICAgaWYgKCF0aGlzLm5zX3BvcykKICAgIHsKICAgICAgdmFyIGltYWdlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJJTUciKTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaW1hZ2VzLmxlbmd0aDsgKytpKQogICAgICAgIGltYWdlc1tpXS5zZXRBdHRyaWJ1dGUoImdhbGxlcnlpbWciLCAibm8iKTsKICAgIH0KICB9LAoKICB1bmxvYWRlZDogZnVuY3Rpb24gKGUpIHsKICAgIC8vYWxlcnQoInVubG9hZGVkIik7CiAgfSwKCiAgLy8gU2FmYXJpIGFuZCBLb25xdWVyb3IgZG9uJ3QgeWV0IHN1cHBvcnQgZ2V0Q29tcHV0ZWRTdHlsZSgpCiAgLy8gYW5kIHRoZXkgYWx3YXlzIHJlbG9hZCBwYWdlIHdoZW4gbG9jYXRpb24uaHJlZiBpcyB1cGRhdGVkCiAgaXNfS0hUTUw6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBhZ2VudCA9IG5hdmlnYXRvci51c2VyQWdlbnQ7CiAgICByZXR1cm4gKGFnZW50LmluZGV4T2YoIktIVE1MIikgPj0gMCA/IHRydWUgOiBmYWxzZSk7CiAgfSwKCiAgLy8gZmluZCBzbGlkZSBuYW1lIGZyb20gZmlyc3QgaDEgZWxlbWVudAogIC8vIGRlZmF1bHQgdG8gZG9jdW1lbnQgdGl0bGUgKyBzbGlkZSBudW1iZXIKICBzbGlkZV9uYW1lOiBmdW5jdGlvbiAoaW5kZXgpIHsKICAgIHZhciBuYW1lID0gbnVsbDsKICAgIHZhciBzbGlkZSA9IHRoaXMuc2xpZGVzW2luZGV4XTsKCiAgICB2YXIgaGVhZGluZyA9IHRoaXMuZmluZF9oZWFkaW5nKHNsaWRlKTsKCiAgICBpZiAoaGVhZGluZykKICAgICAgbmFtZSA9IHRoaXMuZXh0cmFjdF90ZXh0KGhlYWRpbmcpOwoKICAgIGlmICghbmFtZSkKICAgICAgbmFtZSA9IHRoaXMudGl0bGUgKyAiKCIgKyAoaW5kZXggKyAxKSArICIpIjsKCiAgICBuYW1lLnJlcGxhY2UoL1wmL2csICImYW1wOyIpOwogICAgbmFtZS5yZXBsYWNlKC9cPC9nLCAiJmx0OyIpOwogICAgbmFtZS5yZXBsYWNlKC9cPi9nLCAiJmd0OyIpOwoKICAgIHJldHVybiBuYW1lOwogIH0sCgogIC8vIGZpbmQgZmlyc3QgaDEgZWxlbWVudCBpbiBET00gdHJlZQogIGZpbmRfaGVhZGluZzogZnVuY3Rpb24gKG5vZGUpIHsKICAgIGlmICghbm9kZSB8fCBub2RlLm5vZGVUeXBlICE9IDEpCiAgICAgIHJldHVybiBudWxsOwoKICAgIGlmIChub2RlLm5vZGVOYW1lID09ICJIMSIgfHwgbm9kZS5ub2RlTmFtZSA9PSAiaDEiKQogICAgICByZXR1cm4gbm9kZTsKCiAgICB2YXIgY2hpbGQgPSBub2RlLmZpcnN0Q2hpbGQ7CgogICAgd2hpbGUgKGNoaWxkKQogICAgewogICAgICBub2RlID0gdGhpcy5maW5kX2hlYWRpbmcoY2hpbGQpOwoKICAgICAgaWYgKG5vZGUpCiAgICAgICAgcmV0dXJuIG5vZGU7CgogICAgICBjaGlsZCA9IGNoaWxkLm5leHRTaWJsaW5nOwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0sCgogIC8vIHJlY3Vyc2l2ZWx5IGV4dHJhY3QgdGV4dCBmcm9tIERPTSB0cmVlCiAgZXh0cmFjdF90ZXh0OiBmdW5jdGlvbiAobm9kZSkgewogICAgaWYgKCFub2RlKQogICAgICByZXR1cm4gIiI7CgogICAgLy8gdGV4dCBub2RlcwogICAgaWYgKG5vZGUubm9kZVR5cGUgPT0gMykKICAgICAgcmV0dXJuIG5vZGUubm9kZVZhbHVlOwoKICAgIC8vIGVsZW1lbnRzCiAgICBpZiAobm9kZS5ub2RlVHlwZSA9PSAxKQogICAgewogICAgICBub2RlID0gbm9kZS5maXJzdENoaWxkOwogICAgICB2YXIgdGV4dCA9ICIiOwoKICAgICAgd2hpbGUgKG5vZGUpCiAgICAgIHsKICAgICAgICB0ZXh0ID0gdGV4dCArIHRoaXMuZXh0cmFjdF90ZXh0KG5vZGUpOwogICAgICAgIG5vZGUgPSBub2RlLm5leHRTaWJsaW5nOwogICAgICB9CgogICAgICByZXR1cm4gdGV4dDsKICAgIH0KCiAgICByZXR1cm4gIiI7CiAgfSwKCiAgLy8gZmluZCBjb3B5cmlnaHQgdGV4dCBmcm9tIG1ldGEgZWxlbWVudAogIGZpbmRfY29weXJpZ2h0OiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgbmFtZSwgY29udGVudDsKICAgIHZhciBtZXRhID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIm1ldGEiKTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1ldGEubGVuZ3RoOyArK2kpCiAgICB7CiAgICAgIG5hbWUgPSBtZXRhW2ldLmdldEF0dHJpYnV0ZSgibmFtZSIpOwogICAgICBjb250ZW50ID0gbWV0YVtpXS5nZXRBdHRyaWJ1dGUoImNvbnRlbnQiKTsKCiAgICAgIGlmIChuYW1lID09ICJjb3B5cmlnaHQiKQogICAgICAgIHJldHVybiBjb250ZW50OwogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0sCgogIGZpbmRfc2l6ZV9hZGp1c3Q6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBuYW1lLCBjb250ZW50LCBvZmZzZXQ7CiAgICB2YXIgbWV0YSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJtZXRhIik7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtZXRhLmxlbmd0aDsgKytpKQogICAgewogICAgICBuYW1lID0gbWV0YVtpXS5nZXRBdHRyaWJ1dGUoIm5hbWUiKTsKICAgICAgY29udGVudCA9IG1ldGFbaV0uZ2V0QXR0cmlidXRlKCJjb250ZW50Iik7CgogICAgICBpZiAobmFtZSA9PSAiZm9udC1zaXplLWFkanVzdG1lbnQiKQogICAgICAgIHJldHVybiAxICogY29udGVudDsKICAgIH0KCiAgICByZXR1cm4gMTsKICB9LAoKICAvLyA8bWV0YSBuYW1lPSJkdXJhdGlvbiIgY29udGVudD0iMjAiIC8+ICBmb3IgMjAgbWludXRlcwogIGZpbmRfZHVyYXRpb246IGZ1bmN0aW9uICgpIHsKICAgIHZhciBuYW1lLCBjb250ZW50LCBvZmZzZXQ7CiAgICB2YXIgbWV0YSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJtZXRhIik7CgogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtZXRhLmxlbmd0aDsgKytpKQogICAgewogICAgICBuYW1lID0gbWV0YVtpXS5nZXRBdHRyaWJ1dGUoIm5hbWUiKTsKICAgICAgY29udGVudCA9IG1ldGFbaV0uZ2V0QXR0cmlidXRlKCJjb250ZW50Iik7CgogICAgICBpZiAobmFtZSA9PSAiZHVyYXRpb24iKQogICAgICAgIHJldHVybiA2MDAwMCAqIGNvbnRlbnQ7CiAgICB9CgogICAgcmV0dXJuIG51bGw7CiAgfSwKCiAgcmVwbGFjZV9ieV9ub25fYnJlYWtpbmdfc3BhY2U6IGZ1bmN0aW9uIChzdHIpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgKytpKQogICAgICBzdHJbaV0gPSAxNjA7CiAgfSwKCiAgLy8gIyMjIENIRUNLIE1FICMjIyBpcyB1c2Ugb2YgImxpIiBva2F5IGZvciB0ZXh0L2h0bWw/CiAgLy8gZm9yIFhIVE1MIGRvIHdlIGFsc28gbmVlZCB0byBzcGVjaWZ5IG5hbWVzcGFjZT8KICBpbml0X291dGxpbmVyOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgaXRlbXMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgibGkiKTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgKytpKQogICAgewogICAgICB2YXIgdGFyZ2V0ID0gaXRlbXNbaV07CgogICAgICBpZiAoIXRoaXMuaGFzX2NsYXNzKHRhcmdldC5wYXJlbnROb2RlLCAib3V0bGluZSIpKQogICAgICAgIGNvbnRpbnVlOwoKICAgICAgdGFyZ2V0Lm9uY2xpY2sgPSB0aGlzLm91dGxpbmVfY2xpY2s7Ci8qICMjIyBtb3JlIHdvcmsgbmVlZGVkIGZvciBJRTYKICAgICAgaWYgKCF0aGlzLm5zX3BvcykKICAgICAgewogICAgICAgIHRhcmdldC5vbm1vdXNlb3ZlciA9IHRoaXMuaG92ZXJfb3V0bGluZTsKICAgICAgICB0YXJnZXQub25tb3VzZW91dCA9IHRoaXMudW5ob3Zlcl9vdXRsaW5lOwogICAgICB9CiovCiAgICAgIGlmICh0aGlzLmZvbGRhYmxlKHRhcmdldCkpCiAgICAgIHsKICAgICAgICB0YXJnZXQuZm9sZGFibGUgPSB0cnVlOwogICAgICAgIHRhcmdldC5vbmZvY3VzID0gZnVuY3Rpb24gKCkge3czY19zbGlkeS5vdXRsaW5lID0gdGhpczt9OwogICAgICAgIHRhcmdldC5vbmJsdXIgPSBmdW5jdGlvbiAoKSB7dzNjX3NsaWR5Lm91dGxpbmUgPSBudWxsO307CgogICAgICAgIGlmICghdGFyZ2V0LmdldEF0dHJpYnV0ZSgidGFiaW5kZXgiKSkKICAgICAgICAgIHRhcmdldC5zZXRBdHRyaWJ1dGUoInRhYmluZGV4IiwgIjAiKTsKCiAgICAgICAgaWYgKHRoaXMuaGFzX2NsYXNzKHRhcmdldCwgImV4cGFuZCIpKQogICAgICAgICAgdGhpcy51bmZvbGQodGFyZ2V0KTsKICAgICAgICBlbHNlCiAgICAgICAgICB0aGlzLmZvbGQodGFyZ2V0KTsKICAgICAgfQogICAgICBlbHNlCiAgICAgIHsKICAgICAgICB0aGlzLmFkZF9jbGFzcyh0YXJnZXQsICJub2ZvbGQiKTsKICAgICAgICB0YXJnZXQudmlzaWJsZSA9IHRydWU7CiAgICAgICAgdGFyZ2V0LmZvbGRhYmxlID0gZmFsc2U7CiAgICAgIH0KICAgIH0KICB9LAoKICBmb2xkYWJsZTogZnVuY3Rpb24gKGl0ZW0pIHsKICAgIGlmICghaXRlbSB8fCBpdGVtLm5vZGVUeXBlICE9IDEpCiAgICAgIHJldHVybiBmYWxzZTsKCiAgICB2YXIgbm9kZSA9IGl0ZW0uZmlyc3RDaGlsZDsKCiAgICB3aGlsZSAobm9kZSkKICAgIHsKICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT0gMSAmJiB0aGlzLmlzX2Jsb2NrKG5vZGUpKQogICAgICAgIHJldHVybiB0cnVlOwoKICAgICAgbm9kZSA9IG5vZGUubmV4dFNpYmxpbmc7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0sCgogIC8vICMjIyBDSEVDSyBNRSAjIyMgc3dpdGNoIHRvIGFkZC9yZW1vdmUgImhpZGRlbiIgY2xhc3MKICBmb2xkOiBmdW5jdGlvbiAoaXRlbSkgewogICAgaWYgKGl0ZW0pCiAgICB7CiAgICAgIHRoaXMucmVtb3ZlX2NsYXNzKGl0ZW0sICJ1bmZvbGRlZCIpOwogICAgICB0aGlzLmFkZF9jbGFzcyhpdGVtLCAiZm9sZGVkIik7CiAgICB9CgogICAgdmFyIG5vZGUgPSBpdGVtID8gaXRlbS5maXJzdENoaWxkIDogbnVsbDsKCiAgICB3aGlsZSAobm9kZSkKICAgIHsKICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT0gMSAmJiB0aGlzLmlzX2Jsb2NrKG5vZGUpKSAvLyBlbGVtZW50CiAgICAgIHsKICAgICAgICAgdzNjX3NsaWR5LmFkZF9jbGFzcyhub2RlLCAiaGlkZGVuIik7CiAgICAgIH0KCiAgICAgIG5vZGUgPSBub2RlLm5leHRTaWJsaW5nOwogICAgfQoKICAgIGl0ZW0udmlzaWJsZSA9IGZhbHNlOwogIH0sCgogIC8vICMjIyBDSEVDSyBNRSAjIyMgc3dpdGNoIHRvIGFkZC9yZW1vdmUgImhpZGRlbiIgY2xhc3MKICB1bmZvbGQ6IGZ1bmN0aW9uIChpdGVtKSB7CiAgICBpZiAoaXRlbSkKICAgIHsKICAgICAgdGhpcy5hZGRfY2xhc3MoaXRlbSwgInVuZm9sZGVkIik7CiAgICAgIHRoaXMucmVtb3ZlX2NsYXNzKGl0ZW0sICJmb2xkZWQiKTsKICAgIH0KCiAgICB2YXIgbm9kZSA9IGl0ZW0gPyBpdGVtLmZpcnN0Q2hpbGQgOiBudWxsOwoKICAgIHdoaWxlIChub2RlKQogICAgewogICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PSAxICYmIHRoaXMuaXNfYmxvY2sobm9kZSkpIC8vIGVsZW1lbnQKICAgICAgewogICAgICAgIHczY19zbGlkeS5yZW1vdmVfY2xhc3Mobm9kZSwgImhpZGRlbiIpOwogICAgICB9CgogICAgICBub2RlID0gbm9kZS5uZXh0U2libGluZzsKICAgIH0KCiAgICBpdGVtLnZpc2libGUgPSB0cnVlOwogIH0sCgogIG91dGxpbmVfY2xpY2s6IGZ1bmN0aW9uIChlKSB7CiAgICBpZiAoIWUpCiAgICAgIGUgPSB3aW5kb3cuZXZlbnQ7CgogICAgdmFyIHJpZ2h0Y2xpY2sgPSBmYWxzZTsKICAgIHZhciB0YXJnZXQgPSB3M2Nfc2xpZHkuZ2V0X3RhcmdldChlKTsKCiAgICB3aGlsZSAodGFyZ2V0ICYmIHRhcmdldC52aXNpYmxlID09IHVuZGVmaW5lZCkKICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7CgogICAgaWYgKCF0YXJnZXQpCiAgICAgIHJldHVybiB0cnVlOwoKICAgIGlmIChlLndoaWNoKQogICAgICByaWdodGNsaWNrID0gKGUud2hpY2ggPT0gMyk7CiAgICBlbHNlIGlmIChlLmJ1dHRvbikKICAgICAgcmlnaHRjbGljayA9IChlLmJ1dHRvbiA9PSAyKTsKCiAgICBpZiAoIXJpZ2h0Y2xpY2sgJiYgdGFyZ2V0LnZpc2libGUgIT0gdW5kZWZpbmVkKQogICAgewogICAgICBpZiAodGFyZ2V0LmZvbGRhYmxlKQogICAgICB7CiAgICAgICAgaWYgKHRhcmdldC52aXNpYmxlKQogICAgICAgICAgdzNjX3NsaWR5LmZvbGQodGFyZ2V0KTsKICAgICAgICBlbHNlCiAgICAgICAgICB3M2Nfc2xpZHkudW5mb2xkKHRhcmdldCk7CiAgICAgIH0KCiAgICAgIHczY19zbGlkeS5zdG9wX3Byb3BhZ2F0aW9uKGUpOwogICAgICBlLmNhbmNlbCA9IHRydWU7CiAgICAgIGUucmV0dXJuVmFsdWUgPSBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfSwKCiAgYWRkX2luaXRpYWxfcHJvbXB0OiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgcHJvbXB0ID0gdGhpcy5jcmVhdGVfZWxlbWVudCgiZGl2Iik7CiAgICBwcm9tcHQuc2V0QXR0cmlidXRlKCJjbGFzcyIsICJpbml0aWFsX3Byb21wdCIpOwoKICAgIHZhciBwMSA9IHRoaXMuY3JlYXRlX2VsZW1lbnQoInAiKTsKICAgIHByb21wdC5hcHBlbmRDaGlsZChwMSk7CiAgICBwMS5zZXRBdHRyaWJ1dGUoImNsYXNzIiwgImhlbHAiKTsKCiAgICBpZiAodGhpcy5rZXlib2FyZGxlc3MpCiAgICAgIHAxLmlubmVySFRNTCA9ICJzd2lwZSBsZWZ0IHRvIG1vdmUgdG8gbmV4dCBzbGlkZSI7CiAgICBlbHNlCiAgICAgIHAxLmlubmVySFRNTCA9ICJTcGFjZSwgUmlnaHQgQXJyb3cgb3Igc3dpcGUgbGVmdCB0byBtb3ZlIHRvICIgKwogICAgICAgICAgICAgICAgICAgICAibmV4dCBzbGlkZSwgY2xpY2sgaGVscCBiZWxvdyBmb3IgbW9yZSBkZXRhaWxzIjsKCiAgICB0aGlzLmFkZF9saXN0ZW5lcihwcm9tcHQsICJjbGljayIsIGZ1bmN0aW9uIChlKSB7CiAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQocHJvbXB0KTsKICAgICAgdzNjX3NsaWR5LnN0b3BfcHJvcGFnYXRpb24oZSk7CiAgICAKICAgICAgaWYgKGUuY2FuY2VsICE9IHVuZGVmaW5lZCkKICAgICAgICBlLmNhbmNlbCA9IHRydWU7CiAgICAgIAogICAgICBpZiAoZS5yZXR1cm5WYWx1ZSAhPSB1bmRlZmluZWQpCiAgICAgICAgZS5yZXR1cm5WYWx1ZSA9IGZhbHNlOwogICAgICAKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSk7CgogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChwcm9tcHQpOwogICAgdGhpcy5pbml0aWFsX3Byb21wdCA9IHByb21wdDsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7ZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChwcm9tcHQpO30sIDUwMDApOwogIH0sCgogIGFkZF90b29sYmFyOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgY291bnRlciwgcGFnZTsKCiAgICAgdGhpcy50b29sYmFyID0gdGhpcy5jcmVhdGVfZWxlbWVudCgiZGl2Iik7CiAgICAgdGhpcy50b29sYmFyLnNldEF0dHJpYnV0ZSgiY2xhc3MiLCAidG9vbGJhciIpOwoKICAgICAvLyBhIHJlYXNvbmFibHkgYmVoYXZlZCBicm93c2VyCiAgICAgaWYgKHRoaXMubnNfcG9zIHx8ICF0aGlzLmllNikKICAgICB7CiAgICAgICB2YXIgcmlnaHQgPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJkaXYiKTsKICAgICAgIHJpZ2h0LnNldEF0dHJpYnV0ZSgic3R5bGUiLCAiZmxvYXQ6IHJpZ2h0OyB0ZXh0LWFsaWduOiByaWdodCIpOwoKICAgICAgIGNvdW50ZXIgPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJzcGFuIikKICAgICAgIGNvdW50ZXIuaW5uZXJIVE1MID0gdGhpcy5sb2NhbGl6ZSgic2xpZGUiKSArICIgbi9tIjsKICAgICAgIHJpZ2h0LmFwcGVuZENoaWxkKGNvdW50ZXIpOwogICAgICAgdGhpcy50b29sYmFyLmFwcGVuZENoaWxkKHJpZ2h0KTsKCiAgICAgICB2YXIgbGVmdCA9IHRoaXMuY3JlYXRlX2VsZW1lbnQoImRpdiIpOwogICAgICAgbGVmdC5zZXRBdHRyaWJ1dGUoInN0eWxlIiwgInRleHQtYWxpZ246IGxlZnQiKTsKCiAgICAgICAvLyBnbG9iYWwgZW5kIG9mIHNsaWRlIGluZGljYXRvcgogICAgICAgdGhpcy5lb3MgPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJzcGFuIik7CiAgICAgICB0aGlzLmVvcy5pbm5lckhUTUwgPSAiKiAiOwogICAgICAgbGVmdC5hcHBlbmRDaGlsZCh0aGlzLmVvcyk7CgogICAgICAgdmFyIGhlbHAgPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJhIik7CiAgICAgICBoZWxwLnNldEF0dHJpYnV0ZSgiaHJlZiIsIHRoaXMuaGVscF9wYWdlKTsKICAgICAgIGhlbHAuc2V0QXR0cmlidXRlKCJ0aXRsZSIsIHRoaXMubG9jYWxpemUodGhpcy5oZWxwX3RleHQpKTsKICAgICAgIGhlbHAuaW5uZXJIVE1MID0gdGhpcy5sb2NhbGl6ZSgiaGVscD8iKTsKICAgICAgIGxlZnQuYXBwZW5kQ2hpbGQoaGVscCk7CiAgICAgICBoZWxwLnN0eWxlLmRpc3BsYXk9Im5vbmUiOyAKICAgICAgIHRoaXMuaGVscF9hbmNob3IgPSBoZWxwOyAgLy8gc2F2ZSBmb3IgZm9jdXMgaGFjawoKICAgICAgIHZhciBnYXAxID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoIiAiKTsKICAgICAgIGxlZnQuYXBwZW5kQ2hpbGQoZ2FwMSk7CgogICAgICAgdmFyIGNvbnRlbnRzID0gdGhpcy5jcmVhdGVfZWxlbWVudCgiYSIpOwogICAgICAgY29udGVudHMuc2V0QXR0cmlidXRlKCJocmVmIiwgImphdmFzY3JpcHQ6dzNjX3NsaWR5LnRvZ2dsZV90YWJsZV9vZl9jb250ZW50cygpIik7CiAgICAgICBjb250ZW50cy5zZXRBdHRyaWJ1dGUoInRpdGxlIiwgdGhpcy5sb2NhbGl6ZSgidGFibGUgb2YgY29udGVudHMiKSk7CiAgICAgICBjb250ZW50cy5pbm5lckhUTUwgPSB0aGlzLmxvY2FsaXplKCJDb250ZW50cyIpOwogICAgICAgbGVmdC5hcHBlbmRDaGlsZChjb250ZW50cyk7CgogICAgICAgdmFyIGdhcDIgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgiICIpOwogICAgICAgbGVmdC5hcHBlbmRDaGlsZChnYXAyKTsKCiAgICAgICB2YXIgY29weXJpZ2h0ID0gdGhpcy5maW5kX2NvcHlyaWdodCgpOwoKICAgICAgIGlmIChjb3B5cmlnaHQpCiAgICAgICB7CiAgICAgICAgIHZhciBzcGFuID0gdGhpcy5jcmVhdGVfZWxlbWVudCgic3BhbiIpOwogICAgICAgICBzcGFuLmNsYXNzTmFtZSA9ICJjb3B5cmlnaHQiOwogICAgICAgICBzcGFuLmlubmVySFRNTCA9IGNvcHlyaWdodDsKICAgICAgICAgbGVmdC5hcHBlbmRDaGlsZChzcGFuKTsKICAgICAgIH0KCiAgICAgICB0aGlzLnRvb2xiYXIuc2V0QXR0cmlidXRlKCJ0YWJpbmRleCIsICIwIik7CiAgICAgICB0aGlzLnRvb2xiYXIuYXBwZW5kQ2hpbGQobGVmdCk7CiAgICAgfQogICAgIGVsc2UgLy8gSUU2IHNvIG5lZWQgdG8gd29yayBhcm91bmQgaXRzIHBvb3IgQ1NTIHN1cHBvcnQKICAgICB7CiAgICAgICB0aGlzLnRvb2xiYXIuc3R5bGUucG9zaXRpb24gPSAodGhpcy5pZTcgPyAiZml4ZWQiIDogImFic29sdXRlIik7CiAgICAgICB0aGlzLnRvb2xiYXIuc3R5bGUuekluZGV4ID0gIjIwMCI7CiAgICAgICB0aGlzLnRvb2xiYXIuc3R5bGUud2lkdGggPSAiOTkuOSUiOwogICAgICAgdGhpcy50b29sYmFyLnN0eWxlLmhlaWdodCA9ICIxLjJlbSI7CiAgICAgICB0aGlzLnRvb2xiYXIuc3R5bGUudG9wID0gImF1dG8iOwogICAgICAgdGhpcy50b29sYmFyLnN0eWxlLmJvdHRvbSA9ICIwIjsKICAgICAgIHRoaXMudG9vbGJhci5zdHlsZS5sZWZ0ID0gIjAiOwogICAgICAgdGhpcy50b29sYmFyLnN0eWxlLnJpZ2h0ID0gIjAiOwogICAgICAgdGhpcy50b29sYmFyLnN0eWxlLnRleHRBbGlnbiA9ICJsZWZ0IjsKICAgICAgIHRoaXMudG9vbGJhci5zdHlsZS5mb250U2l6ZSA9ICI2MCUiOwogICAgICAgdGhpcy50b29sYmFyLnN0eWxlLmNvbG9yID0gInJlZCI7CiAgICAgICB0aGlzLnRvb2xiYXIuYm9yZGVyV2lkdGggPSAwOwogICAgICAgdGhpcy50b29sYmFyLmNsYXNzTmFtZSA9ICJ0b29sYmFyIjsKICAgICAgIHRoaXMudG9vbGJhci5zdHlsZS5iYWNrZ3JvdW5kID0gInJnYigyNDAsMjQwLDI0MCkiOwoKICAgICAgIC8vIHdvdWxkIGxpa2UgdG8gaGF2ZSBoZWxwIHRleHQgbGVmdCBhbGlnbmVkCiAgICAgICAvLyBhbmQgcGFnZSBjb3VudGVyIHJpZ2h0IGFsaWduZWQsIGZsb2F0aW5nCiAgICAgICAvLyBkaXYncyBkb24ndCB3b3JrLCBzbyBpbnN0ZWFkIHVzZSBuZXN0ZWQKICAgICAgIC8vIGFic29sdXRlbHkgcG9zaXRpb25lZCBkaXYncy4KCiAgICAgICB2YXIgc3AgPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJzcGFuIik7CiAgICAgICBzcC5pbm5lckhUTUwgPSAiJm5ic3A7Jm5ic3A7KiZuYnNwOyI7CiAgICAgICB0aGlzLnRvb2xiYXIuYXBwZW5kQ2hpbGQoc3ApOwogICAgICAgdGhpcy5lb3MgPSBzcDsgIC8vIGVuZCBvZiBzbGlkZSBpbmRpY2F0b3IKCiAgICAgICB2YXIgaGVscCA9IHRoaXMuY3JlYXRlX2VsZW1lbnQoImEiKTsKICAgICAgIGhlbHAuc2V0QXR0cmlidXRlKCJocmVmIiwgdGhpcy5oZWxwX3BhZ2UpOwogICAgICAgaGVscC5zZXRBdHRyaWJ1dGUoInRpdGxlIiwgdGhpcy5sb2NhbGl6ZSh0aGlzLmhlbHBfdGV4dCkpOwogICAgICAgaGVscC5pbm5lckhUTUwgPSB0aGlzLmxvY2FsaXplKCJoZWxwPyIpOwogICAgICAgdGhpcy50b29sYmFyLmFwcGVuZENoaWxkKGhlbHApOwogICAgICAgdGhpcy5oZWxwX2FuY2hvciA9IGhlbHA7ICAvLyBzYXZlIGZvciBmb2N1cyBoYWNrCgogICAgICAgdmFyIGdhcDEgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgiICIpOwogICAgICAgdGhpcy50b29sYmFyLmFwcGVuZENoaWxkKGdhcDEpOwoKICAgICAgIHZhciBjb250ZW50cyA9IHRoaXMuY3JlYXRlX2VsZW1lbnQoImEiKTsKICAgICAgIGNvbnRlbnRzLnNldEF0dHJpYnV0ZSgiaHJlZiIsICJqYXZhc2NyaXB0OnRvZ2dsZVRhYmxlT2ZDb250ZW50cygpIik7CiAgICAgICBjb250ZW50cy5zZXRBdHRyaWJ1dGUoInRpdGxlIiwgdGhpcy5sb2NhbGl6ZSgidGFibGUgb2YgY29udGVudHMiLmxvY2FsaXplKSk7CiAgICAgICBjb250ZW50cy5pbm5lckhUTUwgPSB0aGlzLmxvY2FsaXplKCJjb250ZW50cz8iKTsKICAgICAgIHRoaXMudG9vbGJhci5hcHBlbmRDaGlsZChjb250ZW50cyk7CgogICAgICAgdmFyIGdhcDIgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgiICIpOwogICAgICAgdGhpcy50b29sYmFyLmFwcGVuZENoaWxkKGdhcDIpOwoKICAgICAgIHZhciBjb3B5cmlnaHQgPSB0aGlzLmZpbmRfY29weXJpZ2h0KCk7CgogICAgICAgaWYgKGNvcHlyaWdodCkKICAgICAgIHsKICAgICAgICAgdmFyIHNwYW4gPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJzcGFuIik7CiAgICAgICAgIHNwYW4uaW5uZXJIVE1MID0gY29weXJpZ2h0OwogICAgICAgICBzcGFuLnN0eWxlLmNvbG9yID0gImJsYWNrIjsKICAgICAgICAgc3Bhbi5zdHlsZS5tYXJnaW5MZWZ0ID0gIjAuNWVtIjsKICAgICAgICAgdGhpcy50b29sYmFyLmFwcGVuZENoaWxkKHNwYW4pOwogICAgICAgfQoKICAgICAgIGNvdW50ZXIgPSB0aGlzLmNyZWF0ZV9lbGVtZW50KCJkaXYiKQogICAgICAgY291bnRlci5zdHlsZS5wb3NpdGlvbiA9ICJhYnNvbHV0ZSI7CiAgICAgICBjb3VudGVyLnN0eWxlLndpZHRoID0gImF1dG8iOyAvLyIyMCUiOwogICAgICAgY291bnRlci5zdHlsZS5oZWlnaHQgPSAiMS4yZW0iOwogICAgICAgY291bnRlci5zdHlsZS50b3AgPSAiYXV0byI7CiAgICAgICBjb3VudGVyLnN0eWxlLmJvdHRvbSA9IDA7CiAgICAgICBjb3VudGVyLnN0eWxlLnJpZ2h0ID0gIjAiOwogICAgICAgY291bnRlci5zdHlsZS50ZXh0QWxpZ24gPSAicmlnaHQiOwogICAgICAgY291bnRlci5zdHlsZS5jb2xvciA9ICJyZWQiOwogICAgICAgY291bnRlci5zdHlsZS5iYWNrZ3JvdW5kID0gInJnYigyNDAsMjQwLDI0MCkiOwoKICAgICAgIGNvdW50ZXIuaW5uZXJIVE1MID0gdGhpcy5sb2NhbGl6ZSgic2xpZGUiKSArICIgbi9tIjsKICAgICAgIHRoaXMudG9vbGJhci5hcHBlbmRDaGlsZChjb3VudGVyKTsKICAgICB9CgogICAgIC8vIGVuc3VyZSB0aGF0IGNsaWNrIGlzbid0IHBhc3NlZCB0aHJvdWdoIHRvIHRoZSBwYWdlCiAgICAgdGhpcy50b29sYmFyLm9uY2xpY2sgPQogICAgICAgICBmdW5jdGlvbiAoZSkgewogICAgICAgICAgIGlmICghZSkKICAgICAgICAgICAgIGUgPSB3aW5kb3cuZXZlbnQ7CgogICAgICAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldDsKCiAgICAgICAgICAgaWYgKCF0YXJnZXQgJiYgZS5zcmNFbGVtZW50KQogICAgICAgICAgICAgdGFyZ2V0ID0gZS5zcmNFbGVtZW50OwoKICAgICAgICAgICAvLyB3b3JrIGFyb3VuZCBTYWZhcmkgYnVnCiAgICAgICAgICAgaWYgKHRhcmdldCAmJiB0YXJnZXQubm9kZVR5cGUgPT0gMykKICAgICAgICAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlOwoKICAgICAgICAgICB3M2Nfc2xpZHkuc3RvcF9wcm9wYWdhdGlvbihlKTsKCiAgICAgICAgICAgaWYgKHRhcmdldCAmJiB0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPSAiYSIpCiAgICAgICAgICAgICB3M2Nfc2xpZHkubW91c2VfYnV0dG9uX2NsaWNrKGUpOwogICAgICAgICB9OwoKICAgICB0aGlzLnNsaWRlX251bWJlcl9lbGVtZW50ID0gY291bnRlcjsKICAgICB0aGlzLnNldF9lb3Nfc3RhdHVzKGZhbHNlKTsKICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMudG9vbGJhcik7CiAgfSwKCiAgLy8gd3lzaXd5ZyBlZGl0b3JzIG1ha2UgaXQgaGFyZCB0byB1c2UgZGl2IGVsZW1lbnRzCiAgLy8gZS5nLiBhbWF5YSBsb3NlcyB0aGUgZGl2IHdoZW4geW91IGNvcHkgYW5kIHBhc3RlCiAgLy8gdGhpcyBmdW5jdGlvbiB3cmFwcyBkaXYgZWxlbWVudHMgYXJvdW5kIGltcGxpY2l0CiAgLy8gc2xpZGVzIHdoaWNoIHN0YXJ0IHdpdGggYW4gaDEgZWxlbWVudCBhbmQgY29udGludWUKICAvLyB1cCB0byB0aGUgbmV4dCBoZWFkaW5nIG9yIGRpdiBlbGVtZW50CiAgd3JhcF9pbXBsaWNpdF9zbGlkZXM6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBpLCBoZWFkaW5nLCBub2RlLCBuZXh0LCBkaXY7CiAgICB2YXIgaGVhZGluZ3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgiaDEiKTsKCiAgICBpZiAoIWhlYWRpbmdzKQogICAgICByZXR1cm47CgogICAgZm9yIChpID0gMDsgaSA8IGhlYWRpbmdzLmxlbmd0aDsgKytpKQogICAgewogICAgICBoZWFkaW5nID0gaGVhZGluZ3NbaV07CgogICAgICBpZiAoaGVhZGluZy5wYXJlbnROb2RlICE9IGRvY3VtZW50LmJvZHkpCiAgICAgICAgY29udGludWU7CgogICAgICBub2RlID0gaGVhZGluZy5uZXh0U2libGluZzsKCiAgICAgIGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogICAgICB0aGlzLmFkZF9jbGFzcyhkaXYsICJzbGlkZSIpOwogICAgICBkb2N1bWVudC5ib2R5LnJlcGxhY2VDaGlsZChkaXYsIGhlYWRpbmcpOwogICAgICBkaXYuYXBwZW5kQ2hpbGQoaGVhZGluZyk7CgogICAgICB3aGlsZSAobm9kZSkKICAgICAgewogICAgICAgIGlmIChub2RlLm5vZGVUeXBlID09IDEpIC8vIGFuIGVsZW1lbnQKICAgICAgICB7CiAgICAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgPT0gIkgxIiB8fCBub2RlLm5vZGVOYW1lID09ICJoMSIpCiAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgPT0gIkRJViIgfHwgbm9kZS5ub2RlTmFtZSA9PSAiZGl2IikKICAgICAgICAgICB7CiAgICAgICAgICAgICBpZiAodGhpcy5oYXNfY2xhc3Mobm9kZSwgInNsaWRlIikpCiAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgIGlmICh0aGlzLmhhc19jbGFzcyhub2RlLCAiaGFuZG91dCIpKQogICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBuZXh0ID0gbm9kZS5uZXh0U2libGluZzsKICAgICAgICBub2RlID0gZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChub2RlKTsKICAgICAgICBkaXYuYXBwZW5kQ2hpbGQobm9kZSk7CiAgICAgICAgbm9kZSA9IG5leHQ7CiAgICAgIH0gCiAgICB9CiAgfSwKCiAgYXR0YWNoX3RvdWNoX2hhbmRlcnM6IGZ1bmN0aW9uKHNsaWRlcykKICB7CiAgICB2YXIgaSwgc2xpZGU7CgogICAgZm9yIChpID0gMDsgaSA8IHNsaWRlcy5sZW5ndGg7ICsraSkKICAgIHsKICAgICAgc2xpZGUgPSBzbGlkZXNbaV07CiAgICAgIHRoaXMuYWRkX2xpc3RlbmVyKHNsaWRlLCAidG91Y2hzdGFydCIsIHRoaXMudG91Y2hzdGFydCk7CiAgICAgIHRoaXMuYWRkX2xpc3RlbmVyKHNsaWRlLCAidG91Y2htb3ZlIiwgdGhpcy50b3VjaG1vdmUpOwogICAgICB0aGlzLmFkZF9saXN0ZW5lcihzbGlkZSwgInRvdWNoZW5kIiwgdGhpcy50b3VjaGVuZCk7CiAgICB9CiAgfSwKCi8vIHJldHVybiBuZXcgYXJyYXkgb2YgYWxsIHNsaWRlcwogIGNvbGxlY3Rfc2xpZGVzOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc2xpZGVzID0gbmV3IEFycmF5KCk7CiAgICB2YXIgZGl2cyA9IGRvY3VtZW50LmJvZHkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImRpdiIpOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGl2cy5sZW5ndGg7ICsraSkKICAgIHsKICAgICAgZGl2ID0gZGl2cy5pdGVtKGkpOwoKICAgICAgaWYgKHRoaXMuaGFzX2NsYXNzKGRpdiwgInNsaWRlIikpCiAgICAgIHsKICAgICAgICAvLyBhZGQgc2xpZGUgdG8gY29sbGVjdGlvbgogICAgICAgIHNsaWRlc1tzbGlkZXMubGVuZ3RoXSA9IGRpdjsKCiAgICAgICAgLy8gaGlkZSBlYWNoIHNsaWRlIGFzIGl0IGlzIGZvdW5kCiAgICAgICAgdGhpcy5hZGRfY2xhc3MoZGl2LCAiaGlkZGVuIik7CgogICAgICAgIC8vIGFkZCBkdW1teSA8YnIvPiBhdCBlbmQgZm9yIHNjcm9sbGluZyBoYWNrCiAgICAgICAgdmFyIG5vZGUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYnIiKTsKICAgICAgICBkaXYuYXBwZW5kQ2hpbGQobm9kZTEpOwogICAgICAgIHZhciBub2RlMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImJyIik7CiAgICAgICAgZGl2LmFwcGVuZENoaWxkKG5vZGUyKTsKICAgICAgfQogICAgICBlbHNlIGlmICh0aGlzLmhhc19jbGFzcyhkaXYsICJiYWNrZ3JvdW5kIikpCiAgICAgIHsgIC8vIHdvcmsgYXJvdW5kIGZvciBGaXJlZm94IFNWRyByZWxvYWQgYnVnCiAgICAgICAgLy8gd2hpY2ggb3RoZXJ3aXNlIHJlcGxhY2VzIDFzdCBTVkcgZ3JhcGhpYyB3aXRoIDJuZAogICAgICAgIGRpdi5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKICAgICAgfQogICAgfQoKICAgIHRoaXMuc2xpZGVzID0gc2xpZGVzOwogIH0sCgogIC8vIHJldHVybiBuZXcgYXJyYXkgb2YgYWxsIDxkaXYgY2xhc3M9ImhhbmRvdXQiPgogIGNvbGxlY3Rfbm90ZXM6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBub3RlcyA9IG5ldyBBcnJheSgpOwogICAgdmFyIGRpdnMgPSBkb2N1bWVudC5ib2R5LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJkaXYiKTsKCiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRpdnMubGVuZ3RoOyArK2kpCiAgICB7CiAgICAgIGRpdiA9IGRpdnMuaXRlbShpKTsKCiAgICAgIGlmICh0aGlzLmhhc19jbGFzcyhkaXYsICJoYW5kb3V0IikpCiAgICAgIHsKICAgICAgICAvLyBhZGQgbm90ZSB0byBjb2xsZWN0aW9uCiAgICAgICAgbm90ZXNbbm90ZXMubGVuZ3RoXSA9IGRpdjsKCiAgICAgICAgLy8gYW5kIGhpZGUgaXQKICAgICAgICB0aGlzLmFkZF9jbGFzcyhkaXYsICJoaWRkZW4iKTsKICAgICAgfQogICAgfQoKICAgIHRoaXMubm90ZXMgPSBub3RlczsKICB9LAoKICAvLyByZXR1cm4gbmV3IGFycmF5IG9mIGFsbCA8ZGl2IGNsYXNzPSJiYWNrZ3JvdW5kIj4KICAvLyBpbmNsdWRpbmcgbmFtZWQgYmFja2dyb3VuZHMgZS5nLiBjbGFzcz0iYmFja2dyb3VuZCB0aXRsZXBhZ2UiCiAgY29sbGVjdF9iYWNrZ3JvdW5kczogZnVuY3Rpb24gKCkgewogICAgdmFyIGJhY2tncm91bmRzID0gbmV3IEFycmF5KCk7CiAgICB2YXIgZGl2cyA9IGRvY3VtZW50LmJvZHkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImRpdiIpOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGl2cy5sZW5ndGg7ICsraSkKICAgIHsKICAgICAgZGl2ID0gZGl2cy5pdGVtKGkpOwoKICAgICAgaWYgKHRoaXMuaGFzX2NsYXNzKGRpdiwgImJhY2tncm91bmQiKSkKICAgICAgewogICAgICAgIC8vIGFkZCBiYWNrZ3JvdW5kIHRvIGNvbGxlY3Rpb24KICAgICAgICBiYWNrZ3JvdW5kc1tiYWNrZ3JvdW5kcy5sZW5ndGhdID0gZGl2OwoKICAgICAgICAvLyBhbmQgaGlkZSBpdAogICAgICAgIHRoaXMuYWRkX2NsYXNzKGRpdiwgImhpZGRlbiIpOwogICAgICB9CiAgICB9CgogICAgdGhpcy5iYWNrZ3JvdW5kcyA9IGJhY2tncm91bmRzOwogIH0sCgogIC8vIHNldCBjbGljayBoYW5kbGVycyBvbiBhbGwgYW5jaG9ycwogIHBhdGNoX2FuY2hvcnM6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBzZWxmID0gdzNjX3NsaWR5OwogICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgLy8gY29tcGFyZSB0aGlzLmhyZWYgd2l0aCBsb2NhdGlvbi5ocmVmCiAgICAgIC8vIGZvciBsaW5rIHRvIGFub3RoZXIgc2xpZGUgaW4gdGhpcyBkb2MKCiAgICAgIGlmIChzZWxmLnBhZ2VfYWRkcmVzcyh0aGlzLmhyZWYpID09IHNlbGYucGFnZV9hZGRyZXNzKGxvY2F0aW9uLmhyZWYpKQogICAgICB7CiAgICAgICAgLy8geWVzLCBzbyBmaW5kIG5ldyBzbGlkZSBudW1iZXIKICAgICAgICB2YXIgbmV3c2xpZGVudW0gPSBzZWxmLmZpbmRfc2xpZGVfbnVtYmVyKHRoaXMuaHJlZik7CgogICAgICAgIGlmIChuZXdzbGlkZW51bSAhPSBzZWxmLnNsaWRlX251bWJlcikKICAgICAgICB7CiAgICAgICAgICB2YXIgc2xpZGUgPSBzZWxmLnNsaWRlc1tzZWxmLnNsaWRlX251bWJlcl07CiAgICAgICAgICBzZWxmLmhpZGVfc2xpZGUoc2xpZGUpOwogICAgICAgICAgc2VsZi5zbGlkZV9udW1iZXIgPSBuZXdzbGlkZW51bTsKICAgICAgICAgIHNsaWRlID0gc2VsZi5zbGlkZXNbc2VsZi5zbGlkZV9udW1iZXJdOwogICAgICAgICAgc2VsZi5zaG93X3NsaWRlKHNsaWRlKTsKICAgICAgICAgIHNlbGYuc2V0X2xvY2F0aW9uKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGVsc2UKICAgICAgICB3M2Nfc2xpZHkuc3RvcF9wcm9wYWdhdGlvbihldmVudCk7CgovLyAgICAgIGVsc2UgaWYgKHRoaXMudGFyZ2V0ID09IG51bGwpCi8vICAgICAgICBsb2NhdGlvbi5ocmVmID0gdGhpcy5ocmVmOwoKICAgICAgdGhpcy5ibHVyKCk7CiAgICAgIHNlbGYuZGlzYWJsZV9zbGlkZV9jbGljayA9IHRydWU7CiAgICB9OwoKICAgIHZhciBhbmNob3JzID0gZG9jdW1lbnQuYm9keS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYSIpOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYW5jaG9ycy5sZW5ndGg7ICsraSkKICAgIHsKICAgICAgaWYgKHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKQogICAgICAgIGFuY2hvcnNbaV0uYWRkRXZlbnRMaXN0ZW5lcigiY2xpY2siLCBoYW5kbGVyLCBmYWxzZSk7CiAgICAgIGVsc2UKICAgICAgICBhbmNob3JzW2ldLmF0dGFjaEV2ZW50KCJvbmNsaWNrIiwgaGFuZGxlcik7CiAgICB9CiAgfSwKCiAgLy8gIyMjIENIRUNLIE1FICMjIyBzZWUgd2hpY2ggZnVuY3Rpb25zIGFyZSBpbnZva2VkIHZpYSBzZXRUaW1lb3V0CiAgLy8gZWl0aGVyIGRpcmVjdGx5IG9yIGluZGlyZWN0bHkgZm9yIHVzZSBvZiB3M2Nfc2xpZHkgdnMgdGhpcwogIHNob3dfc2xpZGVfbnVtYmVyOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgdGltZXIgPSB3M2Nfc2xpZHkuZ2V0X3RpbWVyKCk7CiAgICB3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyX2VsZW1lbnQuaW5uZXJIVE1MID0gdGltZXIgKyB3M2Nfc2xpZHkubG9jYWxpemUoInNsaWRlIikgKyAiICIgKwogICAgICAgICAgICh3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyICsgMSkgKyAiLyIgKyB3M2Nfc2xpZHkuc2xpZGVzLmxlbmd0aDsKICB9LAoKICAvLyBldmVyeSAyMDBtUyBjaGVjayBpZiB0aGUgbG9jYXRpb24gaGFzIGJlZW4gY2hhbmdlZCBhcyBhCiAgLy8gcmVzdWx0IG9mIHRoZSB1c2VyIGFjdGl2YXRpbmcgdGhlIEJhY2sgYnV0dG9uL21lbnUgaXRlbQogIC8vIGRvZXNuJ3Qgd29yayBmb3IgT3BlcmEgPCA5LjUKICBjaGVja19sb2NhdGlvbjogZnVuY3Rpb24gKCkgewogICAgdmFyIGhhc2ggPSBsb2NhdGlvbi5oYXNoOwoKICAgIGlmICh3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyID4gMCAmJiAoaGFzaCA9PSAiIiB8fCBoYXNoID09ICIjIikpCiAgICAgIHczY19zbGlkeS5nb3RvX3NsaWRlKDApOwogICAgZWxzZSBpZiAoaGFzaC5sZW5ndGggPiAyICYmIGhhc2ggIT0gIiMoIisodzNjX3NsaWR5LnNsaWRlX251bWJlcisxKSsiKSIpCiAgICB7CiAgICAgIHZhciBudW0gPSBwYXJzZUludChsb2NhdGlvbi5oYXNoLnN1YnN0cigyKSk7CgogICAgICBpZiAoIWlzTmFOKG51bSkpCiAgICAgICAgdzNjX3NsaWR5LmdvdG9fc2xpZGUobnVtLTEpOwogICAgfQoKICAgIGlmICh3M2Nfc2xpZHkudGltZV9sZWZ0ICYmIHczY19zbGlkeS5zbGlkZV9udW1iZXIgPiAwKQogICAgewogICAgICB3M2Nfc2xpZHkuc2hvd19zbGlkZV9udW1iZXIoKTsKCiAgICAgIGlmICh3M2Nfc2xpZHkudGltZV9sZWZ0ID4gMCkKICAgICAgICB3M2Nfc2xpZHkudGltZV9sZWZ0IC09IDIwMDsKICAgIH0gCiAgfSwKCiAgZ2V0X3RpbWVyOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgdGltZXIgPSAiIjsKICAgIGlmICh3M2Nfc2xpZHkudGltZV9sZWZ0KQogICAgewogICAgICB2YXIgbWlucywgc2VjczsKICAgICAgc2VjcyA9IE1hdGguZmxvb3IodzNjX3NsaWR5LnRpbWVfbGVmdC8xMDAwKTsKICAgICAgbWlucyA9IE1hdGguZmxvb3Ioc2VjcyAvIDYwKTsKICAgICAgc2VjcyA9IHNlY3MgJSA2MDsKICAgICAgdGltZXIgPSAobWlucyA/IG1pbnMrIm0iIDogIiIpICsgc2VjcyArICJzICI7CiAgICB9CgogICAgcmV0dXJuIHRpbWVyOwogIH0sCgogIC8vIHRoaXMgZG9lc24ndCBwdXNoIGxvY2F0aW9uIG9udG8gaGlzdG9yeSBzdGFjayBmb3IgSUUKICAvLyBmb3Igd2hpY2ggYSBoaWRkZW4gaWZyYW1lIGhhY2sgaXMgbmVlZGVkOiBsb2FkIHBhZ2UgaW50bwogIC8vIHRoZSBpZnJhbWUgd2l0aCBzY3JpcHQgdGhhdCBzZXQncyBwYXJlbnQncyBsb2NhdGlvbi5oYXNoCiAgLy8gYnV0IHRoYXQgd29uJ3Qgd29yayBmb3Igc3RhbmRhbG9uZSB1c2UgdW5sZXNzIHdlIGNhbgogIC8vIGNyZWF0ZSB0aGUgcGFnZSBkeW5hbWljYWxseSB2aWEgYSBqYXZhc2NyaXB0OiBVUkwKICAvLyAjIyMgdXNlIGhpc3RvcnkucHVzaFN0YXRlIGlmIGF2YWlsYWJsZQogIHNldF9sb2NhdGlvbjogZnVuY3Rpb24gKCkgewogICAgIHZhciB1cmkgPSB3M2Nfc2xpZHkucGFnZV9hZGRyZXNzKGxvY2F0aW9uLmhyZWYpOwogICAgIHZhciBoYXNoID0gIiMoIiArICh3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyKzEpICsgIikiOwoKICAgICBpZiAodzNjX3NsaWR5LnNsaWRlX251bWJlciA+PSAwKQogICAgICAgdXJpID0gdXJpICsgaGFzaDsKCiAgICAgaWYgKHR5cGVvZihoaXN0b3J5LnB1c2hTdGF0ZSkgIT0gInVuZGVmaW5lZCIgJiYgbG9jYXRpb24ucHJvdG9jb2wgIT09ICJmaWxlOiIpCiAgICAgewogICAgICAgZG9jdW1lbnQudGl0bGUgPSB3M2Nfc2xpZHkudGl0bGUgKyAiICgiICsgKHczY19zbGlkeS5zbGlkZV9udW1iZXIrMSkgKyAiKSI7CiAgICAgICBoaXN0b3J5LnB1c2hTdGF0ZSgwLCBkb2N1bWVudC50aXRsZSwgaGFzaCk7CiAgICAgICB3M2Nfc2xpZHkuc2hvd19zbGlkZV9udW1iZXIoKTsKICAgICAgIHczY19zbGlkeS5ub3RpZnlfb2JzZXJ2ZXJzKCk7CiAgICAgICByZXR1cm47CiAgICAgfQoKICAgICBpZiAodzNjX3NsaWR5LmllICYmICh3M2Nfc2xpZHkuaWU2IHx8IHczY19zbGlkeS5pZTcpKQogICAgICAgdzNjX3NsaWR5LnB1c2hfaGFzaChoYXNoKTsKCiAgICAgaWYgKHVyaSAhPSBsb2NhdGlvbi5ocmVmKSAvLyAmJiAha2h0bWwKICAgICAgICBsb2NhdGlvbi5ocmVmID0gdXJpOwoKICAgICBpZiAodGhpcy5raHRtbCkKICAgICAgICBoYXNoID0gIigiICsgKHczY19zbGlkeS5zbGlkZV9udW1iZXIrMSkgKyAiKSI7CgogICAgIGlmICghdGhpcy5pZSAmJiBsb2NhdGlvbi5oYXNoICE9IGhhc2ggJiYgbG9jYXRpb24uaGFzaCAhPSAiIikKICAgICAgIGxvY2F0aW9uLmhhc2ggPSBoYXNoOwoKICAgICBkb2N1bWVudC50aXRsZSA9IHczY19zbGlkeS50aXRsZSArICIgKCIgKyAodzNjX3NsaWR5LnNsaWRlX251bWJlcisxKSArICIpIjsKICAgICB3M2Nfc2xpZHkuc2hvd19zbGlkZV9udW1iZXIoKTsKICAgICB3M2Nfc2xpZHkubm90aWZ5X29ic2VydmVycygpOwogIH0sCgogIG5vdGlmeV9vYnNlcnZlcnM6IGZ1bmN0aW9uICgpCiAgewogICAgdmFyIHNsaWRlID0gdGhpcy5zbGlkZXNbdGhpcy5zbGlkZV9udW1iZXJdOwoKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5vYnNlcnZlcnMubGVuZ3RoOyArK2kpCiAgICAgIHRoaXMub2JzZXJ2ZXJzW2ldKHRoaXMuc2xpZGVfbnVtYmVyKzEsIHRoaXMuZmluZF9oZWFkaW5nKHNsaWRlKS5pbm5lclRleHQsIGxvY2F0aW9uLmhyZWYpOwogIH0sCgogIGFkZF9vYnNlcnZlcjogZnVuY3Rpb24gKG9ic2VydmVyKQogIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5vYnNlcnZlcnMubGVuZ3RoOyArK2kpCiAgICB7CiAgICAgIGlmIChvYnNlcnZlciA9PSB0aGlzLm9ic2VydmVyc1tpXSkKICAgICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5vYnNlcnZlcnMucHVzaChvYnNlcnZlcik7CiAgfSwKCiAgcmVtb3ZlX29ic2VydmVyOiBmdW5jdGlvbiAobykKICB7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMub2JzZXJ2ZXJzLmxlbmd0aDsgKytpKQogICAgewogICAgICBpZiAob2JzZXJ2ZXIgPT0gdGhpcy5vYnNlcnZlcnNbaV0pCiAgICAgIHsKICAgICAgICB0aGlzLm9ic2VydmVycy5zcGxpY2UoaSwxKTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQogIH0sCgogIHBhZ2VfYWRkcmVzczogZnVuY3Rpb24gKHVyaSkgewogICAgdmFyIGkgPSB1cmkuaW5kZXhPZigiIyIpOwoKICAgIGlmIChpIDwgMCkKICAgICAgaSA9IHVyaS5pbmRleE9mKCIlMjMiKTsKCiAgICAvLyBjaGVjayBpZiBhbmNob3IgaXMgZW50aXJlIHBhZ2UKCiAgICBpZiAoaSA8IDApCiAgICAgIHJldHVybiB1cmk7ICAvLyB5ZXMKCiAgICByZXR1cm4gdXJpLnN1YnN0cigwLCBpKTsKICB9LAoKICAvLyBvbmx5IHVzZWQgZm9yIElFNiBhbmQgSUU3CiAgb25fZnJhbWVfbG9hZGVkOiBmdW5jdGlvbiAoaGFzaCkgewogICAgbG9jYXRpb24uaGFzaCA9IGhhc2g7CiAgICB2YXIgdXJpID0gdzNjX3NsaWR5LnBhZ2VfYWRkcmVzcyhsb2NhdGlvbi5ocmVmKTsKICAgIGxvY2F0aW9uLmhyZWYgPSB1cmkgKyBoYXNoOwogIH0sCgogIC8vIGhpc3RvcnkgaGFjayB3aXRoIHRoYW5rcyB0byBCZXJ0cmFuZCBMZSBSb3kKICBwdXNoX2hhc2g6IGZ1bmN0aW9uIChoYXNoKSB7CiAgICBpZiAoaGFzaCA9PSAiIikgaGFzaCA9ICIjKDEpIjsKICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSBoYXNoOwoKICAgIHZhciBkb2MgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaGlzdG9yeUZyYW1lIikuY29udGVudFdpbmRvdy5kb2N1bWVudDsKICAgIGRvYy5vcGVuKCJqYXZhc2NyaXB0Oic8aHRtbD48L2h0bWw+JyIpOwogICAgZG9jLndyaXRlKCI8aHRtbD48aGVhZD48c2NyaXB0IHR5cGU9XCJ0ZXh0L2phdmFzY3JpcHRcIj53aW5kb3cucGFyZW50LnczY19zbGlkeS5vbl9mcmFtZV9sb2FkZWQoJyIrCiAgICAgIChoYXNoKSArICInKTs8L3NjcmlwdD48L2hlYWQ+PGJvZHk+aGVsbG8gbXVtPC9ib2R5PjwvaHRtbD4iKTsKICAgICAgZG9jLmNsb3NlKCk7CiAgfSwKCiAgLy8gZmluZCBjdXJyZW50IHNsaWRlIGJhc2VkIHVwb24gbG9jYXRpb24KICAvLyBmaXJzdCBmaW5kIHRhcmdldCBhbmNob3IgYW5kIHRoZW4gbG9vawogIC8vIGZvciBhc3NvY2lhdGVkIGRpdiBlbGVtZW50IGVuY2xvc2luZyBpdAogIC8vIGZpbmFsbHkgbWFwIHRoYXQgdG8gc2xpZGUgbnVtYmVyCiAgZmluZF9zbGlkZV9udW1iZXI6IGZ1bmN0aW9uICh1cmkpIHsKICAgIC8vIGZpcnN0IGdldCBhbmNob3IgZnJvbSBwYWdlIGxvY2F0aW9uCgogICAgdmFyIGkgPSB1cmkuaW5kZXhPZigiIyIpOwoKICAgIC8vIGNoZWNrIGlmIGFuY2hvciBpcyBlbnRpcmUgcGFnZQogICAgaWYgKGkgPCAwKQogICAgICByZXR1cm4gMDsgIC8vIHllcwoKICAgIHZhciBhbmNob3IgPSB1bmVzY2FwZSh1cmkuc3Vic3RyKGkrMSkpOwoKICAgIC8vIG5vdyB1c2UgYW5jaG9yIGFzIFhNTCBJRCB0byBmaW5kIHRhcmdldAogICAgdmFyIHRhcmdldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGFuY2hvcik7CgogICAgaWYgKCF0YXJnZXQpCiAgICB7CiAgICAgIC8vIGRvZXMgYW5jaG9yIGxvb2sgbGlrZSAiKDIpIiBmb3Igc2xpZGUgMiA/PwogICAgICAvLyB3aGVyZSBmaXJzdCBzbGlkZSBpcyAoMSkKICAgICAgdmFyIHJlID0gL1woKFxkKStcKS87CgogICAgICBpZiAoYW5jaG9yLm1hdGNoKHJlKSkKICAgICAgewogICAgICAgIHZhciBudW0gPSBwYXJzZUludChhbmNob3Iuc3Vic3RyaW5nKDEsIGFuY2hvci5sZW5ndGgtMSkpOwoKICAgICAgICBpZiAobnVtID4gdGhpcy5zbGlkZXMubGVuZ3RoKQogICAgICAgICAgbnVtID0gMTsKCiAgICAgICAgaWYgKC0tbnVtIDwgMCkKICAgICAgICAgIG51bSA9IDA7CgogICAgICAgIHJldHVybiBudW07CiAgICAgIH0KCiAgICAgIC8vIGFjY2VwdCBbMl0gZm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5CiAgICAgIHJlID0gL1xbKFxkKStcXS87CgogICAgICBpZiAoYW5jaG9yLm1hdGNoKHJlKSkKICAgICAgewogICAgICAgICB2YXIgbnVtID0gcGFyc2VJbnQoYW5jaG9yLnN1YnN0cmluZygxLCBhbmNob3IubGVuZ3RoLTEpKTsKCiAgICAgICAgIGlmIChudW0gPiB0aGlzLnNsaWRlcy5sZW5ndGgpCiAgICAgICAgICAgIG51bSA9IDE7CgogICAgICAgICBpZiAoLS1udW0gPCAwKQogICAgICAgICAgICBudW0gPSAwOwoKICAgICAgICAgcmV0dXJuIG51bTsKICAgICAgfQoKICAgICAgLy8gb2ggZGVhciB1bmtub3duIGFuY2hvcgogICAgICByZXR1cm4gMDsKICAgIH0KCiAgICAvLyBzZWFyY2ggZm9yIGVuY2xvc2luZyBzbGlkZQoKICAgIHdoaWxlICh0cnVlKQogICAgewogICAgICAvLyBicm93c2VyIGNvZXJjZXMgaHRtbCBlbGVtZW50cyB0byB1cHBlcmNhc2UhCiAgICAgIGlmICh0YXJnZXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PSAiZGl2IiAmJgogICAgICAgICAgICB0aGlzLmhhc19jbGFzcyh0YXJnZXQsICJzbGlkZSIpKQogICAgICB7CiAgICAgICAgLy8gZm91bmQgdGhlIHNsaWRlIGVsZW1lbnQKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgLy8gb3RoZXJ3aXNlIHRyeSBwYXJlbnQgZWxlbWVudCBpZiBhbnkKCiAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlOwoKICAgICAgaWYgKCF0YXJnZXQpCiAgICAgIHsKICAgICAgICByZXR1cm4gMDsgICAvLyBubyBsdWNrIQogICAgICB9CiAgICB9OwoKICAgIGZvciAoaSA9IDA7IGkgPCBzbGlkZXMubGVuZ3RoOyArK2kpCiAgICB7CiAgICAgIGlmIChzbGlkZXNbaV0gPT0gdGFyZ2V0KQogICAgICAgIHJldHVybiBpOyAgLy8gc3VjY2VzcwogICAgfQoKICAgIC8vIG9oIGRlYXIgc3RpbGwgbm8gbHVjawogICAgcmV0dXJuIDA7CiAgfSwKCiAgcHJldmlvdXNfc2xpZGU6IGZ1bmN0aW9uIChpbmNyZW1lbnRhbCkgewogICAgaWYgKCF3M2Nfc2xpZHkudmlld19hbGwpCiAgICB7CiAgICAgIHZhciBzbGlkZTsKCiAgICAgIGlmICgoaW5jcmVtZW50YWwgfHwgdzNjX3NsaWR5LnNsaWRlX251bWJlciA9PSAwKSAmJiB3M2Nfc2xpZHkubGFzdF9zaG93biAhPSBudWxsKQogICAgICB7CiAgICAgICAgdzNjX3NsaWR5Lmxhc3Rfc2hvd24gPSB3M2Nfc2xpZHkuaGlkZV9wcmV2aW91c19pdGVtKHczY19zbGlkeS5sYXN0X3Nob3duKTsKICAgICAgICB3M2Nfc2xpZHkuc2V0X2Vvc19zdGF0dXMoZmFsc2UpOwogICAgICB9CiAgICAgIGVsc2UgaWYgKHczY19zbGlkeS5zbGlkZV9udW1iZXIgPiAwKQogICAgICB7CiAgICAgICAgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwogICAgICAgIHczY19zbGlkeS5oaWRlX3NsaWRlKHNsaWRlKTsKCiAgICAgICAgdzNjX3NsaWR5LnNsaWRlX251bWJlciA9IHczY19zbGlkeS5zbGlkZV9udW1iZXIgLSAxOwogICAgICAgIHNsaWRlID0gdzNjX3NsaWR5LnNsaWRlc1t3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyXTsKICAgICAgICB3M2Nfc2xpZHkuc2V0X3Zpc2liaWxpdHlfYWxsX2luY3JlbWVudGFsKCJ2aXNpYmxlIik7CiAgICAgICAgdzNjX3NsaWR5Lmxhc3Rfc2hvd24gPSB3M2Nfc2xpZHkucHJldmlvdXNfaW5jcmVtZW50YWxfaXRlbShudWxsKTsKICAgICAgICB3M2Nfc2xpZHkuc2V0X2Vvc19zdGF0dXModHJ1ZSk7CiAgICAgICAgdzNjX3NsaWR5LnNob3dfc2xpZGUoc2xpZGUpOwogICAgICB9CgogICAgICB3M2Nfc2xpZHkuc2V0X2xvY2F0aW9uKCk7CgogICAgICBpZiAoIXczY19zbGlkeS5uc19wb3MpCiAgICAgICAgdzNjX3NsaWR5LnJlZnJlc2hfdG9vbGJhcigyMDApOwogICAgfQogIH0sCgogIG5leHRfc2xpZGU6IGZ1bmN0aW9uIChpbmNyZW1lbnRhbCkgewogICAgaWYgKCF3M2Nfc2xpZHkudmlld19hbGwpCiAgICB7CiAgICAgIHZhciBzbGlkZSwgbGFzdCA9IHczY19zbGlkeS5sYXN0X3Nob3duOwoKICAgICAgaWYgKGluY3JlbWVudGFsIHx8IHczY19zbGlkeS5zbGlkZV9udW1iZXIgPT0gdzNjX3NsaWR5LnNsaWRlcy5sZW5ndGggLSAxKQogICAgICAgICB3M2Nfc2xpZHkubGFzdF9zaG93biA9IHczY19zbGlkeS5yZXZlYWxfbmV4dF9pdGVtKHczY19zbGlkeS5sYXN0X3Nob3duKTsKCiAgICAgIGlmICgoIWluY3JlbWVudGFsIHx8IHczY19zbGlkeS5sYXN0X3Nob3duID09IG51bGwpICYmCiAgICAgICAgICAgICB3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyIDwgdzNjX3NsaWR5LnNsaWRlcy5sZW5ndGggLSAxKQogICAgICB7CiAgICAgICAgIHNsaWRlID0gdzNjX3NsaWR5LnNsaWRlc1t3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyXTsKICAgICAgICAgdzNjX3NsaWR5LmhpZGVfc2xpZGUoc2xpZGUpOwoKICAgICAgICAgdzNjX3NsaWR5LnNsaWRlX251bWJlciA9IHczY19zbGlkeS5zbGlkZV9udW1iZXIgKyAxOwogICAgICAgICBzbGlkZSA9IHczY19zbGlkeS5zbGlkZXNbdzNjX3NsaWR5LnNsaWRlX251bWJlcl07CiAgICAgICAgIHczY19zbGlkeS5sYXN0X3Nob3duID0gbnVsbDsKICAgICAgICAgdzNjX3NsaWR5LnNldF92aXNpYmlsaXR5X2FsbF9pbmNyZW1lbnRhbCgiaGlkZGVuIik7CiAgICAgICAgIHczY19zbGlkeS5zaG93X3NsaWRlKHNsaWRlKTsKICAgICAgfQogICAgICBlbHNlIGlmICghdzNjX3NsaWR5Lmxhc3Rfc2hvd24pCiAgICAgIHsKICAgICAgICAgaWYgKGxhc3QgJiYgaW5jcmVtZW50YWwpCiAgICAgICAgICAgdzNjX3NsaWR5Lmxhc3Rfc2hvd24gPSBsYXN0OwogICAgICB9CgogICAgICB3M2Nfc2xpZHkuc2V0X2xvY2F0aW9uKCk7CgogICAgICB3M2Nfc2xpZHkuc2V0X2Vvc19zdGF0dXMoIXczY19zbGlkeS5uZXh0X2luY3JlbWVudGFsX2l0ZW0odzNjX3NsaWR5Lmxhc3Rfc2hvd24pKTsKCiAgICAgIGlmICghdzNjX3NsaWR5Lm5zX3BvcykKICAgICAgICAgdzNjX3NsaWR5LnJlZnJlc2hfdG9vbGJhcigyMDApOwogICAgIH0KICB9LAoKICAvLyB0byBmaXJzdCBzbGlkZSB3aXRoIG5vdGhpbmcgcmV2ZWFsZWQKICAvLyBpLmUuIHN0YXRlIGF0IHN0YXJ0IG9mIHByZXNlbnRhdGlvbgogIGZpcnN0X3NsaWRlOiBmdW5jdGlvbiAoKSB7CiAgICAgaWYgKCF3M2Nfc2xpZHkudmlld19hbGwpCiAgICAgewogICAgICAgdmFyIHNsaWRlOwoKICAgICAgIGlmICh3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyICE9IDApCiAgICAgICB7CiAgICAgICAgIHNsaWRlID0gdzNjX3NsaWR5LnNsaWRlc1t3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyXTsKICAgICAgICAgdzNjX3NsaWR5LmhpZGVfc2xpZGUoc2xpZGUpOwoKICAgICAgICAgdzNjX3NsaWR5LnNsaWRlX251bWJlciA9IDA7CiAgICAgICAgIHNsaWRlID0gdzNjX3NsaWR5LnNsaWRlc1t3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyXTsKICAgICAgICAgdzNjX3NsaWR5Lmxhc3Rfc2hvd24gPSBudWxsOwogICAgICAgICB3M2Nfc2xpZHkuc2V0X3Zpc2liaWxpdHlfYWxsX2luY3JlbWVudGFsKCJoaWRkZW4iKTsKICAgICAgICAgdzNjX3NsaWR5LnNob3dfc2xpZGUoc2xpZGUpOwogICAgICAgfQoKICAgICAgIHczY19zbGlkeS5zZXRfZW9zX3N0YXR1cygKICAgICAgICAgIXczY19zbGlkeS5uZXh0X2luY3JlbWVudGFsX2l0ZW0odzNjX3NsaWR5Lmxhc3Rfc2hvd24pKTsKICAgICAgIHczY19zbGlkeS5zZXRfbG9jYXRpb24oKTsKICAgICB9CiAgfSwKCiAgLy8gZ290byBsYXN0IHNsaWRlIHdpdGggZXZlcnl0aGluZyByZXZlYWxlZAogIC8vIGkuZS4gc3RhdGUgYXQgZW5kIG9mIHByZXNlbnRhdGlvbgogIGxhc3Rfc2xpZGU6IGZ1bmN0aW9uICgpIHsKICAgIGlmICghdzNjX3NsaWR5LnZpZXdfYWxsKQogICAgewogICAgICB2YXIgc2xpZGU7CgogICAgICB3M2Nfc2xpZHkubGFzdF9zaG93biA9IG51bGw7IC8vcmV2ZWFsTmV4dEl0ZW0obGFzdFNob3duKTsKCiAgICAgIGlmICh3M2Nfc2xpZHkubGFzdF9zaG93biA9PSBudWxsICYmCiAgICAgICAgICB3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyIDwgdzNjX3NsaWR5LnNsaWRlcy5sZW5ndGggLSAxKQogICAgICB7CiAgICAgICAgIHNsaWRlID0gdzNjX3NsaWR5LnNsaWRlc1t3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyXTsKICAgICAgICAgdzNjX3NsaWR5LmhpZGVfc2xpZGUoc2xpZGUpOwogICAgICAgICB3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyID0gdzNjX3NsaWR5LnNsaWRlcy5sZW5ndGggLSAxOwogICAgICAgICBzbGlkZSA9IHczY19zbGlkeS5zbGlkZXNbdzNjX3NsaWR5LnNsaWRlX251bWJlcl07CiAgICAgICAgIHczY19zbGlkeS5zZXRfdmlzaWJpbGl0eV9hbGxfaW5jcmVtZW50YWwoInZpc2libGUiKTsKICAgICAgICAgdzNjX3NsaWR5Lmxhc3Rfc2hvd24gPSB3M2Nfc2xpZHkucHJldmlvdXNfaW5jcmVtZW50YWxfaXRlbShudWxsKTsKCiAgICAgICAgIHczY19zbGlkeS5zaG93X3NsaWRlKHNsaWRlKTsKICAgICAgfQogICAgICBlbHNlCiAgICAgIHsKICAgICAgICAgdzNjX3NsaWR5LnNldF92aXNpYmlsaXR5X2FsbF9pbmNyZW1lbnRhbCgidmlzaWJsZSIpOwogICAgICAgICB3M2Nfc2xpZHkubGFzdF9zaG93biA9IHczY19zbGlkeS5wcmV2aW91c19pbmNyZW1lbnRhbF9pdGVtKG51bGwpOwogICAgICB9CgogICAgICB3M2Nfc2xpZHkuc2V0X2Vvc19zdGF0dXModHJ1ZSk7CiAgICAgIHczY19zbGlkeS5zZXRfbG9jYXRpb24oKTsKICAgIH0KICB9LAoKCiAgLy8gIyMjIGNoZWNrIHRoaXMgYW5kIGNvbnNpZGVyIGFkZC9yZW1vdmUgY2xhc3MKICBzZXRfZW9zX3N0YXR1czogZnVuY3Rpb24gKHN0YXRlKSB7CiAgICBpZiAodGhpcy5lb3MpCiAgICAgIHRoaXMuZW9zLnN0eWxlLmNvbG9yID0gKHN0YXRlID8gInJnYigyNDAsMjQwLDI0MCkiIDogInJlZCIpOwogIH0sCgogIC8vIGZpcnN0IHNsaWRlIGlzIDAKICBnb3RvX3NsaWRlOiBmdW5jdGlvbiAobnVtKSB7CiAgICAvL2FsZXJ0KCJnb2luZyB0byBzbGlkZSAiICsgKG51bSsxKSk7CiAgICB2YXIgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwogICAgdzNjX3NsaWR5LmhpZGVfc2xpZGUoc2xpZGUpOwogICAgdzNjX3NsaWR5LnNsaWRlX251bWJlciA9IG51bTsKICAgIHNsaWRlID0gdzNjX3NsaWR5LnNsaWRlc1t3M2Nfc2xpZHkuc2xpZGVfbnVtYmVyXTsKICAgIHczY19zbGlkeS5sYXN0X3Nob3duID0gbnVsbDsKICAgIHczY19zbGlkeS5zZXRfdmlzaWJpbGl0eV9hbGxfaW5jcmVtZW50YWwoImhpZGRlbiIpOwogICAgdzNjX3NsaWR5LnNldF9lb3Nfc3RhdHVzKCF3M2Nfc2xpZHkubmV4dF9pbmNyZW1lbnRhbF9pdGVtKHczY19zbGlkeS5sYXN0X3Nob3duKSk7CiAgICBkb2N1bWVudC50aXRsZSA9IHczY19zbGlkeS50aXRsZSArICIgKCIgKyAodzNjX3NsaWR5LnNsaWRlX251bWJlcisxKSArICIpIjsKICAgIHczY19zbGlkeS5zaG93X3NsaWRlKHNsaWRlKTsKICAgIHczY19zbGlkeS5zaG93X3NsaWRlX251bWJlcigpOwogIH0sCgoKICBzaG93X3NsaWRlOiBmdW5jdGlvbiAoc2xpZGUpIHsKICAgIHRoaXMuc3luY19iYWNrZ3JvdW5kKHNsaWRlKTsKICAgIHRoaXMucmVtb3ZlX2NsYXNzKHNsaWRlLCAiaGlkZGVuIik7CgogICAgLy8gd29yayBhcm91bmQgSUU5IG9iamVjdCByZW5kZXJpbmcgYnVnCiAgICBzZXRUaW1lb3V0KCJ3aW5kb3cuc2Nyb2xsVG8oMCwwKTsiLCAxKTsKICB9LAoKICBoaWRlX3NsaWRlOiBmdW5jdGlvbiAoc2xpZGUpIHsKICAgIHRoaXMuYWRkX2NsYXNzKHNsaWRlLCAiaGlkZGVuIik7CiAgfSwKCiAgc2V0X2ZvY3VzOiBmdW5jdGlvbiAoZWxlbWVudCkKICB7CiAgICBpZiAoZWxlbWVudCkKICAgICAgZWxlbWVudC5mb2N1cygpOwogICAgZWxzZQogICAgewogICAgICB3M2Nfc2xpZHkuaGVscF9hbmNob3IuZm9jdXMoKTsKCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7CiAgICAgICAgdzNjX3NsaWR5LmhlbHBfYW5jaG9yLmJsdXIoKTsKICAgICAgfSwgMSk7CiAgICB9CiAgfSwKCiAgLy8gc2hvdyBqdXN0IHRoZSBiYWNrZ3JvdW5kcyBwZXJ0aW5lbnQgdG8gdGhpcyBzbGlkZQogIC8vIHdoZW4gc2xpZGUgYmFja2dyb3VuZC1jb2xvciBpcyB0cmFuc3BhcmVudAogIC8vIHRoaXMgc2hvdWxkIG5vdyB3b3JrIHdpdGggcmdiYSBjb2xvciB2YWx1ZXMKICBzeW5jX2JhY2tncm91bmQ6IGZ1bmN0aW9uIChzbGlkZSkgewogICAgdmFyIGJhY2tncm91bmQ7CiAgICB2YXIgYmdDb2xvcjsKCiAgICBpZiAoc2xpZGUuY3VycmVudFN0eWxlKQogICAgICBiZ0NvbG9yID0gc2xpZGUuY3VycmVudFN0eWxlWyJiYWNrZ3JvdW5kQ29sb3IiXTsKICAgIGVsc2UgaWYgKGRvY3VtZW50LmRlZmF1bHRWaWV3KQogICAgewogICAgICB2YXIgc3R5bGVzID0gZG9jdW1lbnQuZGVmYXVsdFZpZXcuZ2V0Q29tcHV0ZWRTdHlsZShzbGlkZSxudWxsKTsKCiAgICAgIGlmIChzdHlsZXMpCiAgICAgICAgYmdDb2xvciA9IHN0eWxlcy5nZXRQcm9wZXJ0eVZhbHVlKCJiYWNrZ3JvdW5kLWNvbG9yIik7CiAgICAgIGVsc2UgLy8gYnJva2VuIGltcGxlbWVudGF0aW9uIHByb2JhYmx5IGR1ZSBTYWZhcmkgb3IgS29ucXVlcm9yCiAgICAgIHsKICAgICAgICAvL2FsZXJ0KCJkZWZlY3RpdmUgaW1wbGVtZW50YXRpb24gb2YgZ2V0Q29tcHV0ZWRTdHlsZSgpIik7CiAgICAgICAgYmdDb2xvciA9ICJ0cmFuc3BhcmVudCI7CiAgICAgIH0KICAgIH0KICAgIGVsc2UKICAgICAgYmdDb2xvciA9PSAidHJhbnNwYXJlbnQiOwoKICAgIGlmIChiZ0NvbG9yID09ICJ0cmFuc3BhcmVudCIgfHwKICAgICAgICBiZ0NvbG9yLmluZGV4T2YoInJnYmEiKSA+PSAwIHx8CiAgICAgICAgYmdDb2xvci5pbmRleE9mKCJvcGFjaXR5IikgPj0gMCkKICAgIHsKICAgICAgdmFyIHNsaWRlQ2xhc3MgPSB0aGlzLmdldF9jbGFzc19saXN0KHNsaWRlKTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5iYWNrZ3JvdW5kcy5sZW5ndGg7IGkrKykKICAgICAgewogICAgICAgIGJhY2tncm91bmQgPSB0aGlzLmJhY2tncm91bmRzW2ldOwoKICAgICAgICB2YXIgYmdDbGFzcyA9IHRoaXMuZ2V0X2NsYXNzX2xpc3QoYmFja2dyb3VuZCk7CgogICAgICAgIGlmICh0aGlzLm1hdGNoaW5nX2JhY2tncm91bmQoc2xpZGVDbGFzcywgYmdDbGFzcykpCiAgICAgICAgICB0aGlzLnJlbW92ZV9jbGFzcyhiYWNrZ3JvdW5kLCAiaGlkZGVuIik7CiAgICAgICAgZWxzZQogICAgICAgICAgdGhpcy5hZGRfY2xhc3MoYmFja2dyb3VuZCwgImhpZGRlbiIpOwogICAgICB9CiAgICB9CiAgICBlbHNlIC8vIGZvcmNpYmx5IGhpZGUgYWxsIGJhY2tncm91bmRzCiAgICAgIHRoaXMuaGlkZV9iYWNrZ3JvdW5kcygpOwogIH0sCgogIGhpZGVfYmFja2dyb3VuZHM6IGZ1bmN0aW9uICgpIHsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5iYWNrZ3JvdW5kcy5sZW5ndGg7IGkrKykKICAgIHsKICAgICAgYmFja2dyb3VuZCA9IHRoaXMuYmFja2dyb3VuZHNbaV07CiAgICAgIHRoaXMuYWRkX2NsYXNzKGJhY2tncm91bmQsICJoaWRkZW4iKTsKICAgIH0KICB9LAoKICAvLyBjb21wYXJlIGNsYXNzZXMgZm9yIHNsaWRlIGFuZCBiYWNrZ3JvdW5kCiAgbWF0Y2hpbmdfYmFja2dyb3VuZDogZnVuY3Rpb24gKHNsaWRlQ2xhc3MsIGJnQ2xhc3MpIHsKICAgIHZhciBpLCBjb3VudCwgcGF0dGVybiwgcmVzdWx0OwoKICAgIC8vIGRlZmluZSBwYXR0ZXJuIGFzIHJlZ3VsYXIgZXhwcmVzc2lvbgogICAgcGF0dGVybiA9IC9cdysvZzsKCiAgICAvLyBjaGVjayBiYWNrZ3JvdW5kIGNsYXNzIG5hbWVzCiAgICByZXN1bHQgPSBiZ0NsYXNzLm1hdGNoKHBhdHRlcm4pOwoKICAgIGZvciAoaSA9IGNvdW50ID0gMDsgaSA8IHJlc3VsdC5sZW5ndGg7IGkrKykKICAgIHsKICAgICAgaWYgKHJlc3VsdFtpXSA9PSAiaGlkZGVuIikKICAgICAgICBjb250aW51ZTsKCiAgICAgIGlmIChyZXN1bHRbaV0gPT0gImJhY2tncm91bmQiKQoJY29udGludWU7CgogICAgICArK2NvdW50OwogICAgfQoKICAgIGlmIChjb3VudCA9PSAwKSAgLy8gZGVmYXVsdCBtYXRjaAogICAgICByZXR1cm4gdHJ1ZTsKCiAgICAvLyBjaGVjayBmb3IgbWF0Y2hlcyBhbmQgcGxhY2UgcmVzdWx0IGluIGFycmF5CiAgICByZXN1bHQgPSBzbGlkZUNsYXNzLm1hdGNoKHBhdHRlcm4pOwoKICAgIC8vIG5vdyBjaGVjayBpZiBkZXNpcmVkIG5hbWUgaXMgcHJlc2VudCBmb3IgYmFja2dyb3VuZAogICAgZm9yIChpID0gY291bnQgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKQogICAgewogICAgICBpZiAocmVzdWx0W2ldID09ICJoaWRkZW4iKQogICAgICAgIGNvbnRpbnVlOwoKICAgICAgaWYgKHRoaXMuaGFzX3Rva2VuKGJnQ2xhc3MsIHJlc3VsdFtpXSkpCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0sCgogIHJlc2l6ZWQ6IGZ1bmN0aW9uICgpIHsKICAgICB2YXIgd2lkdGggPSAwOwoKICAgICBpZiAoIHR5cGVvZiggd2luZG93LmlubmVyV2lkdGggKSA9PSAnbnVtYmVyJyApCiAgICAgICB3aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoOyAgLy8gTm9uIElFIGJyb3dzZXIKICAgICBlbHNlIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoKQogICAgICAgd2lkdGggPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGg7ICAvLyBJRTYKICAgICBlbHNlIGlmIChkb2N1bWVudC5ib2R5ICYmIGRvY3VtZW50LmJvZHkuY2xpZW50V2lkdGgpCiAgICAgICB3aWR0aCA9IGRvY3VtZW50LmJvZHkuY2xpZW50V2lkdGg7IC8vIElFNAoKICAgICB2YXIgaGVpZ2h0ID0gMDsKCiAgICAgaWYgKCB0eXBlb2YoIHdpbmRvdy5pbm5lckhlaWdodCApID09ICdudW1iZXInICkKICAgICAgIGhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDsgIC8vIE5vbiBJRSBicm93c2VyCiAgICAgZWxzZSBpZiAoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50ICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQpCiAgICAgICBoZWlnaHQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0OyAgLy8gSUU2CiAgICAgZWxzZSBpZiAoZG9jdW1lbnQuYm9keSAmJiBkb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodCkKICAgICAgIGhlaWdodCA9IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0OyAvLyBJRTQKCiAgICAgaWYgKGhlaWdodCAmJiAod2lkdGgvaGVpZ2h0ID4gMS4wNSoxMDI0Lzc2OCkpCiAgICAgewogICAgICAgd2lkdGggPSBoZWlnaHQgKiAxMDI0LjAvNzY4OwogICAgIH0KCiAgICAgLy8gSUUgZmlyZXMgb25yZXNpemUgZXZlbiB3aGVuIG9ubHkgZm9udCBzaXplIGlzIGNoYW5nZWQhCiAgICAgLy8gc28gd2UgZG8gYSBjaGVjayB0byBhdm9pZCBibG9ja2luZyA8IGFuZCA+IGFjdGlvbnMKICAgICBpZiAod2lkdGggIT0gdzNjX3NsaWR5Lmxhc3Rfd2lkdGggfHwgaGVpZ2h0ICE9IHczY19zbGlkeS5sYXN0X2hlaWdodCkKICAgICB7CiAgICAgICBpZiAod2lkdGggPj0gMTEwMCkKICAgICAgICAgdzNjX3NsaWR5LnNpemVfaW5kZXggPSA1OyAgICAvLyA0CiAgICAgICBlbHNlIGlmICh3aWR0aCA+PSAxMDAwKQogICAgICAgICB3M2Nfc2xpZHkuc2l6ZV9pbmRleCA9IDQ7ICAgIC8vIDMKICAgICAgIGVsc2UgaWYgKHdpZHRoID49IDgwMCkKICAgICAgICAgdzNjX3NsaWR5LnNpemVfaW5kZXggPSAzOyAgICAvLyAyCiAgICAgICBlbHNlIGlmICh3aWR0aCA+PSA2MDApCiAgICAgICAgIHczY19zbGlkeS5zaXplX2luZGV4ID0gMjsgICAgLy8gMQogICAgICAgZWxzZSBpZiAod2lkdGgpCiAgICAgICAgIHczY19zbGlkeS5zaXplX2luZGV4ID0gMDsKCiAgICAgICAvLyBhZGQgaW4gZm9udCBzaXplIGFkanVzdG1lbnQgZnJvbSBtZXRhIGVsZW1lbnQgZS5nLgogICAgICAgLy8gPG1ldGEgbmFtZT0iZm9udC1zaXplLWFkanVzdG1lbnQiIGNvbnRlbnQ9Ii0yIiAvPgogICAgICAgLy8gdXNlZnVsIHdoZW4gc2xpZGVzIGhhdmUgdG9vIG11Y2ggY29udGVudCA7LSkKCiAgICAgICBpZiAoMCA8PSB3M2Nfc2xpZHkuc2l6ZV9pbmRleCArIHczY19zbGlkeS5zaXplX2FkanVzdG1lbnQgJiYKICAgICAgICAgICAgIHczY19zbGlkeS5zaXplX2luZGV4ICsgdzNjX3NsaWR5LnNpemVfYWRqdXN0bWVudCA8IHczY19zbGlkeS5zaXplcy5sZW5ndGgpCiAgICAgICAgIHczY19zbGlkeS5zaXplX2luZGV4ID0gdzNjX3NsaWR5LnNpemVfaW5kZXggKyB3M2Nfc2xpZHkuc2l6ZV9hZGp1c3RtZW50OwoKICAgICAgIC8vIGVuYWJsZXMgY3Jvc3MgYnJvd3NlciB1c2Ugb2YgcmVsYXRpdmUgd2lkdGgvaGVpZ2h0CiAgICAgICAvLyBvbiBvYmplY3QgZWxlbWVudHMgZm9yIHVzZSB3aXRoIFNWRyBhbmQgRmxhc2ggbWVkaWEKICAgICAgIHczY19zbGlkeS5hZGp1c3Rfb2JqZWN0X2RpbWVuc2lvbnMod2lkdGgsIGhlaWdodCk7CgogICAgICAgaWYgKGRvY3VtZW50LmJvZHkuc3R5bGUuZm9udFNpemUgIT0gdzNjX3NsaWR5LnNpemVzW3czY19zbGlkeS5zaXplX2luZGV4XSkKICAgICAgIHsKICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5mb250U2l6ZSA9IHczY19zbGlkeS5zaXplc1t3M2Nfc2xpZHkuc2l6ZV9pbmRleF07CiAgICAgICB9CgogICAgICAgdzNjX3NsaWR5Lmxhc3Rfd2lkdGggPSB3aWR0aDsKICAgICAgIHczY19zbGlkeS5sYXN0X2hlaWdodCA9IGhlaWdodDsKCiAgICAgICAvLyBmb3JjZSByZWZsb3cgdG8gd29yayBhcm91bmQgTW96aWxsYSBidWcKICAgICAgIGlmICh3M2Nfc2xpZHkubnNfcG9zKQogICAgICAgewogICAgICAgICB2YXIgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwogICAgICAgICB3M2Nfc2xpZHkuaGlkZV9zbGlkZShzbGlkZSk7CiAgICAgICAgIHczY19zbGlkeS5zaG93X3NsaWRlKHNsaWRlKTsKICAgICAgIH0KCiAgICAgICAvLyBmb3JjZSBjb3JyZWN0IHBvc2l0aW9uaW5nIG9mIHRvb2xiYXIKICAgICAgIHczY19zbGlkeS5yZWZyZXNoX3Rvb2xiYXIoMjAwKTsKICAgICB9CiAgfSwKCiAgc2Nyb2xsZWQ6IGZ1bmN0aW9uICgpIHsKICAgIGlmICh3M2Nfc2xpZHkudG9vbGJhciAmJiAhdzNjX3NsaWR5Lm5zX3BvcyAmJiAhdzNjX3NsaWR5LmllNykKICAgIHsKICAgICAgdzNjX3NsaWR5LmhhY2tfb2Zmc2V0ID0gdzNjX3NsaWR5LnNjcm9sbF94X29mZnNldCgpOwogICAgICAvLyBoaWRlIHRvb2xiYXIKICAgICAgdzNjX3NsaWR5LnRvb2xiYXIuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKCiAgICAgIC8vIG1ha2UgaXQgcmVhcHBlYXIgbGF0ZXIKICAgICAgaWYgKHczY19zbGlkeS5zY3JvbGxoYWNrID09IDAgJiYgIXczY19zbGlkeS52aWV3X2FsbCkKICAgICAgewogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge3czY19zbGlkeS5zaG93X3Rvb2xiYXIoKTsgfSwgMTAwMCk7CiAgICAgICAgdzNjX3NsaWR5LnNjcm9sbGhhY2sgPSAxOwogICAgICB9CiAgICB9CiAgfSwKCiAgaGlkZV90b29sYmFyOiBmdW5jdGlvbiAoKSB7CiAgICB3M2Nfc2xpZHkuYWRkX2NsYXNzKHczY19zbGlkeS50b29sYmFyLCAiaGlkZGVuIik7CiAgICB3aW5kb3cuZm9jdXMoKTsKICB9LAoKICAvLyB1c2VkIHRvIGVuc3VyZSBJRSByZWZyZXNoZXMgdG9vbGJhciBpbiBjb3JyZWN0IHBvc2l0aW9uCiAgcmVmcmVzaF90b29sYmFyOiBmdW5jdGlvbiAoaW50ZXJ2YWwpIHsKICAgIGlmICghdzNjX3NsaWR5Lm5zX3BvcyAmJiAhdzNjX3NsaWR5LmllNykKICAgIHsKICAgICAgdzNjX3NsaWR5LmhpZGVfdG9vbGJhcigpOwogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHt3M2Nfc2xpZHkuc2hvd190b29sYmFyKCk7fSwgaW50ZXJ2YWwpOwogICAgfQogIH0sCgogIC8vIHJlc3RvcmVzIHRvb2xiYXIgYWZ0ZXIgc2hvcnQgZGVsYXkKICBzaG93X3Rvb2xiYXI6IGZ1bmN0aW9uICgpIHsKICAgIGlmICh3M2Nfc2xpZHkud2FudF90b29sYmFyKQogICAgewogICAgICB3M2Nfc2xpZHkudG9vbGJhci5zdHlsZS5kaXNwbGF5ID0gImJsb2NrIjsKCiAgICAgIGlmICghdzNjX3NsaWR5Lm5zX3BvcykKICAgICAgewogICAgICAgIC8vIGFkanVzdCBwb3NpdGlvbiB0byBhbGxvdyBmb3Igc2Nyb2xsaW5nCiAgICAgICAgdmFyIHhvZmZzZXQgPSB3M2Nfc2xpZHkuc2Nyb2xsX3hfb2Zmc2V0KCk7CiAgICAgICAgdzNjX3NsaWR5LnRvb2xiYXIuc3R5bGUubGVmdCA9IHhvZmZzZXQ7CiAgICAgICAgdzNjX3NsaWR5LnRvb2xiYXIuc3R5bGUucmlnaHQgPSB4b2Zmc2V0OwoKICAgICAgICAvLyBkZXRlcm1pbmUgdmVydGljYWwgc2Nyb2xsIG9mZnNldAogICAgICAgIC8vdmFyIHlvZmZzZXQgPSBzY3JvbGxZT2Zmc2V0KCk7CgogICAgICAgIC8vIGJvdHRvbSBpcyBkb2MgaGVpZ2h0IC0gd2luZG93IGhlaWdodCAtIHNjcm9sbCBvZmZzZXQKICAgICAgICAvL3ZhciBib3R0b20gPSBkb2N1bWVudEhlaWdodCgpIC0gbGFzdEhlaWdodCAtIHlvZmZzZXQKCiAgICAgICAgLy9pZiAoeW9mZnNldCA+IDAgfHwgZG9jdW1lbnRIZWlnaHQoKSA+IGxhc3RIZWlnaHQpCiAgICAgICAgLy8gICBib3R0b20gKz0gMTY7ICAvLyBhbGxvdyBmb3IgaGVpZ2h0IG9mIHNjcm9sbGJhcgoKICAgICAgICB3M2Nfc2xpZHkudG9vbGJhci5zdHlsZS5ib3R0b20gPSAwOyAvL2JvdHRvbTsKICAgICAgfQoKICAgICAgdzNjX3NsaWR5LnJlbW92ZV9jbGFzcyh3M2Nfc2xpZHkudG9vbGJhciwgImhpZGRlbiIpOwogICAgfQoKICAgIHczY19zbGlkeS5zY3JvbGxoYWNrID0gMDsKCgogICAgLy8gc2V0IHRoZSBrZXlib2FyZCBmb2N1cyB0byB0aGUgaGVscCBsaW5rIG9uIHRoZQogICAgLy8gdG9vbGJhciB0byBlbnN1cmUgdGhhdCBkb2N1bWVudCBoYXMgdGhlIGZvY3VzCiAgICAvLyBJRSBkb2Vzbid0IGFsd2F5cyB3b3JrIHdpdGggd2luZG93LmZvY3VzKCkKICAgIC8vIGFuZCB0aGlzIGhhY2sgaGFzIGJlbmVmaXQgb2YgRW50ZXIgZm9yIGhlbHAKCiAgICB0cnkKICAgIHsKICAgICAgaWYgKCF3M2Nfc2xpZHkub3BlcmEpCiAgICAgICAgdzNjX3NsaWR5LnNldF9mb2N1cygpOwogICAgfQogICAgY2F0Y2ggKGUpCiAgICB7CiAgICB9CiAgfSwKCi8vIGludm9rZWQgdmlhIEYga2V5CiAgdG9nZ2xlX3Rvb2xiYXI6IGZ1bmN0aW9uICgpIHsKICAgIGlmICghdzNjX3NsaWR5LnZpZXdfYWxsKQogICAgewogICAgICBpZiAodzNjX3NsaWR5Lmhhc19jbGFzcyh3M2Nfc2xpZHkudG9vbGJhciwgImhpZGRlbiIpKQogICAgICB7CiAgICAgICAgdzNjX3NsaWR5LnJlbW92ZV9jbGFzcyh3M2Nfc2xpZHkudG9vbGJhciwgImhpZGRlbiIpCiAgICAgICAgdzNjX3NsaWR5LndhbnRfdG9vbGJhciA9IDE7CiAgICAgIH0KICAgICAgZWxzZQogICAgICB7CiAgICAgICAgdzNjX3NsaWR5LmFkZF9jbGFzcyh3M2Nfc2xpZHkudG9vbGJhciwgImhpZGRlbiIpCiAgICAgICAgdzNjX3NsaWR5LndhbnRfdG9vbGJhciA9IDA7CiAgICAgIH0KICAgIH0KICB9LAoKICBzY3JvbGxfeF9vZmZzZXQ6IGZ1bmN0aW9uICgpIHsKICAgIGlmICh3aW5kb3cucGFnZVhPZmZzZXQpCiAgICAgIHJldHVybiBzZWxmLnBhZ2VYT2Zmc2V0OwoKICAgIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgJiYgCiAgICAgICAgICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdCkKICAgICAgcmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0OwoKICAgIGlmIChkb2N1bWVudC5ib2R5KQogICAgICByZXR1cm4gZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0OwoKICAgIHJldHVybiAwOwogIH0sCgogIHNjcm9sbF95X29mZnNldDogZnVuY3Rpb24gKCkgewogICAgaWYgKHdpbmRvdy5wYWdlWU9mZnNldCkKICAgICAgcmV0dXJuIHNlbGYucGFnZVlPZmZzZXQ7CgogICAgaWYgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCAmJiAKICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3ApCiAgICAgIHJldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wOwoKICAgIGlmIChkb2N1bWVudC5ib2R5KQogICAgICByZXR1cm4gZG9jdW1lbnQuYm9keS5zY3JvbGxUb3A7CgogICAgcmV0dXJuIDA7CiAgfSwKCiAgLy8gbG9va2luZyBmb3IgYSB3YXkgdG8gZGV0ZXJtaW5lIGhlaWdodCBvZiBzbGlkZSBjb250ZW50CiAgLy8gdGhlIHNsaWRlIGl0c2VsZiBpcyBzZXQgdG8gdGhlIGhlaWdodCBvZiB0aGUgd2luZG93CiAgb3B0aW1pemVfZm9udF9zaXplOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwoKICAgIC8vdmFyIGRoID0gZG9jdW1lbnRIZWlnaHQoKTsgLy9nZXREb2NIZWlnaHQoZG9jdW1lbnQpOwogICAgdmFyIGRoID0gc2xpZGUuc2Nyb2xsSGVpZ2h0OwogICAgdmFyIHdoID0gZ2V0V2luZG93SGVpZ2h0KCk7CiAgICB2YXIgdSA9IDEwMCAqIGRoIC8gd2g7CgogICAgYWxlcnQoIndpbmRvdyB1dGlsaXphdGlvbiA9ICIgKyB1ICsgIiUgKGRvYyAiCiAgICAgICsgZGggKyAiIHdpbiAiICsgd2ggKyAiKSIpOwogIH0sCgogIC8vIGZyb20gZG9jdW1lbnQgb2JqZWN0CiAgZ2V0X2RvY19oZWlnaHQ6IGZ1bmN0aW9uIChkb2MpIHsKICAgIGlmICghZG9jKQogICAgICBkb2MgPSBkb2N1bWVudDsKCiAgICBpZiAoZG9jICYmIGRvYy5ib2R5ICYmIGRvYy5ib2R5Lm9mZnNldEhlaWdodCkKICAgICAgcmV0dXJuIGRvYy5ib2R5Lm9mZnNldEhlaWdodDsgIC8vIG5zL2dlY2tvIHN5bnRheAoKICAgIGlmIChkb2MgJiYgZG9jLmJvZHkgJiYgZG9jLmJvZHkuc2Nyb2xsSGVpZ2h0KQogICAgICByZXR1cm4gZG9jLmJvZHkuc2Nyb2xsSGVpZ2h0OwoKICAgIGFsZXJ0KCJjb3VsZG4ndCBkZXRlcm1pbmUgZG9jdW1lbnQgaGVpZ2h0Iik7CiAgfSwKCiAgZ2V0X3dpbmRvd19oZWlnaHQ6IGZ1bmN0aW9uICgpIHsKICAgIGlmICggdHlwZW9mKCB3aW5kb3cuaW5uZXJIZWlnaHQgKSA9PSAnbnVtYmVyJyApCiAgICAgIHJldHVybiB3aW5kb3cuaW5uZXJIZWlnaHQ7ICAvLyBOb24gSUUgYnJvd3NlcgoKICAgIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgJiYgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCkKICAgICAgcmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ7ICAvLyBJRTYKCiAgICBpZiAoZG9jdW1lbnQuYm9keSAmJiBkb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodCkKICAgICAgcmV0dXJuIGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0OyAvLyBJRTQKICB9LAoKICBkb2N1bWVudF9oZWlnaHQ6IGZ1bmN0aW9uICgpIHsKICAgIHZhciBzaCwgb2g7CgogICAgc2ggPSBkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodDsKICAgIG9oID0gZG9jdW1lbnQuYm9keS5vZmZzZXRIZWlnaHQ7CgogICAgaWYgKHNoICYmIG9oKQogICAgewogICAgICByZXR1cm4gKHNoID4gb2ggPyBzaCA6IG9oKTsKICAgIH0KCiAgICAvLyBubyBpZGVhIQogICAgcmV0dXJuIDA7CiAgfSwKCiAgc21hbGxlcjogZnVuY3Rpb24gKCkgewogICAgaWYgKHczY19zbGlkeS5zaXplX2luZGV4ID4gMCkKICAgIHsKICAgICAgLS13M2Nfc2xpZHkuc2l6ZV9pbmRleDsKICAgIH0KCiAgICB3M2Nfc2xpZHkudG9vbGJhci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgZG9jdW1lbnQuYm9keS5zdHlsZS5mb250U2l6ZSA9IHczY19zbGlkeS5zaXplc1t3M2Nfc2xpZHkuc2l6ZV9pbmRleF07CiAgICB2YXIgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwogICAgdzNjX3NsaWR5LmhpZGVfc2xpZGUoc2xpZGUpOwogICAgdzNjX3NsaWR5LnNob3dfc2xpZGUoc2xpZGUpOwogICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7dzNjX3NsaWR5LnNob3dfdG9vbGJhcigpOyB9LCA1MCk7CiAgfSwKCiAgYmlnZ2VyOiBmdW5jdGlvbiAoKSB7CiAgICBpZiAodzNjX3NsaWR5LnNpemVfaW5kZXggPCB3M2Nfc2xpZHkuc2l6ZXMubGVuZ3RoIC0gMSkKICAgIHsKICAgICAgKyt3M2Nfc2xpZHkuc2l6ZV9pbmRleDsKICAgIH0KCiAgICB3M2Nfc2xpZHkudG9vbGJhci5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgZG9jdW1lbnQuYm9keS5zdHlsZS5mb250U2l6ZSA9IHczY19zbGlkeS5zaXplc1t3M2Nfc2xpZHkuc2l6ZV9pbmRleF07CiAgICB2YXIgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwogICAgdzNjX3NsaWR5LmhpZGVfc2xpZGUoc2xpZGUpOwogICAgdzNjX3NsaWR5LnNob3dfc2xpZGUoc2xpZGUpOwogICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7dzNjX3NsaWR5LnNob3dfdG9vbGJhcigpOyB9LCA1MCk7CiAgfSwKCiAgLy8gZW5hYmxlcyBjcm9zcyBicm93c2VyIHVzZSBvZiByZWxhdGl2ZSB3aWR0aC9oZWlnaHQKICAvLyBvbiBvYmplY3QgZWxlbWVudHMgZm9yIHVzZSB3aXRoIFNWRyBhbmQgRmxhc2ggbWVkaWEKICAvLyB3aXRoIHRoYW5rcyB0byBJdmFuIEhlcm1hbiBmb3IgdGhlIHN1Z2dlc3Rpb24KICBhZGp1c3Rfb2JqZWN0X2RpbWVuc2lvbnM6IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0KSB7CiAgICBmb3IoIHZhciBpID0gMDsgaSA8IHczY19zbGlkeS5vYmplY3RzLmxlbmd0aDsgaSsrICkKICAgIHsKICAgICAgdmFyIG9iaiA9IHRoaXMub2JqZWN0c1tpXTsKICAgICAgdmFyIG1pbWVUeXBlID0gb2JqLmdldEF0dHJpYnV0ZSgidHlwZSIpOwoKICAgICAgaWYgKG1pbWVUeXBlID09ICJpbWFnZS9zdmcreG1sIiB8fCBtaW1lVHlwZSA9PSAiYXBwbGljYXRpb24veC1zaG9ja3dhdmUtZmxhc2giKQogICAgICB7CiAgICAgICAgaWYgKCAhb2JqLmluaXRpYWxXaWR0aCApIAogICAgICAgICAgb2JqLmluaXRpYWxXaWR0aCA9IG9iai5nZXRBdHRyaWJ1dGUoIndpZHRoIik7CgogICAgICAgIGlmICggIW9iai5pbml0aWFsSGVpZ2h0ICkgCiAgICAgICAgICBvYmouaW5pdGlhbEhlaWdodCA9IG9iai5nZXRBdHRyaWJ1dGUoImhlaWdodCIpOwoKICAgICAgICBpZiAoIG9iai5pbml0aWFsV2lkdGggJiYgb2JqLmluaXRpYWxXaWR0aC5jaGFyQXQob2JqLmluaXRpYWxXaWR0aC5sZW5ndGgtMSkgPT0gIiUiICkKICAgICAgICB7CiAgICAgICAgICB2YXIgdyA9IHBhcnNlSW50KG9iai5pbml0aWFsV2lkdGguc2xpY2UoMCwgb2JqLmluaXRpYWxXaWR0aC5sZW5ndGgtMSkpOwogICAgICAgICAgdmFyIG5ld1cgPSB3aWR0aCAqICh3LzEwMC4wKTsKICAgICAgICAgIG9iai5zZXRBdHRyaWJ1dGUoIndpZHRoIixuZXdXKTsKICAgICAgICB9CgogICAgICAgIGlmICggb2JqLmluaXRpYWxIZWlnaHQgJiYKICAgICAgICAgICAgIG9iai5pbml0aWFsSGVpZ2h0LmNoYXJBdChvYmouaW5pdGlhbEhlaWdodC5sZW5ndGgtMSkgPT0gIiUiICkKICAgICAgICB7CiAgICAgICAgICB2YXIgaCA9IHBhcnNlSW50KG9iai5pbml0aWFsSGVpZ2h0LnNsaWNlKDAsIG9iai5pbml0aWFsSGVpZ2h0Lmxlbmd0aC0xKSk7CiAgICAgICAgICB2YXIgbmV3SCA9IGhlaWdodCAqIChoLzEwMC4wKTsKICAgICAgICAgIG9iai5zZXRBdHRyaWJ1dGUoImhlaWdodCIsIG5ld0gpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sCgogIC8vIG5lZWRlZCBmb3IgT3BlcmEgdG8gaW5oaWJpdCBkZWZhdWx0IGJlaGF2aW9yCiAgLy8gc2luY2UgT3BlcmEgZGVsaXZlcnMga2V5UHJlc3MgZXZlbiBpZiBrZXlEb3duCiAgLy8gd2FzIGNhbmNlbGxlZAogIGtleV9wcmVzczogZnVuY3Rpb24gKGV2ZW50KSB7CiAgICBpZiAoIWV2ZW50KQogICAgICBldmVudCA9IHdpbmRvdy5ldmVudDsKCiAgICBpZiAoIXczY19zbGlkeS5rZXlfd2FudGVkKQogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CgogICAgcmV0dXJuIHRydWU7CiAgfSwKCiAgLy8gIFNlZSBlLmcuIGh0dHA6Ly93d3cucXVpcmtzbW9kZS5vcmcvanMvZXZlbnRzL2tleXMuaHRtbCBmb3Iga2V5Y29kZXMKICBrZXlfZG93bjogZnVuY3Rpb24gKGV2ZW50KSB7CiAgICB2YXIga2V5LCB0YXJnZXQsIHRhZzsKCiAgICB3M2Nfc2xpZHkua2V5X3dhbnRlZCA9IHRydWU7CgogICAgaWYgKCFldmVudCkKICAgICAgZXZlbnQgPSB3aW5kb3cuZXZlbnQ7CgogICAgLy8ga2x1ZGdlIGFyb3VuZCBOUy9JRSBkaWZmZXJlbmNlcyAKICAgIGlmICh3aW5kb3cuZXZlbnQpCiAgICB7CiAgICAgIGtleSA9IHdpbmRvdy5ldmVudC5rZXlDb2RlOwogICAgICB0YXJnZXQgPSB3aW5kb3cuZXZlbnQuc3JjRWxlbWVudDsKICAgIH0KICAgIGVsc2UgaWYgKGV2ZW50LndoaWNoKQogICAgewogICAgICBrZXkgPSBldmVudC53aGljaDsKICAgICAgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0OwogICAgfQogICAgZWxzZQogICAgICByZXR1cm4gdHJ1ZTsgLy8gWWlrZXMhIHVua25vd24gYnJvd3NlcgoKICAgIC8vIGlnbm9yZSBldmVudCBpZiBrZXkgdmFsdWUgaXMgemVybwogICAgLy8gYXMgZm9yIGFsdCBvbiBPcGVyYSBhbmQgS29ucXVlcm9yCiAgICBpZiAoIWtleSkKICAgICAgIHJldHVybiB0cnVlOwoKICAgIC8vIGF2b2lkIGludGVyZmVyaW5nIHdpdGgga2V5c3Ryb2tlCiAgICAvLyBiZWhhdmlvciBmb3Igbm9uLXNsaWR5IGNocm9tZSBlbGVtZW50cwogICAgaWYgKCF3M2Nfc2xpZHkuc2xpZHlfY2hyb21lKHRhcmdldCkgJiYKICAgICAgICB3M2Nfc2xpZHkuc3BlY2lhbF9lbGVtZW50KHRhcmdldCkpCiAgICAgIHJldHVybiB0cnVlOwoKICAgIC8vIGNoZWNrIGZvciBjb25jdXJyZW50IGNvbnRyb2wvY29tbWFuZC9hbHQga2V5CiAgICAvLyBidXQgYXJlIHRoZXNlIG9ubHkgcHJlc2VudCBvbiBtb3VzZSBldmVudHM/CgogICAgaWYgKGV2ZW50LmN0cmxLZXkgfHwgZXZlbnQuYWx0S2V5IHx8IGV2ZW50Lm1ldGFLZXkpCiAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAvLyBkaXNtaXNzIHRhYmxlIG9mIGNvbnRlbnRzIGlmIHZpc2libGUKICAgIGlmICh3M2Nfc2xpZHkuaXNfc2hvd25fdG9jKCkgJiYga2V5ICE9IDkgJiYga2V5ICE9IDE2ICYmIGtleSAhPSAzOCAmJiBrZXkgIT0gNDApCiAgICB7CiAgICAgIHczY19zbGlkeS5oaWRlX3RhYmxlX29mX2NvbnRlbnRzKHRydWUpOwoKICAgICAgaWYgKGtleSA9PSAyNyB8fCBrZXkgPT0gODQgfHwga2V5ID09IDY3KQogICAgICAgIHJldHVybiB3M2Nfc2xpZHkuY2FuY2VsKGV2ZW50KTsKICAgIH0KCiAgICBpZiAoa2V5ID09IDM0KSAvLyBQYWdlIERvd24KICAgIHsKICAgICAgaWYgKHczY19zbGlkeS52aWV3X2FsbCkKICAgICAgICByZXR1cm4gdHJ1ZTsKCiAgICAgIHczY19zbGlkeS5uZXh0X3NsaWRlKGZhbHNlKTsKICAgICAgcmV0dXJuIHczY19zbGlkeS5jYW5jZWwoZXZlbnQpOwogICAgfQogICAgZWxzZSBpZiAoa2V5ID09IDMzKSAvLyBQYWdlIFVwCiAgICB7CiAgICAgIGlmICh3M2Nfc2xpZHkudmlld19hbGwpCiAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICB3M2Nfc2xpZHkucHJldmlvdXNfc2xpZGUoZmFsc2UpOwogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CiAgICB9CiAgICBlbHNlIGlmIChrZXkgPT0gMzIpIC8vIHNwYWNlIGJhcgogICAgewogICAgICB3M2Nfc2xpZHkubmV4dF9zbGlkZSh0cnVlKTsKICAgICAgcmV0dXJuIHczY19zbGlkeS5jYW5jZWwoZXZlbnQpOwogICAgfQogICAgZWxzZSBpZiAoa2V5ID09IDM3KSAvLyBMZWZ0IGFycm93CiAgICB7CiAgICAgIHczY19zbGlkeS5wcmV2aW91c19zbGlkZSghZXZlbnQuc2hpZnRLZXkpOwogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CiAgICB9CiAgICBlbHNlIGlmIChrZXkgPT0gMzYpIC8vIEhvbWUKICAgIHsKICAgICAgdzNjX3NsaWR5LmZpcnN0X3NsaWRlKCk7CiAgICAgIHJldHVybiB3M2Nfc2xpZHkuY2FuY2VsKGV2ZW50KTsKICAgIH0KICAgIGVsc2UgaWYgKGtleSA9PSAzNSkgLy8gRW5kCiAgICB7CiAgICAgIHczY19zbGlkeS5sYXN0X3NsaWRlKCk7CiAgICAgIHJldHVybiB3M2Nfc2xpZHkuY2FuY2VsKGV2ZW50KTsKICAgIH0KICAgIGVsc2UgaWYgKGtleSA9PSAzOSkgLy8gUmlnaHQgYXJyb3cKICAgIHsKICAgICAgdzNjX3NsaWR5Lm5leHRfc2xpZGUoIWV2ZW50LnNoaWZ0S2V5KTsKICAgICAgcmV0dXJuIHczY19zbGlkeS5jYW5jZWwoZXZlbnQpOwogICAgfQogICAgZWxzZSBpZiAoa2V5ID09IDEzKSAvLyBFbnRlcgogICAgewogICAgICBpZiAodzNjX3NsaWR5Lm91dGxpbmUpCiAgICAgIHsKICAgICAgICBpZiAodzNjX3NsaWR5Lm91dGxpbmUudmlzaWJsZSkKICAgICAgICAgIHczY19zbGlkeS5mb2xkKHczY19zbGlkeS5vdXRsaW5lKTsKICAgICAgICBlbHNlCiAgICAgICAgICB3M2Nfc2xpZHkudW5mb2xkKHczY19zbGlkeS5vdXRsaW5lKTsKICAgICAgICAgIAogICAgICAgcmV0dXJuIHczY19zbGlkeS5jYW5jZWwoZXZlbnQpOwogICAgICB9CiAgICB9CiAgICBlbHNlIGlmIChrZXkgPT0gMTg4KSAgLy8gPCBmb3Igc21hbGxlciBmb250cwogICAgewogICAgICB3M2Nfc2xpZHkuc21hbGxlcigpOwogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CiAgICB9CiAgICBlbHNlIGlmIChrZXkgPT0gMTkwKSAgLy8gPiBmb3IgbGFyZ2VyIGZvbnRzCiAgICB7CiAgICAgIHczY19zbGlkeS5iaWdnZXIoKTsKICAgICAgcmV0dXJuIHczY19zbGlkeS5jYW5jZWwoZXZlbnQpOwogICAgfQogICAgZWxzZSBpZiAoa2V5ID09IDE4OSB8fCBrZXkgPT0gMTA5KSAgLy8gLSBmb3Igc21hbGxlciBmb250cwogICAgewogICAgICB3M2Nfc2xpZHkuc21hbGxlcigpOwogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CiAgICB9CiAgICBlbHNlIGlmIChrZXkgPT0gMTg3IHx8IGtleSA9PSAxOTEgfHwga2V5ID09IDEwNykgIC8vID0gKyAgZm9yIGxhcmdlciBmb250cwogICAgewogICAgICB3M2Nfc2xpZHkuYmlnZ2VyKCk7CiAgICAgIHJldHVybiB3M2Nfc2xpZHkuY2FuY2VsKGV2ZW50KTsKICAgIH0KICAgIGVsc2UgaWYgKGtleSA9PSA4MykgIC8vIFMgZm9yIHNtYWxsZXIgZm9udHMKICAgIHsKICAgICAgdzNjX3NsaWR5LnNtYWxsZXIoKTsKICAgICAgcmV0dXJuIHczY19zbGlkeS5jYW5jZWwoZXZlbnQpOwogICAgfQogICAgZWxzZSBpZiAoa2V5ID09IDY2KSAgLy8gQiBmb3IgbGFyZ2VyIGZvbnRzCiAgICB7CiAgICAgIHczY19zbGlkeS5iaWdnZXIoKTsKICAgICAgcmV0dXJuIHczY19zbGlkeS5jYW5jZWwoZXZlbnQpOwogICAgfQogICAgZWxzZSBpZiAoa2V5ID09IDkwKSAgLy8gWiBmb3IgbGFzdCBzbGlkZQogICAgewogICAgICB3M2Nfc2xpZHkubGFzdF9zbGlkZSgpOwogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CiAgICB9CiAgICBlbHNlIGlmIChrZXkgPT0gNzApICAvLyBGIGZvciB0b2dnbGUgdG9vbGJhcgogICAgewogICAgICB3M2Nfc2xpZHkudG9nZ2xlX3Rvb2xiYXIoKTsKICAgICAgcmV0dXJuIHczY19zbGlkeS5jYW5jZWwoZXZlbnQpOwogICAgfQogICAgZWxzZSBpZiAoa2V5ID09IDY1KSAgLy8gQSBmb3IgdG9nZ2xlIHZpZXcgc2luZ2xlL2FsbCBzbGlkZXMKICAgIHsKICAgICAgdzNjX3NsaWR5LnRvZ2dsZV92aWV3KCk7CiAgICAgIHJldHVybiB3M2Nfc2xpZHkuY2FuY2VsKGV2ZW50KTsKICAgIH0KICAgIGVsc2UgaWYgKGtleSA9PSA3NSkgIC8vIHRvZ2dsZSBhY3Rpb24gb2YgbGVmdCBjbGljayBmb3IgbmV4dCBwYWdlCiAgICB7CiAgICAgIHczY19zbGlkeS5tb3VzZV9jbGlja19lbmFibGVkID0gIXczY19zbGlkeS5tb3VzZV9jbGlja19lbmFibGVkOwogICAgICB2YXIgYWxlcnRfbXNnID0gKHczY19zbGlkeS5tb3VzZV9jbGlja19lbmFibGVkID8KICAgICAgICAgICAgICAgICJlbmFibGVkIiA6ICJkaXNhYmxlZCIpICsgICIgbW91c2UgY2xpY2sgYWR2YW5jZSI7CgogICAgICBhbGVydCh3M2Nfc2xpZHkubG9jYWxpemUoYWxlcnRfbXNnKSk7CiAgICAgIHJldHVybiB3M2Nfc2xpZHkuY2FuY2VsKGV2ZW50KTsKICAgIH0KICAgIGVsc2UgaWYgKGtleSA9PSA4NCB8fCBrZXkgPT0gNjcpICAvLyBUIG9yIEMgZm9yIHRhYmxlIG9mIGNvbnRlbnRzCiAgICB7CiAgICAgIGlmICh3M2Nfc2xpZHkudG9jKQogICAgICAgIHczY19zbGlkeS50b2dnbGVfdGFibGVfb2ZfY29udGVudHMoKTsKCiAgICAgIHJldHVybiB3M2Nfc2xpZHkuY2FuY2VsKGV2ZW50KTsKICAgIH0KICAgIGVsc2UgaWYgKGtleSA9PSA3MikgLy8gSCBmb3IgaGVscAogICAgewogICAgICB3aW5kb3cubG9jYXRpb24gPSB3M2Nfc2xpZHkuaGVscF9wYWdlOwogICAgICByZXR1cm4gdzNjX3NsaWR5LmNhbmNlbChldmVudCk7CiAgICB9CiAgICAvL2Vsc2UgYWxlcnQoImtleSBjb2RlIGlzICIrIGtleSk7CgogICAgcmV0dXJuIHRydWU7CiAgfSwKCiAgLy8gc2FmZSBmb3IgYm90aCB0ZXh0L2h0bWwgYW5kIGFwcGxpY2F0aW9uL3hodG1sK3htbAogIGNyZWF0ZV9lbGVtZW50OiBmdW5jdGlvbiAobmFtZSkgewogICAgaWYgKHRoaXMueGh0bWwgJiYgKHR5cGVvZiBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMgIT0gJ3VuZGVmaW5lZCcpKQogICAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiwgbmFtZSkKCiAgICByZXR1cm4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChuYW1lKTsKICB9LAoKICBnZXRfZWxlbWVudF9zdHlsZTogZnVuY3Rpb24gKGVsZW0sIElFU3R5bGVQcm9wLCBDU1NTdHlsZVByb3ApIHsKICAgIGlmIChlbGVtLmN1cnJlbnRTdHlsZSkKICAgIHsKICAgICAgcmV0dXJuIGVsZW0uY3VycmVudFN0eWxlW0lFU3R5bGVQcm9wXTsKICAgIH0KICAgIGVsc2UgaWYgKHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKQogICAgewogICAgICB2YXIgY29tcFN0eWxlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWxlbSwgIiIpOwogICAgICByZXR1cm4gY29tcFN0eWxlLmdldFByb3BlcnR5VmFsdWUoQ1NTU3R5bGVQcm9wKTsKICAgIH0KICAgIHJldHVybiAiIjsKICB9LAoKICAvLyB0aGUgc3RyaW5nIHN0ciBpcyBhIHdoaXRlc3BhY2Ugc2VwYXJhdGVkIGxpc3Qgb2YgdG9rZW5zCiAgLy8gdGVzdCBpZiBzdHIgY29udGFpbnMgYSBwYXJ0aWN1bGFyIHRva2VuLCBlLmcuICJzbGlkZSIKICBoYXNfdG9rZW46IGZ1bmN0aW9uIChzdHIsIHRva2VuKSB7CiAgICBpZiAoc3RyKQogICAgewogICAgICAvLyBkZWZpbmUgcGF0dGVybiBhcyByZWd1bGFyIGV4cHJlc3Npb24KICAgICAgdmFyIHBhdHRlcm4gPSAvXHcrL2c7CgogICAgICAvLyBjaGVjayBmb3IgbWF0Y2hlcwogICAgICAvLyBwbGFjZSByZXN1bHQgaW4gYXJyYXkKICAgICAgdmFyIHJlc3VsdCA9IHN0ci5tYXRjaChwYXR0ZXJuKTsKCiAgICAgIC8vIG5vdyBjaGVjayBpZiBkZXNpcmVkIHRva2VuIGlzIHByZXNlbnQKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXN1bHQubGVuZ3RoOyBpKyspCiAgICAgIHsKICAgICAgICBpZiAocmVzdWx0W2ldID09IHRva2VuKQogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gZmFsc2U7CiAgfSwKCiAgZ2V0X2NsYXNzX2xpc3Q6IGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICBpZiAodHlwZW9mIGVsZW1lbnQuY2xhc3NOYW1lICE9ICd1bmRlZmluZWQnKQogICAgICByZXR1cm4gZWxlbWVudC5jbGFzc05hbWU7CgogICAgcmV0dXJuIGVsZW1lbnQuZ2V0QXR0cmlidXRlKCJjbGFzcyIpOwogIH0sCgogIGhhc19jbGFzczogZnVuY3Rpb24gKGVsZW1lbnQsIG5hbWUpIHsKICAgIGlmIChlbGVtZW50Lm5vZGVUeXBlICE9IDEpCiAgICAgIHJldHVybiBmYWxzZTsKCiAgICB2YXIgcmVnZXhwID0gbmV3IFJlZ0V4cCgiKF58ICkiICsgbmFtZSArICJcVyoiKTsKCiAgICBpZiAodHlwZW9mIGVsZW1lbnQuY2xhc3NOYW1lICE9ICd1bmRlZmluZWQnKQogICAgICByZXR1cm4gcmVnZXhwLnRlc3QoZWxlbWVudC5jbGFzc05hbWUpOwoKICAgIHJldHVybiByZWdleHAudGVzdChlbGVtZW50LmdldEF0dHJpYnV0ZSgiY2xhc3MiKSk7CiAgfSwKCiAgcmVtb3ZlX2NsYXNzOiBmdW5jdGlvbiAoZWxlbWVudCwgbmFtZSkgewogICAgdmFyIHJlZ2V4cCA9IG5ldyBSZWdFeHAoIihefCApIiArIG5hbWUgKyAiXFcqIik7CiAgICB2YXIgY2xzdmFsID0gIiI7CgogICAgaWYgKHR5cGVvZiBlbGVtZW50LmNsYXNzTmFtZSAhPSAndW5kZWZpbmVkJykKICAgIHsKICAgICAgY2xzdmFsID0gZWxlbWVudC5jbGFzc05hbWU7CgogICAgICBpZiAoY2xzdmFsKQogICAgICB7CiAgICAgICAgY2xzdmFsID0gY2xzdmFsLnJlcGxhY2UocmVnZXhwLCAiIik7CiAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgPSBjbHN2YWw7CiAgICAgIH0KICAgIH0KICAgIGVsc2UKICAgIHsKICAgICAgY2xzdmFsID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoImNsYXNzIik7CgogICAgICBpZiAoY2xzdmFsKQogICAgICB7CiAgICAgICAgY2xzdmFsID0gY2xzdmFsLnJlcGxhY2UocmVnZXhwLCAiIik7CiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoImNsYXNzIiwgY2xzdmFsKTsKICAgICAgfQogICAgfQogIH0sCgogIGFkZF9jbGFzczogZnVuY3Rpb24gKGVsZW1lbnQsIG5hbWUpIHsKICAgIGlmICghdGhpcy5oYXNfY2xhc3MoZWxlbWVudCwgbmFtZSkpCiAgICB7CiAgICAgIGlmICh0eXBlb2YgZWxlbWVudC5jbGFzc05hbWUgIT0gJ3VuZGVmaW5lZCcpCiAgICAgICAgZWxlbWVudC5jbGFzc05hbWUgKz0gIiAiICsgbmFtZTsKICAgICAgZWxzZQogICAgICB7CiAgICAgICAgdmFyIGNsc3ZhbCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCJjbGFzcyIpOwogICAgICAgIGNsc3ZhbCA9IGNsc3ZhbCA/IGNsc3ZhbCArICIgIiArIG5hbWUgOiBuYW1lOwogICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCJjbGFzcyIsIGNsc3ZhbCk7CiAgICAgIH0KICAgIH0KICB9LAoKICAvLyBIVE1MIGVsZW1lbnRzIHRoYXQgY2FuIGJlIHVzZWQgd2l0aCBjbGFzcz0iaW5jcmVtZW50YWwiCiAgLy8gbm90ZSB0aGF0IHlvdSBjYW4gYWxzbyBwdXQgdGhlIGNsYXNzIG9uIGNvbnRhaW5lcnMgbGlrZQogIC8vIHVwLCBvbCwgZGwsIGFuZCBkaXYgdG8gbWFrZSB0aGVpciBjb250ZW50cyBhcHBlYXIKICAvLyBpbmNyZW1lbnRhbGx5LiBVcHBlciBjYXNlIGlzIHVzZWQgc2luY2UgdGhpcyBpcyB3aGF0CiAgLy8gYnJvd3NlcnMgcmVwb3J0IGZvciBIVE1MIG5vZGUgbmFtZXMgKHRleHQvaHRtbCkuCiAgaW5jcmVtZW50YWxfZWxlbWVudHM6IG51bGwsCiAgb2theV9mb3JfaW5jcmVtZW50YWw6IGZ1bmN0aW9uIChuYW1lKSB7CiAgICBpZiAoIXRoaXMuaW5jcmVtZW50YWxfZWxlbWVudHMpCiAgICB7CiAgICAgIHZhciBpbmNsaXN0ID0gbmV3IEFycmF5KCk7CiAgICAgIGluY2xpc3RbInAiXSA9IHRydWU7CiAgICAgIGluY2xpc3RbInByZSJdID0gdHJ1ZTsKICAgICAgaW5jbGlzdFsibGkiXSA9IHRydWU7CiAgICAgIGluY2xpc3RbImJsb2NrcXVvdGUiXSA9IHRydWU7CiAgICAgIGluY2xpc3RbImR0Il0gPSB0cnVlOwogICAgICBpbmNsaXN0WyJkZCJdID0gdHJ1ZTsKICAgICAgaW5jbGlzdFsiaDIiXSA9IHRydWU7CiAgICAgIGluY2xpc3RbImgzIl0gPSB0cnVlOwogICAgICBpbmNsaXN0WyJoNCJdID0gdHJ1ZTsKICAgICAgaW5jbGlzdFsiaDUiXSA9IHRydWU7CiAgICAgIGluY2xpc3RbImg2Il0gPSB0cnVlOwogICAgICBpbmNsaXN0WyJzcGFuIl0gPSB0cnVlOwogICAgICBpbmNsaXN0WyJhZGRyZXNzIl0gPSB0cnVlOwogICAgICBpbmNsaXN0WyJ0YWJsZSJdID0gdHJ1ZTsKICAgICAgaW5jbGlzdFsidHIiXSA9IHRydWU7CiAgICAgIGluY2xpc3RbInRoIl0gPSB0cnVlOwogICAgICBpbmNsaXN0WyJ0ZCJdID0gdHJ1ZTsKICAgICAgaW5jbGlzdFsiaW1nIl0gPSB0cnVlOwogICAgICBpbmNsaXN0WyJvYmplY3QiXSA9IHRydWU7CiAgICAgIHRoaXMuaW5jcmVtZW50YWxfZWxlbWVudHMgPSBpbmNsaXN0OwogICAgfQogICAgcmV0dXJuIHRoaXMuaW5jcmVtZW50YWxfZWxlbWVudHNbbmFtZS50b0xvd2VyQ2FzZSgpXTsKICB9LAoKICBuZXh0X2luY3JlbWVudGFsX2l0ZW06IGZ1bmN0aW9uIChub2RlKSB7CiAgICB2YXIgYnIgPSB0aGlzLmlzX3hodG1sID8gImJyIiA6ICJCUiI7CiAgICB2YXIgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwoKICAgIGZvciAoOzspCiAgICB7CiAgICAgIG5vZGUgPSB3M2Nfc2xpZHkubmV4dF9ub2RlKHNsaWRlLCBub2RlKTsKCiAgICAgIGlmIChub2RlID09IG51bGwgfHwgbm9kZS5wYXJlbnROb2RlID09IG51bGwpCiAgICAgICAgYnJlYWs7CgogICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PSAxKSAgLy8gRUxFTUVOVAogICAgICB7CiAgICAgICAgaWYgKG5vZGUubm9kZU5hbWUgPT0gYnIpCiAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgaWYgKHczY19zbGlkeS5oYXNfY2xhc3Mobm9kZSwgImluY3JlbWVudGFsIikKICAgICAgICAgICAgICYmIHczY19zbGlkeS5va2F5X2Zvcl9pbmNyZW1lbnRhbChub2RlLm5vZGVOYW1lKSkKICAgICAgICAgIHJldHVybiBub2RlOwoKICAgICAgICBpZiAodzNjX3NsaWR5Lmhhc19jbGFzcyhub2RlLnBhcmVudE5vZGUsICJpbmNyZW1lbnRhbCIpCiAgICAgICAgICAgICAmJiAhdzNjX3NsaWR5Lmhhc19jbGFzcyhub2RlLCAibm9uLWluY3JlbWVudGFsIikpCiAgICAgICAgICByZXR1cm4gbm9kZTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBub2RlOwogIH0sCgogIHByZXZpb3VzX2luY3JlbWVudGFsX2l0ZW06IGZ1bmN0aW9uIChub2RlKSB7CiAgICB2YXIgYnIgPSB0aGlzLmlzX3hodG1sID8gImJyIiA6ICJCUiI7CiAgICB2YXIgc2xpZGUgPSB3M2Nfc2xpZHkuc2xpZGVzW3czY19zbGlkeS5zbGlkZV9udW1iZXJdOwoKICAgIGZvciAoOzspCiAgICB7CiAgICAgIG5vZGUgPSB3M2Nfc2xpZHkucHJldmlvdXNfbm9kZShzbGlkZSwgbm9kZSk7CgogICAgICBpZiAobm9kZSA9PSBudWxsIHx8IG5vZGUucGFyZW50Tm9kZSA9PSBudWxsKQogICAgICAgIGJyZWFrOwoKICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT0gMSkKICAgICAgewogICAgICAgIGlmIChub2RlLm5vZGVOYW1lID09IGJyKQogICAgICAgICAgY29udGludWU7CgogICAgICAgIGlmICh3M2Nfc2xpZHkuaGFzX2NsYXNzKG5vZGUsICJpbmNyZW1lbnRhbCIpCiAgICAgICAgICAgICAmJiB3M2Nfc2xpZHkub2theV9mb3JfaW5jcmVtZW50YWwobm9kZS5ub2RlTmFtZSkpCiAgICAgICAgICByZXR1cm4gbm9kZTsKCiAgICAgICAgaWYgKHczY19zbGlkeS5oYXNfY2xhc3Mobm9kZS5wYXJlbnROb2RlLCAiaW5jcmVtZW50YWwiKQogICAgICAgICAgICAgJiYgIXczY19zbGlkeS5oYXNfY2xhc3Mobm9kZSwgIm5vbi1pbmNyZW1lbnRhbCIpKQogICAgICAgICAgcmV0dXJuIG5vZGU7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gbm9kZTsKICB9LAoKICAvLyBzZXQgdmlzaWJpbGl0eSBmb3IgYWxsIGVsZW1lbnRzIG9uIGN1cnJlbnQgc2xpZGUgd2l0aAogIC8vIGEgcGFyZW50IGVsZW1lbnQgd2l0aCBhdHRyaWJ1dGUgY2xhc3M9ImluY3JlbWVudGFsIgogIHNldF92aXNpYmlsaXR5X2FsbF9pbmNyZW1lbnRhbDogZnVuY3Rpb24gKHZhbHVlKSB7CiAgICB2YXIgbm9kZSA9IHRoaXMubmV4dF9pbmNyZW1lbnRhbF9pdGVtKG51bGwpOwoKICAgIGlmICh2YWx1ZSA9PSAiaGlkZGVuIikKICAgIHsKICAgICAgd2hpbGUgKG5vZGUpCiAgICAgIHsKICAgICAgICB3M2Nfc2xpZHkuYWRkX2NsYXNzKG5vZGUsICJpbnZpc2libGUiKTsKICAgICAgICBub2RlID0gdzNjX3NsaWR5Lm5leHRfaW5jcmVtZW50YWxfaXRlbShub2RlKTsKICAgICAgfQogICAgfQogICAgZWxzZSAvLyB2YWx1ZSA9PSAidmlzaWJsZSIKICAgIHsKICAgICAgd2hpbGUgKG5vZGUpCiAgICAgIHsKICAgICAgICB3M2Nfc2xpZHkucmVtb3ZlX2NsYXNzKG5vZGUsICJpbnZpc2libGUiKTsKICAgICAgICBub2RlID0gdzNjX3NsaWR5Lm5leHRfaW5jcmVtZW50YWxfaXRlbShub2RlKTsKICAgICAgfQogICAgfQogIH0sCgogIC8vIHJldmVhbCB0aGUgbmV4dCBoaWRkZW4gaXRlbSBvbiB0aGUgc2xpZGUKICAvLyBub2RlIGlzIG51bGwgb3IgdGhlIG5vZGUgdGhhdCB3YXMgbGFzdCByZXZlYWxlZAogIHJldmVhbF9uZXh0X2l0ZW06IGZ1bmN0aW9uIChub2RlKSB7CiAgICBub2RlID0gdzNjX3NsaWR5Lm5leHRfaW5jcmVtZW50YWxfaXRlbShub2RlKTsKCiAgICBpZiAobm9kZSAmJiBub2RlLm5vZGVUeXBlID09IDEpICAvLyBhbiBlbGVtZW50CiAgICAgIHczY19zbGlkeS5yZW1vdmVfY2xhc3Mobm9kZSwgImludmlzaWJsZSIpOwoKICAgIHJldHVybiBub2RlOwogIH0sCgogIC8vIGV4YWN0IGludmVyc2Ugb2YgcmV2ZWFsTmV4dEl0ZW0obm9kZSkKICBoaWRlX3ByZXZpb3VzX2l0ZW06IGZ1bmN0aW9uIChub2RlKSB7CiAgICBpZiAobm9kZSAmJiBub2RlLm5vZGVUeXBlID09IDEpICAvLyBhbiBlbGVtZW50CiAgICAgIHczY19zbGlkeS5hZGRfY2xhc3Mobm9kZSwgImludmlzaWJsZSIpOwoKICAgIHJldHVybiB0aGlzLnByZXZpb3VzX2luY3JlbWVudGFsX2l0ZW0obm9kZSk7CiAgfSwKCiAgLy8gbGVmdCB0byByaWdodCB0cmF2ZXJzYWwgb2Ygcm9vdCdzIGNvbnRlbnQKICBuZXh0X25vZGU6IGZ1bmN0aW9uIChyb290LCBub2RlKSB7CiAgICBpZiAobm9kZSA9PSBudWxsKQogICAgICByZXR1cm4gcm9vdC5maXJzdENoaWxkOwoKICAgIGlmIChub2RlLmZpcnN0Q2hpbGQpCiAgICAgIHJldHVybiBub2RlLmZpcnN0Q2hpbGQ7CgogICAgaWYgKG5vZGUubmV4dFNpYmxpbmcpCiAgICAgIHJldHVybiBub2RlLm5leHRTaWJsaW5nOwoKICAgIGZvciAoOzspCiAgICB7CiAgICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7CgogICAgICBpZiAoIW5vZGUgfHwgbm9kZSA9PSByb290KQogICAgICAgIGJyZWFrOwoKICAgICAgaWYgKG5vZGUgJiYgbm9kZS5uZXh0U2libGluZykKICAgICAgICByZXR1cm4gbm9kZS5uZXh0U2libGluZzsKICAgIH0KCiAgICByZXR1cm4gbnVsbDsKICB9LAoKICAvLyByaWdodCB0byBsZWZ0IHRyYXZlcnNhbCBvZiByb290J3MgY29udGVudAogIHByZXZpb3VzX25vZGU6IGZ1bmN0aW9uIChyb290LCBub2RlKSB7CiAgICBpZiAobm9kZSA9PSBudWxsKQogICAgewogICAgICBub2RlID0gcm9vdC5sYXN0Q2hpbGQ7CgogICAgICBpZiAobm9kZSkKICAgICAgewogICAgICAgIHdoaWxlIChub2RlLmxhc3RDaGlsZCkKICAgICAgICAgIG5vZGUgPSBub2RlLmxhc3RDaGlsZDsKICAgICAgfQoKICAgICAgcmV0dXJuIG5vZGU7CiAgICB9CgogICAgaWYgKG5vZGUucHJldmlvdXNTaWJsaW5nKQogICAgewogICAgICBub2RlID0gbm9kZS5wcmV2aW91c1NpYmxpbmc7CgogICAgICB3aGlsZSAobm9kZS5sYXN0Q2hpbGQpCiAgICAgICAgbm9kZSA9IG5vZGUubGFzdENoaWxkOwoKICAgICAgcmV0dXJuIG5vZGU7CiAgICB9CgogICAgaWYgKG5vZGUucGFyZW50Tm9kZSAhPSByb290KQogICAgICByZXR1cm4gbm9kZS5wYXJlbnROb2RlOwoKICAgIHJldHVybiBudWxsOwogIH0sCgogIHByZXZpb3VzX3NpYmxpbmdfZWxlbWVudDogZnVuY3Rpb24gKGVsKSB7CiAgICBlbCA9IGVsLnByZXZpb3VzU2libGluZzsKCiAgICB3aGlsZSAoZWwgJiYgZWwubm9kZVR5cGUgIT0gMSkKICAgICAgZWwgPSBlbC5wcmV2aW91c1NpYmxpbmc7CgogICAgcmV0dXJuIGVsOwogIH0sCgogIG5leHRfc2libGluZ19lbGVtZW50OiBmdW5jdGlvbiAoZWwpIHsKICAgIGVsID0gZWwubmV4dFNpYmxpbmc7CgogICAgd2hpbGUgKGVsICYmIGVsLm5vZGVUeXBlICE9IDEpCiAgICAgIGVsID0gZWwubmV4dFNpYmxpbmc7CgogICAgcmV0dXJuIGVsOwogIH0sCgogIGZpcnN0X2NoaWxkX2VsZW1lbnQ6IGZ1bmN0aW9uIChlbCkgewogICAgdmFyIG5vZGU7CgogICAgZm9yIChub2RlID0gZWwuZmlyc3RDaGlsZDsgbm9kZTsgbm9kZSA9IG5vZGUubmV4dFNpYmxpbmcpCiAgICB7CiAgICAgIGlmIChub2RlLm5vZGVUeXBlID09IDEpCiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgcmV0dXJuIG5vZGU7CiAgfSwKCiAgZmlyc3RfdGFnOiBmdW5jdGlvbiAoZWxlbWVudCwgdGFnKSB7CiAgICB2YXIgbm9kZTsKCiAgICBpZiAoIXRoaXMuaXNfeGh0bWwpCiAgICAgIHRhZyA9IHRhZy50b1VwcGVyQ2FzZSgpOwoKICAgIGZvciAobm9kZSA9IGVsZW1lbnQuZmlyc3RDaGlsZDsgbm9kZTsgbm9kZSA9IG5vZGUubmV4dFNpYmxpbmcpCiAgICB7CiAgICAgIGlmIChub2RlLm5vZGVUeXBlID09IDEgJiYgbm9kZS5ub2RlTmFtZSA9PSB0YWcpCiAgICAgICAgYnJlYWs7CiAgICB9CgogICAgcmV0dXJuIG5vZGU7CiAgfSwKCiAgaGlkZV9zZWxlY3Rpb246IGZ1bmN0aW9uICgpIHsKICAgIGlmICh3aW5kb3cuZ2V0U2VsZWN0aW9uKSAvLyBGaXJlZm94LCBDaHJvbWl1bSwgU2FmYXJpLCBPcGVyYQogICAgewogICAgICB2YXIgc2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpOwoKICAgICAgaWYgKHNlbGVjdGlvbi5yYW5nZUNvdW50ID4gMCkKICAgICAgewogICAgICAgIHZhciByYW5nZSA9IHNlbGVjdGlvbi5nZXRSYW5nZUF0KDApOwogICAgICAgIHJhbmdlLmNvbGxhcHNlIChmYWxzZSk7CiAgICAgIH0KICAgIH0KICAgIGVsc2UgLy8gSW50ZXJuZXQgRXhwbG9yZXIKICAgIHsKICAgICAgdmFyIHRleHRSYW5nZSA9IGRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSAoKTsKICAgICAgdGV4dFJhbmdlLmNvbGxhcHNlIChmYWxzZSk7CiAgICB9CiAgfSwKCiAgZ2V0X3NlbGVjdGVkX3RleHQ6IGZ1bmN0aW9uICgpIHsKICAgIHRyeQogICAgewogICAgICBpZiAod2luZG93LmdldFNlbGVjdGlvbikKICAgICAgICByZXR1cm4gd2luZG93LmdldFNlbGVjdGlvbigpLnRvU3RyaW5nKCk7CgogICAgICBpZiAoZG9jdW1lbnQuZ2V0U2VsZWN0aW9uKQogICAgICAgIHJldHVybiBkb2N1bWVudC5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpOwoKICAgICAgaWYgKGRvY3VtZW50LnNlbGVjdGlvbikKICAgICAgICByZXR1cm4gZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCkudGV4dDsKICAgIH0KICAgIGNhdGNoIChlKQogICAgewogICAgfQoKICAgIHJldHVybiAiIjsKICB9LAoKICAvLyBtYWtlIG5vdGUgb2YgbGVuZ3RoIG9mIHNlbGVjdGVkIHRleHQKICAvLyBhcyB0aGlzIGV2YWx1YXRlcyB0byB6ZXJvIGluIGNsaWNrIGV2ZW50CiAgbW91c2VfYnV0dG9uX3VwOiBmdW5jdGlvbiAoZSkgewogICAgdzNjX3NsaWR5LnNlbGVjdGVkX3RleHRfbGVuID0gdzNjX3NsaWR5LmdldF9zZWxlY3RlZF90ZXh0KCkubGVuZ3RoOwogIH0sCgogIG1vdXNlX2J1dHRvbl9kb3duOiBmdW5jdGlvbiAoZSkgewogICAgdzNjX3NsaWR5LnNlbGVjdGVkX3RleHRfbGVuID0gdzNjX3NsaWR5LmdldF9zZWxlY3RlZF90ZXh0KCkubGVuZ3RoOwogICAgdzNjX3NsaWR5Lm1vdXNlX3ggPSBlLmNsaWVudFg7CiAgICB3M2Nfc2xpZHkubW91c2VfeSA9IGUuY2xpZW50WTsKICB9LAoKICAvLyByaWdodCBtb3VzZSBidXR0b24gY2xpY2sgaXMgcmVzZXJ2ZWQgZm9yIGNvbnRleHQgbWVudXMKICAvLyBpdCBpcyBtb3JlIHJlbGlhYmxlIHRvIGRldGVjdCByaWdodGNsaWNrIHRoYW4gbGVmdGNsaWNrCiAgbW91c2VfYnV0dG9uX2NsaWNrOiBmdW5jdGlvbiAoZSkgewogICAgaWYgKCFlKQogICAgICB2YXIgZSA9IHdpbmRvdy5ldmVudDsKCiAgICBpZiAoTWF0aC5hYnMoZS5jbGllbnRYIC13M2Nfc2xpZHkubW91c2VfeCkgKwogICAgICAgIE1hdGguYWJzKGUuY2xpZW50WSAtdzNjX3NsaWR5Lm1vdXNlX3kpID4gMTApCiAgICAgIHJldHVybiB0cnVlOwoKICAgIGlmICh3M2Nfc2xpZHkuc2VsZWN0ZWRfdGV4dF9sZW4gPiAwKQogICAgICByZXR1cm4gdHJ1ZTsKCiAgICB2YXIgcmlnaHRjbGljayA9IGZhbHNlOwogICAgdmFyIGxlZnRjbGljayA9IGZhbHNlOwogICAgdmFyIG1pZGRsZWNsaWNrID0gZmFsc2U7CiAgICB2YXIgdGFyZ2V0OwoKICAgIGlmICghZSkKICAgICAgdmFyIGUgPSB3aW5kb3cuZXZlbnQ7CgogICAgaWYgKGUudGFyZ2V0KQogICAgICB0YXJnZXQgPSBlLnRhcmdldDsKICAgIGVsc2UgaWYgKGUuc3JjRWxlbWVudCkKICAgICAgdGFyZ2V0ID0gZS5zcmNFbGVtZW50OwoKICAgIC8vIHdvcmsgYXJvdW5kIFNhZmFyaSBidWcKICAgIGlmICh0YXJnZXQubm9kZVR5cGUgPT0gMykKICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7CgogICAgaWYgKGUud2hpY2gpIC8vIGFsbCBicm93c2VycyBleGNlcHQgSUUKICAgIHsKICAgICAgbGVmdGNsaWNrID0gKGUud2hpY2ggPT0gMSk7CiAgICAgIG1pZGRsZWNsaWNrID0gKGUud2hpY2ggPT0gMik7CiAgICAgIHJpZ2h0Y2xpY2sgPSAoZS53aGljaCA9PSAzKTsKICAgIH0KICAgIGVsc2UgaWYgKGUuYnV0dG9uKQogICAgewogICAgICAvLyBLb25xdWVyb3IgZ2l2ZXMgMSBmb3IgbGVmdCwgNCBmb3IgbWlkZGxlCiAgICAgIC8vIElFNiBnaXZlcyAwIGZvciBsZWZ0IGFuZCBub3QgMSBhcyBJIGV4cGVjdGVkCgogICAgICBpZiAoZS5idXR0b24gPT0gNCkKICAgICAgICBtaWRkbGVjbGljayA9IHRydWU7CgogICAgICAvLyBhbGwgYnJvd3NlcnMgYWdyZWUgb24gMiBmb3IgcmlnaHQgYnV0dG9uCiAgICAgIHJpZ2h0Y2xpY2sgPSAoZS5idXR0b24gPT0gMik7CiAgICB9CiAgICBlbHNlCiAgICAgIGxlZnRjbGljayA9IHRydWU7CgogICAgaWYgKHczY19zbGlkeS5zZWxlY3RlZF90ZXh0X2xlbiA+IDApCiAgICB7CiAgICAgIHczY19zbGlkeS5zdG9wX3Byb3BhZ2F0aW9uKGUpOwogICAgICBlLmNhbmNlbCA9IHRydWU7CiAgICAgIGUucmV0dXJuVmFsdWUgPSBmYWxzZTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQoKICAgIC8vIGRpc21pc3MgdGFibGUgb2YgY29udGVudHMKICAgIHczY19zbGlkeS5oaWRlX3RhYmxlX29mX2NvbnRlbnRzKGZhbHNlKTsKCiAgICAvLyBjaGVjayBpZiB0YXJnZXQgaXMgc29tZXRoaW5nIHRoYXQgcHJvYmFibHkgd2FudCdzIGNsaWNrcwogICAgLy8gZS5nLiBhLCBlbWJlZCwgb2JqZWN0LCBpbnB1dCwgdGV4dGFyZWEsIHNlbGVjdCwgb3B0aW9uCiAgICB2YXIgdGFnID0gdGFyZ2V0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7CgogICAgaWYgKHczY19zbGlkeS5tb3VzZV9jbGlja19lbmFibGVkICYmIGxlZnRjbGljayAmJgogICAgICAgICF3M2Nfc2xpZHkuc3BlY2lhbF9lbGVtZW50KHRhcmdldCkgJiYKICAgICAgICAhdGFyZ2V0Lm9uY2xpY2spCiAgICB7CiAgICAgIHczY19zbGlkeS5uZXh0X3NsaWRlKHRydWUpOwogICAgICB3M2Nfc2xpZHkuc3RvcF9wcm9wYWdhdGlvbihlKTsKICAgICAgZS5jYW5jZWwgPSB0cnVlOwogICAgICBlLnJldHVyblZhbHVlID0gZmFsc2U7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9LAoKICBzcGVjaWFsX2VsZW1lbnQ6IGZ1bmN0aW9uIChlbGVtZW50KSB7CiAgICBpZiAodGhpcy5oYXNfY2xhc3MoZWxlbWVudCwgIm5vbi1pbnRlcmFjdGl2ZSIpKQogICAgICByZXR1cm4gZmFsc2U7CgogICAgdmFyIHRhZyA9IGVsZW1lbnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKCiAgICByZXR1cm4gZWxlbWVudC5vbmtleWRvd24gfHwKICAgICAgZWxlbWVudC5vbmNsaWNrIHx8CiAgICAgIHRhZyA9PSAiYSIgfHwKICAgICAgdGFnID09ICJlbWJlZCIgfHwKICAgICAgdGFnID09ICJvYmplY3QiIHx8CiAgICAgIHRhZyA9PSAidmlkZW8iIHx8CiAgICAgIHRhZyA9PSAiYXVkaW8iIHx8CiAgICAgIHRhZyA9PSAic3ZnIiB8fAogICAgICB0YWcgPT0gImNhbnZhcyIgfHwKICAgICAgdGFnID09ICJpbnB1dCIgfHwKICAgICAgdGFnID09ICJ0ZXh0YXJlYSIgfHwKICAgICAgdGFnID09ICJzZWxlY3QiIHx8CiAgICAgIHRhZyA9PSAib3B0aW9uIjsKICB9LAoKICBzbGlkeV9jaHJvbWU6IGZ1bmN0aW9uIChlbCkgewogICAgd2hpbGUgKGVsKQogICAgewogICAgICBpZiAoZWwgPT0gdzNjX3NsaWR5LnRvYyB8fAogICAgICAgICAgZWwgPT0gdzNjX3NsaWR5LnRvb2xiYXIgfHwKICAgICAgICAgIHczY19zbGlkeS5oYXNfY2xhc3MoZWwsICJvdXRsaW5lIikpCiAgICAgICAgcmV0dXJuIHRydWU7CgogICAgICBlbCA9IGVsLnBhcmVudE5vZGU7CiAgICB9CgogICAgcmV0dXJuIGZhbHNlOwogIH0sCgogIGdldF9rZXk6IGZ1bmN0aW9uIChlKQogIHsKICAgIHZhciBrZXk7CgogICAgLy8ga2x1ZGdlIGFyb3VuZCBOUy9JRSBkaWZmZXJlbmNlcyAKICAgIGlmICh0eXBlb2Ygd2luZG93LmV2ZW50ICE9ICJ1bmRlZmluZWQiKQogICAgICBrZXkgPSB3aW5kb3cuZXZlbnQua2V5Q29kZTsKICAgIGVsc2UgaWYgKGUud2hpY2gpCiAgICAgIGtleSA9IGUud2hpY2g7CgogICAgcmV0dXJuIGtleTsKICB9LAoKICBnZXRfdGFyZ2V0OiBmdW5jdGlvbiAoZSkgewogICAgdmFyIHRhcmdldDsKCiAgICBpZiAoIWUpCiAgICAgIGUgPSB3aW5kb3cuZXZlbnQ7CgogICAgaWYgKGUudGFyZ2V0KQogICAgICB0YXJnZXQgPSBlLnRhcmdldDsKICAgIGVsc2UgaWYgKGUuc3JjRWxlbWVudCkKICAgICAgdGFyZ2V0ID0gZS5zcmNFbGVtZW50OwoKICAgIGlmICh0YXJnZXQubm9kZVR5cGUgIT0gMSkKICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7CgogICAgcmV0dXJuIHRhcmdldDsKICB9LAoKICAvLyBkb2VzIGRpc3BsYXkgcHJvcGVydHkgcHJvdmlkZSBjb3JyZWN0IGRlZmF1bHRzPwogIGlzX2Jsb2NrOiBmdW5jdGlvbiAoZWxlbSkgewogICAgdmFyIHRhZyA9IGVsZW0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKCiAgICByZXR1cm4gdGFnID09ICJvbCIgfHwgdGFnID09ICJ1bCIgfHwgdGFnID09ICJwIiB8fCB0YWcgPT0gImRsIiB8fAogICAgICAgICAgIHRhZyA9PSAibGkiIHx8IHRhZyA9PSAidGFibGUiIHx8IHRhZyA9PSAicHJlIiB8fAogICAgICAgICAgIHRhZyA9PSAiaDEiIHx8IHRhZyA9PSAiaDIiIHx8IHRhZyA9PSAiaDMiIHx8CiAgICAgICAgICAgdGFnID09ICJoNCIgfHwgdGFnID09ICJoNSIgfHwgdGFnID09ICJoNiIgfHwKICAgICAgICAgICB0YWcgPT0gImJsb2NrcXVvdGUiIHx8IHRhZyA9PSAiYWRkcmVzcyI7IAogIH0sCgogIGFkZF9saXN0ZW5lcjogZnVuY3Rpb24gKGVsZW1lbnQsIGV2ZW50LCBoYW5kbGVyKSB7CiAgICBpZiAod2luZG93LmFkZEV2ZW50TGlzdGVuZXIpCiAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihldmVudCwgaGFuZGxlciwgZmFsc2UpOwogICAgZWxzZQogICAgICBlbGVtZW50LmF0dGFjaEV2ZW50KCJvbiIrZXZlbnQsIGhhbmRsZXIpOwogIH0sCgogIC8vIHVzZWQgdG8gcHJldmVudCBldmVudCBwcm9wYWdhdGlvbiBmcm9tIGZpZWxkIGNvbnRyb2xzCiAgc3RvcF9wcm9wYWdhdGlvbjogZnVuY3Rpb24gKGV2ZW50KSB7CiAgICBldmVudCA9IGV2ZW50ID8gZXZlbnQgOiB3aW5kb3cuZXZlbnQ7CiAgICBldmVudC5jYW5jZWxCdWJibGUgPSB0cnVlOyAgLy8gZm9yIElFCgogICAgaWYgKGV2ZW50LnN0b3BQcm9wYWdhdGlvbikKICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CgogICAgcmV0dXJuIHRydWU7CiAgfSwKCiAgY2FuY2VsOiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgIGlmIChldmVudCkKICAgIHsKICAgICAgIGV2ZW50LmNhbmNlbCA9IHRydWU7CiAgICAgICBldmVudC5yZXR1cm5WYWx1ZSA9IGZhbHNlOwoKICAgICAgaWYgKGV2ZW50LnByZXZlbnREZWZhdWx0KQogICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7CiAgICB9CgogICAgdzNjX3NsaWR5LmtleV93YW50ZWQgPSBmYWxzZTsKICAgIHJldHVybiBmYWxzZTsKICB9LAoKLy8gZm9yIGVhY2ggbGFuZ3VhZ2UgZGVmaW5lIGFuIGFzc29jaWF0aXZlIGFycmF5Ci8vIGFuZCBhbHNvIHRoZSBoZWxwIHRleHQgd2hpY2ggaXMgbG9uZ2VyCgogIHN0cmluZ3NfZXM6IHsKICAgICJzbGlkZSI6InDDoWcuIiwKICAgICJoZWxwPyI6IkF5dWRhIiwKICAgICJjb250ZW50cz8iOiLDjW5kaWNlIiwKICAgICJ0YWJsZSBvZiBjb250ZW50cyI6InRhYmxhIGRlIGNvbnRlbmlkb3MiLAogICAgIlRhYmxlIG9mIENvbnRlbnRzIjoiVGFibGEgZGUgQ29udGVuaWRvcyIsCiAgICAicmVzdGFydCBwcmVzZW50YXRpb24iOiJSZWluaWNpYXIgcHJlc2VudGFjacOzbiIsCiAgICAicmVzdGFydD8iOiJJbmljaW8iCiAgfSwKICBoZWxwX2VzOgogICAgIlV0aWxpY2UgZWwgcmF0w7NuLCBiYXJyYSBlc3BhY2lhZG9yYSwgdGVjbGFzIEl6ZGEvRGNoYSwgIiArCiAgICAibyBSZSBww6FnIHkgQXYgcMOhZy4gVXNlIFMgeSBCIHBhcmEgY2FtYmlhciBlbCB0YW1hw7FvIGRlIGZ1ZW50ZS4iLAoKICBzdHJpbmdzX2NhOiB7CiAgICAic2xpZGUiOiJww6BnLi4iLAogICAgImhlbHA/IjoiQWp1ZGEiLAogICAgImNvbnRlbnRzPyI6IsONbmRleCIsCiAgICAidGFibGUgb2YgY29udGVudHMiOiJ0YXVsYSBkZSBjb250aW5ndXRzIiwKICAgICJUYWJsZSBvZiBDb250ZW50cyI6IlRhdWxhIGRlIENvbnRpbmd1dHMiLAogICAgInJlc3RhcnQgcHJlc2VudGF0aW9uIjoiUmVpbmljaWFyIHByZXNlbnRhY2nDsyIsCiAgICAicmVzdGFydD8iOiJJbmljaSIKICB9LAogIGhlbHBfY2E6CiAgICAiVXRpbGl0emkgZWwgcmF0b2zDrSwgYmFycmEgZXNwYWlhZG9yYSwgdGVjbGVzIEVzcS4vRHRhLiAiICsKICAgICJvIFJlIHDDoGcgeSBBdiBww6BnLiBVc2kgUyBpIEIgcGVyIGNhbnZpYXIgZ3JhbmTDoHJpYSBkZSBmb250LiIsCgogIHN0cmluZ3NfY3M6IHsKICAgICJzbGlkZSI6InNuw61tZWsiLAogICAgImhlbHA/IjoibsOhcG92xJtkYSIsCiAgICAiY29udGVudHM/Ijoib2JzYWgiLAogICAgInRhYmxlIG9mIGNvbnRlbnRzIjoib2JzYWggcHJlemVudGFjZSIsCiAgICAiVGFibGUgb2YgQ29udGVudHMiOiJPYnNhaCBwcmV6ZW50YWNlIiwKICAgICJyZXN0YXJ0IHByZXNlbnRhdGlvbiI6Inpub3Z1IHNwdXN0aXQgcHJlemVudGFjaSIsCiAgICAicmVzdGFydD8iOiJyZXN0YXJ0IgogIH0sCiAgaGVscF9jczoKICAgICJQcmV6ZW50YWNpIG3Fr8W+ZXRlIHByb2Now6F6ZXQgcG9tb2PDrSBrbGlrbnV0w60gbXnFoWksIG1lemVybsOta3UsICIgKwogICAgIsWhaXBlayB2bGV2byBhIHZwcmF2byBuZWJvIGtsw6F2ZXMgUGFnZVVwIGEgUGFnZURvd24uIFDDrXNtbyBzZSAiICsKICAgICJkw6EgenbEm3TFoWl0IGEgem1lbsWhaXQgcG9tb2PDrSBrbMOhdmVzIEIgYSBTLiIsCgogIHN0cmluZ3Nfbmw6IHsKICAgICJzbGlkZSI6InBhZ2luYSIsCiAgICAiaGVscD8iOiJIZWxwPyIsCiAgICAiY29udGVudHM/IjoiSW5ob3VkPyIsCiAgICAidGFibGUgb2YgY29udGVudHMiOiJpbmhvdWRzb3BnYXZlIiwKICAgICJUYWJsZSBvZiBDb250ZW50cyI6IkluaG91ZHNvcGdhdmUiLAogICAgInJlc3RhcnQgcHJlc2VudGF0aW9uIjoiaGVyc3RhcnQgcHJlc2VudGF0aWUiLAogICAgInJlc3RhcnQ/IjoiSGVyc3RhcnQ/IgogIH0sCiAgaGVscF9ubDoKICAgICAiTmF2aWdlZXIgZC5tLnYuIGhldCBtdWlzLCBzcGF0aWViYXIsIExpbmtzL1JlY2h0cyB0b2V0c2VuLCAiICsKICAgICAib2YgUGdVcCBlbiBQZ0RuLiBHZWJydWlrIFMgZW4gQiBvbSBkZSBrYXJha3Rlcmdyb290dGUgdGUgdmVyYW5kZXJlbi4iLAoKICBzdHJpbmdzX2RlOiB7CiAgICAic2xpZGUiOiJTZWl0ZSIsCiAgICAiaGVscD8iOiJIaWxmZSIsCiAgICAiY29udGVudHM/Ijoiw5xiZXJzaWNodCIsCiAgICAidGFibGUgb2YgY29udGVudHMiOiJJbmhhbHRzdmVyemVpY2huaXMiLAogICAgIlRhYmxlIG9mIENvbnRlbnRzIjoiSW5oYWx0c3ZlcnplaWNobmlzIiwKICAgICJyZXN0YXJ0IHByZXNlbnRhdGlvbiI6IlByw6RzZW50YXRpb24gbmV1IHN0YXJ0ZW4iLAogICAgInJlc3RhcnQ/IjoiTmV1c3RhcnQiCiAgfSwKICBoZWxwX2RlOgogICAgIkJlbnV0emVuIFNpZSBkaWUgTWF1cywgTGVlcnNjaGxhZywgZGllIEN1cnNvcnRhc3RlbiBsaW5rcy9yZWNodHMgb2RlciAiICsKICAgICJQYWdlIHVwL1BhZ2UgRG93biB6dW0gV2VjaHNlbG4gZGVyIFNlaXRlbiB1bmQgUyB1bmQgQiBmw7xyIGRpZSBTY2hyaWZ0Z3LDtnNzZS4iLAoKICBzdHJpbmdzX3BsOiB7CiAgICAic2xpZGUiOiJzbGFqZCIsCiAgICAiaGVscD8iOiJwb21vYz8iLAogICAgImNvbnRlbnRzPyI6InNwaXMgdHJlxZtjaT8iLAogICAgInRhYmxlIG9mIGNvbnRlbnRzIjoic3BpcyB0cmXFm2NpIiwKICAgICJUYWJsZSBvZiBDb250ZW50cyI6IlNwaXMgVHJlxZtjaSIsCiAgICAicmVzdGFydCBwcmVzZW50YXRpb24iOiJSZXN0YXJ0dWogcHJlemVudGFjasSZIiwKICAgICJyZXN0YXJ0PyI6InJlc3RhcnQ/IgogIH0sCiAgaGVscF9wbDoKICAgICJabWllbmlhaiBzbGFqZHkga2xpa2FqxIVjIG15c3rEhSwgbmFjaXNrYWrEhWMgc3BhY2rEmSwgc3RyemHFgmtpIGxld28vcHJhd28iICsKICAgICJsdWIgUGdVcCAvIFBnRG4uIFXFvHlqIGtsYXdpc3p5IFMgaSBCLCBhYnkgem1pZW5pxIcgcm96bWlhciBjemN6aW9ua2kuIiwKCiAgc3RyaW5nc19mcjogewogICAgInNsaWRlIjoicGFnZSIsCiAgICAiaGVscD8iOiJBaWRlIiwKICAgICJjb250ZW50cz8iOiJJbmRleCIsCiAgICAidGFibGUgb2YgY29udGVudHMiOiJ0YWJsZSBkZXMgbWF0acOocmVzIiwKICAgICJUYWJsZSBvZiBDb250ZW50cyI6IlRhYmxlIGRlcyBtYXRpw6hyZXMiLAogICAgInJlc3RhcnQgcHJlc2VudGF0aW9uIjoiUmVjb21tZW5jZXIgbCdleHBvc8OpIiwKICAgICJyZXN0YXJ0PyI6IkTDqWJ1dCIKICB9LAogIGhlbHBfZnI6CiAgICAiTmF2aWd1ZXogYXZlYyBsYSBzb3VyaXMsIGxhIGJhcnJlIGQnZXNwYWNlLCBsZXMgZmzDqGNoZXMgIiArCiAgICAiZ2F1Y2hlL2Ryb2l0ZSBvdSBsZXMgdG91Y2hlcyBQZyBVcCwgUGcgRG4uIFV0aWxpc2V6ICIgKwogICAgImxlcyB0b3VjaGVzIFMgZXQgQiBwb3VyIG1vZGlmaWVyIGxhIHRhaWxsZSBkZSBsYSBwb2xpY2UuIiwKCiAgc3RyaW5nc19odTogewogICAgInNsaWRlIjoib2xkYWwiLAogICAgImhlbHA/Ijoic2Vnw610c8OpZyIsCiAgICAiY29udGVudHM/IjoidGFydGFsb20iLAogICAgInRhYmxlIG9mIGNvbnRlbnRzIjoidGFydGFsb21qZWd5esOpayIsCiAgICAiVGFibGUgb2YgQ29udGVudHMiOiJUYXJ0YWxvbWplZ3l6w6lrIiwKICAgICJyZXN0YXJ0IHByZXNlbnRhdGlvbiI6ImJlbXV0YXTDsyDDumpyYWluZMOtdMOhc2EiLAogICAgInJlc3RhcnQ/Ijoiw7pqcmFpbmTDrXTDoXMiCiAgfSwKICBoZWxwX2h1OgogICAgIkF6IG9sZGFsYWsga8O2enRpIGzDqXBrZWTDqXNoZXoga2F0dGludHNvbiBheiBlZ8OpcnJlbCwgdmFneSAiICsKICAgICJoYXN6bsOhbGphIGEgc3rDs2vDtnosIGEgYmFsLCB2YWd5IGEgam9iYiBuecOtbCwgaWxsZXR2ZSBhIFBhZ2UgRG93biwgIiArCiAgICAiUGFnZSBVcCBiaWxsZW50ecWxa2V0LiBBeiBTIMOpcyBhIEIgYmlsbGVudHnFsWtrZWwgdsOhbHRvenRhdGhhdGphICIgKwogICAgImEgc3rDtnZlZyBtw6lyZXTDqXQuIiwKCiAgc3RyaW5nc19pdDogewogICAgInNsaWRlIjoicGFnLiIsCiAgICAiaGVscD8iOiJBaXV0byIsCiAgICAiY29udGVudHM/IjoiSW5kaWNlIiwKICAgICJ0YWJsZSBvZiBjb250ZW50cyI6ImluZGljZSIsCiAgICAiVGFibGUgb2YgQ29udGVudHMiOiJJbmRpY2UiLAogICAgInJlc3RhcnQgcHJlc2VudGF0aW9uIjoiUmljb21pbmNpYXJlIGxhIHByZXNlbnRhemlvbmUiLAogICAgInJlc3RhcnQ/IjoiSW5pemlvIgogIH0sCiAgaGVscF9pdDoKICAgICJOYXZpZ2FyZSBjb24gbW91c2UsIGJhcnJhIHNwYXppbywgZnJlY2NlIHNpbmlzdHJhL2Rlc3RyYSBvICIgKwogICAgIlBnVXAgZSBQZ0RuLiBVc2FyZSBTIGUgQiBwZXIgY2FtYmlhcmUgbGEgZGltZW5zaW9uZSBkZWkgY2FyYXR0ZXJpLiIsCgogIHN0cmluZ3NfZWw6IHsKICAgICJzbGlkZSI6Is+DzrXOu86vzrTOsSIsCiAgICAiaGVscD8iOiLOss6/zq7OuM61zrnOsTsiLAogICAgImNvbnRlbnRzPyI6Is+AzrXPgc65zrXPh8+MzrzOtc69zrE7IiwKICAgICJ0YWJsZSBvZiBjb250ZW50cyI6Is+Azq/Ovc6xzrrOsc+CIM+AzrXPgc65zrXPh86/zrzOrc69z4nOvSIsCiAgICAiVGFibGUgb2YgQ29udGVudHMiOiLOoM6vzr3Osc66zrHPgiDOoM61z4HOuc61z4fOv868zq3Ovc+Jzr0iLAogICAgInJlc3RhcnQgcHJlc2VudGF0aW9uIjoizrXPgM6xzr3Otc66zrrOr869zrfPg863IM+AzrHPgc6/z4XPg86vzrHPg863z4IiLAogICAgInJlc3RhcnQ/IjoizrXPgM6xzr3Otc66zrrOr869zrfPg863OyIKICB9LAogIGhlbHBfZWw6CiAgICAizqDOu86/zrfOs863zrjOtc6vz4TOtSDOvM61IM+Ezr8gzrrOu86vzrogz4TOv8+FIM+Azr/Ovc+EzrnOus65zr/PjSwgz4TOvyBzcGFjZSwgz4TOsSDOss6tzrvOtyDOsc+BzrnPg8+EzrXPgc6sL860zrXOvs65zqwsICIgKwogICAgIs6uIFBhZ2UgVXAgzrrOsc65IFBhZ2UgRG93bi4gzqfPgc63z4POuc68zr/PgM6/zrnOrs+Dz4TOtSDPhM6xIM+AzrvOrs66z4TPgc6xIFMgzrrOsc65IEIgzrPOuc6xIM69zrEgzrHOu867zqzOvs61z4TOtSAiICsKICAgICLPhM6/IM68zq3Os861zrjOv8+CIM+EzrfPgiDOs8+BzrHOvM68zrHPhM6/z4POtc65z4HOrM+CLiIsCgogIHN0cmluZ3NfamE6IHsKICAgICJzbGlkZSI6IuOCueODqeOCpOODiSIsCiAgICAiaGVscD8iOiLjg5jjg6vjg5ciLAogICAgImNvbnRlbnRzPyI6IuebruasoSIsCiAgICAidGFibGUgb2YgY29udGVudHMiOiLnm67mrKHjgpLooajnpLoiLAogICAgIlRhYmxlIG9mIENvbnRlbnRzIjoi55uu5qyhIiwKICAgICJyZXN0YXJ0IHByZXNlbnRhdGlvbiI6IuacgOWIneOBi+OCieWGjeeUnyIsCiAgICAicmVzdGFydD8iOiLmnIDliJ3jgYvjgokiCiAgfSwKICBoZWxwX2phOgogICAgICLjg57jgqbjgrnlt6bjgq/jg6rjg4Pjgq8g44O7IOOCueODmuODvOOCuSDjg7sg5bem5Y+z44Kt44O8ICIgKwogICAgICLjgb7jgZ/jga8gUGFnZSBVcCDjg7sgUGFnZSBEb3du44Gn5pON5L2c77yMIFMg44O7IELjgafjg5Xjgqnjg7Pjg4jjgrXjgqTjgrrlpInmm7QiLAoKICBzdHJpbmdzX3poOiB7CiAgICAic2xpZGUiOiLlubvnga/niYciLAogICAgImhlbHA/Ijoi5biu5YqpPyIsCiAgICAiY29udGVudHM/Ijoi5YaF5a65PyIsCiAgICAidGFibGUgb2YgY29udGVudHMiOiLnm67lvZUiLAogICAgIlRhYmxlIG9mIENvbnRlbnRzIjoi55uu5b2VIiwKICAgICJyZXN0YXJ0IHByZXNlbnRhdGlvbiI6IumHjeaWsOWQr+WKqOWxleekuiIsCiAgICAicmVzdGFydD8iOiLph43mlrDlkK/liqg/IgogIH0sCiAgaGVscF96aDoKICAgICLnlKjpvKDmoIfngrnlh7ssIOepuuagvOadoSwg5bem5Y+z566t5aS0LCBQZyBVcCDlkowgUGcgRG4g5a+86IiqLiAiICsKICAgICLnlKggUywgQiDmlLnlj5jlrZfkvZPlpKflsI8uIiwKCiAgc3RyaW5nc19ydTogewogICAgInNsaWRlIjoi0YHQu9Cw0LnQtCIsCiAgICAiaGVscD8iOiLQv9C+0LzQvtGJ0Yw/IiwKICAgICJjb250ZW50cz8iOiLRgdC+0LTQtdGA0LbQsNC90LjQtT8iLAogICAgInRhYmxlIG9mIGNvbnRlbnRzIjoi0L7Qs9C70LDQstC70LXQvdC40LUiLAogICAgIlRhYmxlIG9mIENvbnRlbnRzIjoi0J7Qs9C70LDQstC70LXQvdC40LUiLAogICAgInJlc3RhcnQgcHJlc2VudGF0aW9uIjoi0L/QtdGA0LXQt9Cw0L/Rg9GB0YLQuNGC0Ywg0L/RgNC10LfQtdC90YLQsNGG0LjRjiIsCiAgICAicmVzdGFydD8iOiLQv9C10YDQtdC30LDQv9GD0YHQuj8iCiAgfSwKICBoZWxwX3J1OgogICAgItCf0LXRgNC10LzQtdGJ0LDQudGC0LXRgdGMINC60LvQuNC60LDRjyDQvNGL0YjQutC+0LksINC40YHQv9C+0LvRjNC30YPRjyDQutC70LDQstC40YjRgyDQv9GA0L7QsdC10LssINGB0YLRgNC10LvQutC4IiArCiAgICAi0LLQu9C10LLQvi/QstC/0YDQsNCy0L4g0LjQu9C4IFBnIFVwINC4IFBnIERuLiDQmtC70LDQstC40YjQuCBTINC4IEIg0LzQtdC90Y/RjtGCINGA0LDQt9C80LXRgCDRiNGA0LjRhNGC0LAuIiwKCiAgc3RyaW5nc19zdjogewogICAgInNsaWRlIjoic2lkYSIsCiAgICAiaGVscD8iOiJoasOkbHAiLAogICAgImNvbnRlbnRzPyI6ImlubmVow6VsbCIsCiAgICAidGFibGUgb2YgY29udGVudHMiOiJpbm5laMOlbGxzZsO2cnRlY2tuaW5nIiwKICAgICJUYWJsZSBvZiBDb250ZW50cyI6IklubmVow6VsbHNmw7ZydGVja25pbmciLAogICAgInJlc3RhcnQgcHJlc2VudGF0aW9uIjoidmlzYSBwcmVzZW50YXRpb25lbiBmcsOlbiBiw7ZyamFuIiwKICAgICJyZXN0YXJ0PyI6ImLDtnJqYSBvbSIKICB9LAogIGhlbHBfc3Y6CiAgICAiQmzDpGRkcmEgbWVkIGV0dCBrbGljayBtZWQgdsOkbnN0cmEgbXVza25hcHBlbiwgbWVsbGFuc2xhZ3N0YW5nZW50ZW4sICIgKwogICAgInbDpG5zdGVyLSBvY2ggaMO2Z2VycGlsdGFuZ2VudGVybmEgZWxsZXIgdGFuZ2VudGVybmEgUGcgVXAsIFBnIERuLiAiICsKICAgICJBbnbDpG5kIHRhbmdlbnRlcm5hIFMgb2NoIEIgZsO2ciBhdHQgw6RuZHJhIHRleHRlbnMgc3Rvcmxlay4iLAoKICBzdHJpbmdzOiB7IH0sCgogIGxvY2FsaXplOiBmdW5jdGlvbiAoc3JjKSB7CiAgICBpZiAoc3JjID09ICIiKQogICAgICByZXR1cm4gc3JjOwoKICAgICAvLyB0cnkgZnVsbCBsYW5ndWFnZSBjb2RlLCBlLmcuIGVuLVVTCiAgICAgdmFyIHMsIGxvb2t1cCA9IHczY19zbGlkeS5zdHJpbmdzW3czY19zbGlkeS5sYW5nXTsKCiAgICAgaWYgKGxvb2t1cCkKICAgICB7CiAgICAgICBzID0gbG9va3VwW3NyY107CgogICAgICAgaWYgKHMpCiAgICAgICAgcmV0dXJuIHM7CiAgICAgfQoKICAgICAvLyBzdHJpcCBjb3VudHJ5IGNvZGUgc3VmZml4LCBlLmcuCiAgICAgLy8gdHJ5IGVuIGlmIHVuZGVmaW5lZCBmb3IgZW4tVVMKICAgICB2YXIgbGcgPSB3M2Nfc2xpZHkubGFuZy5zcGxpdCgiLSIpOwoKICAgICBpZiAobGcubGVuZ3RoID4gMSkKICAgICB7CiAgICAgICBsb29rdXAgPSB3M2Nfc2xpZHkuc3RyaW5nc1tsZ1swXV07CgogICAgICAgaWYgKGxvb2t1cCkKICAgICAgIHsKICAgICAgICAgcyA9IGxvb2t1cFtzcmNdOwoKICAgICAgICAgaWYgKHMpCiAgICAgICAgICByZXR1cm4gczsKICAgICAgIH0KICAgICB9CgogICAgIC8vIG90aGVyd2lzZSBzdHJpbmcgYXMgaXMKICAgICByZXR1cm4gc3JjOwogIH0sCgogIGluaXRfbG9jYWxpemF0aW9uOiBmdW5jdGlvbiAoKSB7CiAgICB2YXIgaTE4biA9IHczY19zbGlkeTsKICAgIHZhciBoZWxwX3RleHQgPSB3M2Nfc2xpZHkuaGVscF90ZXh0OwoKICAgIC8vIGVhY2ggc3VjaCBsYW5ndWFnZSBhcnJheSBpcyBkZWNsYXJlZCBpbiB0aGUgbG9jYWxpemUgYXJyYXkKICAgIC8vIHRoaXMgaXMgdXNlZCBhcyBpbiAgdzNjX3NsaWR5LmxvY2FsaXplKCJmb28iKTsKICAgIHRoaXMuc3RyaW5ncyA9IHsKICAgICAgImVzIjp0aGlzLnN0cmluZ3NfZXMsCiAgICAgICJjYSI6dGhpcy5zdHJpbmdzX2NhLAogICAgICAiY3MiOnRoaXMuc3RyaW5nc19jcywKICAgICAgIm5sIjp0aGlzLnN0cmluZ3NfbmwsCiAgICAgICJkZSI6dGhpcy5zdHJpbmdzX2RlLAogICAgICAicGwiOnRoaXMuc3RyaW5nc19wbCwKICAgICAgImZyIjp0aGlzLnN0cmluZ3NfZnIsCiAgICAgICJodSI6dGhpcy5zdHJpbmdzX2h1LAogICAgICAiaXQiOnRoaXMuc3RyaW5nc19pdCwKICAgICAgImVsIjp0aGlzLnN0cmluZ3NfZWwsCiAgICAgICJqcCI6dGhpcy5zdHJpbmdzX2phLAogICAgICAiemgiOnRoaXMuc3RyaW5nc196aCwKICAgICAgInJ1Ijp0aGlzLnN0cmluZ3NfcnUsCiAgICAgICJzdiI6dGhpcy5zdHJpbmdzX3N2CiAgICB9LAoKICAgIGkxOG4uc3RyaW5nc19lc1toZWxwX3RleHRdID0gaTE4bi5oZWxwX2VzOwogICAgaTE4bi5zdHJpbmdzX2NhW2hlbHBfdGV4dF0gPSBpMThuLmhlbHBfY2E7CiAgICBpMThuLnN0cmluZ3NfY3NbaGVscF90ZXh0XSA9IGkxOG4uaGVscF9jczsKICAgIGkxOG4uc3RyaW5nc19ubFtoZWxwX3RleHRdID0gaTE4bi5oZWxwX25sOwogICAgaTE4bi5zdHJpbmdzX2RlW2hlbHBfdGV4dF0gPSBpMThuLmhlbHBfZGU7CiAgICBpMThuLnN0cmluZ3NfcGxbaGVscF90ZXh0XSA9IGkxOG4uaGVscF9wbDsKICAgIGkxOG4uc3RyaW5nc19mcltoZWxwX3RleHRdID0gaTE4bi5oZWxwX2ZyOwogICAgaTE4bi5zdHJpbmdzX2h1W2hlbHBfdGV4dF0gPSBpMThuLmhlbHBfaHU7CiAgICBpMThuLnN0cmluZ3NfaXRbaGVscF90ZXh0XSA9IGkxOG4uaGVscF9pdDsKICAgIGkxOG4uc3RyaW5nc19lbFtoZWxwX3RleHRdID0gaTE4bi5oZWxwX2VsOwogICAgaTE4bi5zdHJpbmdzX2phW2hlbHBfdGV4dF0gPSBpMThuLmhlbHBfamE7CiAgICBpMThuLnN0cmluZ3NfemhbaGVscF90ZXh0XSA9IGkxOG4uaGVscF96aDsKICAgIGkxOG4uc3RyaW5nc19ydVtoZWxwX3RleHRdID0gaTE4bi5oZWxwX3J1OwogICAgaTE4bi5zdHJpbmdzX3N2W2hlbHBfdGV4dF0gPSBpMThuLmhlbHBfc3Y7CgogICAgdzNjX3NsaWR5LmxhbmcgPSBkb2N1bWVudC5ib2R5LnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCJsYW5nIik7CgogICAgaWYgKCF3M2Nfc2xpZHkubGFuZykKICAgICAgdzNjX3NsaWR5LmxhbmcgPSBkb2N1bWVudC5ib2R5LnBhcmVudE5vZGUuZ2V0QXR0cmlidXRlKCJ4bWw6bGFuZyIpOwoKICAgIGlmICghdzNjX3NsaWR5LmxhbmcpCiAgICAgIHczY19zbGlkeS5sYW5nID0gImVuIjsKICB9Cn07CgovLyBoYWNrIGZvciBiYWNrIGJ1dHRvbiBiZWhhdmlvcgppZiAodzNjX3NsaWR5LmllNiB8fCB3M2Nfc2xpZHkuaWU3KQp7CiAgZG9jdW1lbnQud3JpdGUoIjxpZnJhbWUgaWQ9J2hpc3RvcnlGcmFtZScgIiArCiAgInNyYz0namF2YXNjcmlwdDpcIjxodG1sIisiPjwvIisiaHRtbD5cIicgIiArCiAgImhlaWdodD0nMScgd2lkdGg9JzEnICIgKwogICJzdHlsZT0ncG9zaXRpb246YWJzb2x1dGU7bGVmdDotODAwcHgnPjwvaWZyYW1lPiIpOwp9CgovLyBhdHRhY2ggZXZlbnQgbGlzdGVuZXJzIGZvciBpbml0aWFsaXphdGlvbgp3M2Nfc2xpZHkuc2V0X3VwKCk7CgovLyBoaWRlIHRoZSBzbGlkZXMgYXMgc29vbiBhcyBib2R5IGVsZW1lbnQgaXMgYXZhaWxhYmxlCi8vIHRvIHJlZHVjZSBhbm5veWluZyBzY3JlZW4gbWVzcyBiZWZvcmUgdGhlIG9ubG9hZCBldmVudApzZXRUaW1lb3V0KHczY19zbGlkeS5oaWRlX3NsaWRlcywgNTApOwoK"></script>
  <style type="text/css">.pagedtable {
overflow: auto;
padding-left: 8px;
padding-right: 8px;
}
.pagedtable-wrapper {
border: 1px solid #ccc;
border-radius: 4px;
margin-bottom: 10px;
}
.pagedtable table {
width: 100%;
max-width: 100%;
margin: 0;
}
.pagedtable th {
padding: 0 5px 0 5px;
border: none;
border-bottom: 2px solid #dddddd;
min-width: 45px;
}
.pagedtable-empty th {
display: none;
}
.pagedtable td {
padding: 0 4px 0 4px;
}
.pagedtable .even {
background-color: #fcfcfc;
}
.pagedtable-padding-col {
display: none;
}
.pagedtable a {
-webkit-touch-callout: none;
-webkit-user-select: none;
-khtml-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.pagedtable-index-nav {
cursor: pointer;
padding: 0 5px 0 5px;
float: right;
border: 0;
}
.pagedtable-index-nav-disabled {
cursor: default;
text-decoration: none;
color: #999;
}
a.pagedtable-index-nav-disabled:hover {
text-decoration: none;
color: #999;
}
.pagedtable-indexes {
cursor: pointer;
float: right;
border: 0;
}
.pagedtable-index-current {
cursor: default;
text-decoration: none;
font-weight: bold;
color: #333;
border: 0;
}
a.pagedtable-index-current:hover {
text-decoration: none;
font-weight: bold;
color: #333;
}
.pagedtable-index {
width: 30px;
display: inline-block;
text-align: center;
border: 0;
}
.pagedtable-index-separator-left {
display: inline-block;
color: #333;
font-size: 9px;
padding: 0 0 0 0;
cursor: default;
}
.pagedtable-index-separator-right {
display: inline-block;
color: #333;
font-size: 9px;
padding: 0 4px 0 0;
cursor: default;
}
.pagedtable-footer {
padding-top: 4px;
padding-bottom: 5px;
}
.pagedtable-not-empty .pagedtable-footer {
border-top: 2px solid #dddddd;
}
.pagedtable-info {
overflow: hidden;
color: #999;
white-space: nowrap;
text-overflow: ellipsis;
}
.pagedtable-header-name {
overflow: hidden;
text-overflow: ellipsis;
}
.pagedtable-header-type {
color: #999;
font-weight: 400;
}
.pagedtable-na-cell {
font-style: italic;
opacity: 0.3;
}
</style>
  <script>// Production steps of ECMA-262, Edition 5, 15.4.4.18
// Reference: http://es5.github.io/#x15.4.4.18
if (!Array.prototype.forEach) {

  Array.prototype.forEach = function(callback, thisArg) {

    var T, k;

    if (this === null) {
      throw new TypeError(' this is null or not defined');
    }

    // 1. Let O be the result of calling toObject() passing the
    // |this| value as the argument.
    var O = Object(this);

    // 2. Let lenValue be the result of calling the Get() internal
    // method of O with the argument "length".
    // 3. Let len be toUint32(lenValue).
    var len = O.length >>> 0;

    // 4. If isCallable(callback) is false, throw a TypeError exception.
    // See: http://es5.github.com/#x9.11
    if (typeof callback !== "function") {
      throw new TypeError(callback + ' is not a function');
    }

    // 5. If thisArg was supplied, let T be thisArg; else let
    // T be undefined.
    if (arguments.length > 1) {
      T = thisArg;
    }

    // 6. Let k be 0
    k = 0;

    // 7. Repeat, while k < len
    while (k < len) {

      var kValue;

      // a. Let Pk be ToString(k).
      //    This is implicit for LHS operands of the in operator
      // b. Let kPresent be the result of calling the HasProperty
      //    internal method of O with argument Pk.
      //    This step can be combined with c
      // c. If kPresent is true, then
      if (k in O) {

        // i. Let kValue be the result of calling the Get internal
        // method of O with argument Pk.
        kValue = O[k];

        // ii. Call the Call internal method of callback with T as
        // the this value and argument list containing kValue, k, and O.
        callback.call(T, kValue, k, O);
      }
      // d. Increase k by 1.
      k++;
    }
    // 8. return undefined
  };
}

// Production steps of ECMA-262, Edition 5, 15.4.4.19
// Reference: http://es5.github.io/#x15.4.4.19
if (!Array.prototype.map) {

  Array.prototype.map = function(callback, thisArg) {

    var T, A, k;

    if (this == null) {
      throw new TypeError(' this is null or not defined');
    }

    // 1. Let O be the result of calling ToObject passing the |this|
    //    value as the argument.
    var O = Object(this);

    // 2. Let lenValue be the result of calling the Get internal
    //    method of O with the argument "length".
    // 3. Let len be ToUint32(lenValue).
    var len = O.length >>> 0;

    // 4. If IsCallable(callback) is false, throw a TypeError exception.
    // See: http://es5.github.com/#x9.11
    if (typeof callback !== 'function') {
      throw new TypeError(callback + ' is not a function');
    }

    // 5. If thisArg was supplied, let T be thisArg; else let T be undefined.
    if (arguments.length > 1) {
      T = thisArg;
    }

    // 6. Let A be a new array created as if by the expression new Array(len)
    //    where Array is the standard built-in constructor with that name and
    //    len is the value of len.
    A = new Array(len);

    // 7. Let k be 0
    k = 0;

    // 8. Repeat, while k < len
    while (k < len) {

      var kValue, mappedValue;

      // a. Let Pk be ToString(k).
      //   This is implicit for LHS operands of the in operator
      // b. Let kPresent be the result of calling the HasProperty internal
      //    method of O with argument Pk.
      //   This step can be combined with c
      // c. If kPresent is true, then
      if (k in O) {

        // i. Let kValue be the result of calling the Get internal
        //    method of O with argument Pk.
        kValue = O[k];

        // ii. Let mappedValue be the result of calling the Call internal
        //     method of callback with T as the this value and argument
        //     list containing kValue, k, and O.
        mappedValue = callback.call(T, kValue, k, O);

        // iii. Call the DefineOwnProperty internal method of A with arguments
        // Pk, Property Descriptor
        // { Value: mappedValue,
        //   Writable: true,
        //   Enumerable: true,
        //   Configurable: true },
        // and false.

        // In browsers that support Object.defineProperty, use the following:
        // Object.defineProperty(A, k, {
        //   value: mappedValue,
        //   writable: true,
        //   enumerable: true,
        //   configurable: true
        // });

        // For best browser support, use the following:
        A[k] = mappedValue;
      }
      // d. Increase k by 1.
      k++;
    }

    // 9. return A
    return A;
  };
}

var PagedTable = function (pagedTable) {
  var me = this;

  var source = function(pagedTable) {
    var sourceElems = [].slice.call(pagedTable.children).filter(function(e) {
      return e.hasAttribute("data-pagedtable-source");
    });

    if (sourceElems === null || sourceElems.length !== 1) {
      throw("A single data-pagedtable-source was not found");
    }

    return JSON.parse(sourceElems[0].innerHTML);
  }(pagedTable);

  var options = function(source) {
    var options = typeof(source.options) !== "undefined" &&
      source.options !== null ? source.options : {};

    var columns = typeof(options.columns) !== "undefined" ? options.columns : {};
    var rows = typeof(options.rows) !== "undefined" ? options.rows : {};

    var positiveIntOrNull = function(value) {
      return parseInt(value) >= 0 ? parseInt(value) : null;
    };

    return {
      pages: positiveIntOrNull(options.pages),
      rows: {
        min: positiveIntOrNull(rows.min),
        max: positiveIntOrNull(rows.max),
        total: positiveIntOrNull(rows.total)
      },
      columns: {
        min: positiveIntOrNull(columns.min),
        max: positiveIntOrNull(columns.max),
        total: positiveIntOrNull(columns.total)
      }
    };
  }(source);

  var Measurer = function() {

    // set some default initial values that will get adjusted in runtime
    me.measures = {
      padding: 12,
      character: 8,
      height: 15,
      defaults: true
    };

    me.calculate = function(measuresCell) {
      if (!me.measures.defaults)
        return;

      var measuresCellStyle = window.getComputedStyle(measuresCell, null);

      var newPadding = parsePadding(measuresCellStyle.paddingLeft) +
            parsePadding(measuresCellStyle.paddingRight);

      var sampleString = "ABCDEFGHIJ0123456789";
      var newCharacter = Math.ceil(measuresCell.clientWidth / sampleString.length);

      if (newPadding <= 0 || newCharacter <= 0)
        return;

      me.measures.padding = newPadding;
      me.measures.character = newCharacter;
      me.measures.height = measuresCell.clientHeight;
      me.measures.defaults = false;
    };

    return me;
  };

  var Page = function(data, options) {
    var me = this;

    var defaults = {
      max: 7,
      rows: 10
    };

    var totalPages = function() {
      return Math.ceil(data.length / me.rows);
    };

    me.number = 0;
    me.max = options.pages !== null ? options.pages : defaults.max;
    me.visible = me.max;
    me.rows = options.rows.min !== null ? options.rows.min : defaults.rows;
    me.total = totalPages();

    me.setRows = function(newRows) {
      me.rows = newRows;
      me.total = totalPages();
    };

    me.setPageNumber = function(newPageNumber) {
      if (newPageNumber < 0) newPageNumber = 0;
      if (newPageNumber >= me.total) newPageNumber = me.total - 1;

      me.number = newPageNumber;
    };

    me.setVisiblePages = function(visiblePages) {
      me.visible = Math.min(me.max, visiblePages);
      me.setPageNumber(me.number);
    };

    me.getVisiblePageRange = function() {
      var start = me.number - Math.max(Math.floor((me.visible - 1) / 2), 0);
      var end = me.number + Math.floor(me.visible / 2) + 1;
      var pageCount = me.total;

      if (start < 0) {
        var diffToStart = 0 - start;
        start += diffToStart;
        end += diffToStart;
      }

      if (end > pageCount) {
        var diffToEnd = end - pageCount;
        start -= diffToEnd;
        end -= diffToEnd;
      }

      start = start < 0 ? 0 : start;
      end = end >= pageCount ? pageCount : end;

      var first = false;
      var last = false;

      if (start > 0 && me.visible > 1) {
        start = start + 1;
        first = true;
      }

      if (end < pageCount && me.visible > 2) {
        end = end - 1;
        last = true;
      }

      return {
        first: first,
        start: start,
        end: end,
        last: last
      };
    };

    me.getRowStart = function() {
      var rowStart = page.number * page.rows;
      if (rowStart < 0)
        rowStart = 0;

      return rowStart;
    };

    me.getRowEnd = function() {
      var rowStart = me.getRowStart();
      return Math.min(rowStart + me.rows, data.length);
    };

    me.getPaddingRows = function() {
      var rowStart = me.getRowStart();
      var rowEnd = me.getRowEnd();
      return data.length > me.rows ? me.rows - (rowEnd - rowStart) : 0;
    };
  };

  var Columns = function(data, columns, options) {
    var me = this;

    me.defaults = {
      min: 5
    };

    me.number = 0;
    me.visible = 0;
    me.total = columns.length;
    me.subset = [];
    me.padding = 0;
    me.min = options.columns.min !== null ? options.columns.min : me.defaults.min;
    me.max = options.columns.max !== null ? options.columns.max : null;
    me.widths = {};

    var widthsLookAhead = Math.max(100, options.rows.min);
    var paddingColChars = 10;

    me.emptyNames = function() {
      columns.forEach(function(column) {
        if (columns.label !== null && columns.label !== "")
          return false;
      });

      return true;
    };

    var parsePadding = function(value) {
      return parseInt(value) >= 0 ? parseInt(value) : 0;
    };

    me.calculateWidths = function(measures) {
      columns.forEach(function(column) {
        var maxChars = Math.max(
          column.label.toString().length,
          column.type.toString().length
        );

        for (var idxRow = 0; idxRow < Math.min(widthsLookAhead, data.length); idxRow++) {
          maxChars = Math.max(maxChars, data[idxRow][column.name.toString()].length);
        }

        me.widths[column.name] = {
          // width in characters
          chars: maxChars,
          // width for the inner html columns
          inner: maxChars * measures.character,
          // width adding outer styles like padding
          outer: maxChars * measures.character + measures.padding
        };
      });
    };

    me.getWidth = function() {
      var widthOuter = 0;
      for (var idxCol = 0; idxCol < me.subset.length; idxCol++) {
        var columnName = me.subset[idxCol].name;
        widthOuter = widthOuter + me.widths[columnName].outer;
      }

      widthOuter = widthOuter + me.padding * paddingColChars * measurer.measures.character;

      if (me.hasMoreLeftColumns()) {
        widthOuter = widthOuter + columnNavigationWidthPX + measurer.measures.padding;
      }

      if (me.hasMoreRightColumns()) {
        widthOuter = widthOuter + columnNavigationWidthPX + measurer.measures.padding;
      }

      return widthOuter;
    };

    me.updateSlice = function() {
      if (me.number + me.visible >= me.total)
        me.number = me.total - me.visible;

      if (me.number < 0) me.number = 0;

      me.subset = columns.slice(me.number, Math.min(me.number + me.visible, me.total));

      me.subset = me.subset.map(function(column) {
        Object.keys(column).forEach(function(colKey) {
          column[colKey] = column[colKey] === null ? "" : column[colKey].toString();
        });

        column.width = null;
        return column;
      });
    };

    me.setVisibleColumns = function(columnNumber, newVisibleColumns, paddingCount) {
      me.number = columnNumber;
      me.visible = newVisibleColumns;
      me.padding = paddingCount;

      me.updateSlice();
    };

    me.incColumnNumber = function(increment) {
      me.number = me.number + increment;
    };

    me.setColumnNumber = function(newNumber) {
      me.number = newNumber;
    };

    me.setPaddingCount = function(newPadding) {
      me.padding = newPadding;
    };

    me.getPaddingCount = function() {
      return me.padding;
    };

    me.hasMoreLeftColumns = function() {
      return me.number > 0;
    };

    me.hasMoreRightColumns = function() {
      return me.number + me.visible < me.total;
    };

    me.updateSlice(0);
    return me;
  };

  var data = source.data;
  var page = new Page(data, options);
  var measurer = new Measurer(data, options);
  var columns = new Columns(data, source.columns, options);

  var table = null;
  var tableDiv = null;
  var header = null;
  var footer = null;
  var tbody = null;

  // Caches pagedTable.clientWidth, specially for webkit
  var cachedPagedTableClientWidth = null;

  var onChangeCallbacks = [];

  var clearSelection = function() {
    if(document.selection && document.selection.empty) {
      document.selection.empty();
    } else if(window.getSelection) {
      var sel = window.getSelection();
      sel.removeAllRanges();
    }
  };

  var columnNavigationWidthPX = 5;

  var renderColumnNavigation = function(increment, backwards) {
    var arrow = document.createElement("div");
    arrow.setAttribute("style",
      "border-top: " + columnNavigationWidthPX + "px solid transparent;" +
      "border-bottom: " + columnNavigationWidthPX + "px solid transparent;" +
      "border-" + (backwards ? "right" : "left") + ": " + columnNavigationWidthPX + "px solid;");

    var header = document.createElement("th");
    header.appendChild(arrow);
    header.setAttribute("style",
      "cursor: pointer;" +
      "vertical-align: middle;" +
      "min-width: " + columnNavigationWidthPX + "px;" +
      "width: " + columnNavigationWidthPX + "px;");

    header.onclick = function() {
      columns.incColumnNumber(backwards ? -1 : increment);

      me.animateColumns(backwards);
      renderFooter();

      clearSelection();
      triggerOnChange();
    };

    return header;
  };

  var maxColumnWidth = function(width) {
    var padding = 80;
    var columnMax = Math.max(cachedPagedTableClientWidth - padding, 0);

    return parseInt(width) > 0 ?
      Math.min(columnMax, parseInt(width)) + "px" :
      columnMax + "px";
  };

  var clearHeader = function() {
    var thead = pagedTable.querySelectorAll("thead")[0];
    thead.innerHTML = "";
  };

  var renderHeader = function(clear) {
    cachedPagedTableClientWidth = pagedTable.clientWidth;

    var fragment = document.createDocumentFragment();

    header = document.createElement("tr");
    fragment.appendChild(header);

    if (columns.number > 0)
      header.appendChild(renderColumnNavigation(-columns.visible, true));

    columns.subset = columns.subset.map(function(columnData) {
      var column = document.createElement("th");
      column.setAttribute("align", columnData.align);
      column.style.textAlign = columnData.align;

      column.style.maxWidth = maxColumnWidth(null);
      if (columnData.width) {
        column.style.minWidth =
          column.style.maxWidth = maxColumnWidth(columnData.width);
      }

      var columnName = document.createElement("div");
      columnName.setAttribute("class", "pagedtable-header-name");
      if (columnData.label === "") {
        columnName.innerHTML = "&nbsp;";
      }
      else {
        columnName.appendChild(document.createTextNode(columnData.label));
      }
      column.appendChild(columnName);

      var columnType = document.createElement("div");
      columnType.setAttribute("class", "pagedtable-header-type");
      if (columnData.type === "") {
        columnType.innerHTML = "&nbsp;";
      }
      else {
        columnType.appendChild(document.createTextNode("<" + columnData.type + ">"));
      }
      column.appendChild(columnType);

      header.appendChild(column);

      columnData.element = column;

      return columnData;
    });

    for (var idx = 0; idx < columns.getPaddingCount(); idx++) {
      var paddingCol = document.createElement("th");
      paddingCol.setAttribute("class", "pagedtable-padding-col");
      header.appendChild(paddingCol);
    }

    if (columns.number + columns.visible < columns.total)
      header.appendChild(renderColumnNavigation(columns.visible, false));

    if (typeof(clear) == "undefined" || clear) clearHeader();
    var thead = pagedTable.querySelectorAll("thead")[0];
    thead.appendChild(fragment);
  };

  me.animateColumns = function(backwards) {
    var thead = pagedTable.querySelectorAll("thead")[0];

    var headerOld = thead.querySelectorAll("tr")[0];
    var tbodyOld = table.querySelectorAll("tbody")[0];

    me.fitColumns(backwards);

    renderHeader(false);

    header.style.opacity = "0";
    header.style.transform = backwards ? "translateX(-30px)" : "translateX(30px)";
    header.style.transition = "transform 200ms linear, opacity 200ms";
    header.style.transitionDelay = "0";

    renderBody(false);

    if (headerOld) {
      headerOld.style.position = "absolute";
      headerOld.style.transform = "translateX(0px)";
      headerOld.style.opacity = "1";
      headerOld.style.transition = "transform 100ms linear, opacity 100ms";
      headerOld.setAttribute("class", "pagedtable-remove-head");
      if (headerOld.style.transitionEnd) {
        headerOld.addEventListener("transitionend", function() {
          var headerOldByClass = thead.querySelector(".pagedtable-remove-head");
          if (headerOldByClass) thead.removeChild(headerOldByClass);
        });
      }
      else {
        thead.removeChild(headerOld);
      }
    }

    if (tbodyOld) table.removeChild(tbodyOld);

    tbody.style.opacity = "0";
    tbody.style.transition = "transform 200ms linear, opacity 200ms";
    tbody.style.transitionDelay = "0ms";

    // force relayout
    window.getComputedStyle(header).opacity;
    window.getComputedStyle(tbody).opacity;

    if (headerOld) {
      headerOld.style.transform = backwards ? "translateX(20px)" : "translateX(-30px)";
      headerOld.style.opacity = "0";
    }

    header.style.transform = "translateX(0px)";
    header.style.opacity = "1";

    tbody.style.opacity = "1";
  }

  me.onChange = function(callback) {
    onChangeCallbacks.push(callback);
  };

  var triggerOnChange = function() {
    onChangeCallbacks.forEach(function(onChange) {
      onChange();
    });
  };

  var clearBody = function() {
    if (tbody) {
      table.removeChild(tbody);
      tbody = null;
    }
  };

  var renderBody = function(clear) {
    cachedPagedTableClientWidth = pagedTable.clientWidth

    var fragment = document.createDocumentFragment();

    var pageData = data.slice(page.getRowStart(), page.getRowEnd());

    pageData.forEach(function(dataRow, idxRow) {
      var htmlRow = document.createElement("tr");
      htmlRow.setAttribute("class", (idxRow % 2 !==0) ? "even" : "odd");

      if (columns.hasMoreLeftColumns())
        htmlRow.appendChild(document.createElement("td"));

      columns.subset.forEach(function(columnData) {
        var cellName = columnData.name;
        var dataCell = dataRow[cellName];
        var htmlCell = document.createElement("td");

        if (dataCell === "NA") htmlCell.setAttribute("class", "pagedtable-na-cell");
        if (dataCell === "__NA__") dataCell = "NA";

        var cellText = document.createTextNode(dataCell);
        htmlCell.appendChild(cellText);
        if (dataCell.length > 50) {
          htmlCell.setAttribute("title", dataCell);
        }
        htmlCell.setAttribute("align", columnData.align);
        htmlCell.style.textAlign = columnData.align;
        htmlCell.style.maxWidth = maxColumnWidth(null);
        if (columnData.width) {
          htmlCell.style.minWidth = htmlCell.style.maxWidth = maxColumnWidth(columnData.width);
        }
        htmlRow.appendChild(htmlCell);
      });

      for (var idx = 0; idx < columns.getPaddingCount(); idx++) {
        var paddingCol = document.createElement("td");
        paddingCol.setAttribute("class", "pagedtable-padding-col");
        htmlRow.appendChild(paddingCol);
      }

      if (columns.hasMoreRightColumns())
        htmlRow.appendChild(document.createElement("td"));

      fragment.appendChild(htmlRow);
    });

    for (var idxPadding = 0; idxPadding < page.getPaddingRows(); idxPadding++) {
      var paddingRow = document.createElement("tr");

      var paddingCellRow = document.createElement("td");
      paddingCellRow.innerHTML = "&nbsp;";
      paddingCellRow.setAttribute("colspan", "100%");
      paddingRow.appendChild(paddingCellRow);

      fragment.appendChild(paddingRow);
    }

    if (typeof(clear) == "undefined" || clear) clearBody();
    tbody = document.createElement("tbody");
    tbody.appendChild(fragment);

    table.appendChild(tbody);
  };

  var getLabelInfo = function() {
    var pageStart = page.getRowStart();
    var pageEnd = page.getRowEnd();
    var totalRows = data.length;

    var totalRowsLabel = options.rows.total ? options.rows.total : totalRows;
    var totalRowsLabelFormat = totalRowsLabel.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, '$1,');

    var infoText = (pageStart + 1) + "-" + pageEnd + " of " + totalRowsLabelFormat + " rows";
    if (totalRows < page.rows) {
      infoText = totalRowsLabel + " row" + (totalRows != 1 ? "s" : "");
    }
    if (columns.total > columns.visible) {
      var totalColumnsLabel = options.columns.total ? options.columns.total : columns.total;

      infoText = infoText + " | " + (columns.number + 1) + "-" +
        (Math.min(columns.number + columns.visible, columns.total)) +
        " of " + totalColumnsLabel + " columns";
    }

    return infoText;
  };

  var clearFooter = function() {
    footer = pagedTable.querySelectorAll("div.pagedtable-footer")[0];
    footer.innerHTML = "";

    return footer;
  };

  var createPageLink = function(idxPage) {
    var pageLink = document.createElement("a");
    pageLinkClass = idxPage === page.number ? "pagedtable-index pagedtable-index-current" : "pagedtable-index";
    pageLink.setAttribute("class", pageLinkClass);
    pageLink.setAttribute("data-page-index", idxPage);
    pageLink.onclick = function() {
      page.setPageNumber(parseInt(this.getAttribute("data-page-index")));
      renderBody();
      renderFooter();

      triggerOnChange();
    };

    pageLink.appendChild(document.createTextNode(idxPage + 1));

    return pageLink;
  }

  var renderFooter = function() {
    footer = clearFooter();

    var next = document.createElement("a");
    next.appendChild(document.createTextNode("Next"));
    next.onclick = function() {
      page.setPageNumber(page.number + 1);
      renderBody();
      renderFooter();

      triggerOnChange();
    };
    if (data.length > page.rows) footer.appendChild(next);

    var pageNumbers = document.createElement("div");
    pageNumbers.setAttribute("class", "pagedtable-indexes");

    var pageRange = page.getVisiblePageRange();

    if (pageRange.first) {
      var pageLink = createPageLink(0);
      pageNumbers.appendChild(pageLink);

      var pageSeparator = document.createElement("div");
      pageSeparator.setAttribute("class", "pagedtable-index-separator-left");
      pageSeparator.appendChild(document.createTextNode("..."))
      pageNumbers.appendChild(pageSeparator);
    }

    for (var idxPage = pageRange.start; idxPage < pageRange.end; idxPage++) {
      var pageLink = createPageLink(idxPage);

      pageNumbers.appendChild(pageLink);
    }

    if (pageRange.last) {
      var pageSeparator = document.createElement("div");
      pageSeparator.setAttribute("class", "pagedtable-index-separator-right");
      pageSeparator.appendChild(document.createTextNode("..."))
      pageNumbers.appendChild(pageSeparator);

      var pageLink = createPageLink(page.total - 1);
      pageNumbers.appendChild(pageLink);
    }

    if (data.length > page.rows) footer.appendChild(pageNumbers);

    var previous = document.createElement("a");
    previous.appendChild(document.createTextNode("Previous"));
    previous.onclick = function() {
      page.setPageNumber(page.number - 1);
      renderBody();
      renderFooter();

      triggerOnChange();
    };
    if (data.length > page.rows) footer.appendChild(previous);

    var infoLabel = document.createElement("div");
    infoLabel.setAttribute("class", "pagedtable-info");
    infoLabel.setAttribute("title", getLabelInfo());
    infoLabel.appendChild(document.createTextNode(getLabelInfo()));
    footer.appendChild(infoLabel);

    var enabledClass = "pagedtable-index-nav";
    var disabledClass = "pagedtable-index-nav pagedtable-index-nav-disabled";
    previous.setAttribute("class", page.number <= 0 ? disabledClass : enabledClass);
    next.setAttribute("class", (page.number + 1) * page.rows >= data.length ? disabledClass : enabledClass);
  };

  var measuresCell = null;

  var renderMeasures = function() {
    var measuresTable = document.createElement("table");
    measuresTable.style.visibility = "hidden";
    measuresTable.style.position = "absolute";
    measuresTable.style.whiteSpace = "nowrap";
    measuresTable.style.height = "auto";
    measuresTable.style.width = "auto";

    var measuresRow = document.createElement("tr");
    measuresTable.appendChild(measuresRow);

    measuresCell = document.createElement("td");
    var sampleString = "ABCDEFGHIJ0123456789";
    measuresCell.appendChild(document.createTextNode(sampleString));

    measuresRow.appendChild(measuresCell);

    tableDiv.appendChild(measuresTable);
  }

  me.init = function() {
    tableDiv = document.createElement("div");
    pagedTable.appendChild(tableDiv);
    var pagedTableClass = data.length > 0 ?
      "pagedtable pagedtable-not-empty" :
      "pagedtable pagedtable-empty";

    if (columns.total == 0 || (columns.emptyNames() && data.length == 0)) {
      pagedTableClass = pagedTableClass + " pagedtable-empty-columns";
    }

    tableDiv.setAttribute("class", pagedTableClass);

    renderMeasures();
    measurer.calculate(measuresCell);
    columns.calculateWidths(measurer.measures);

    table = document.createElement("table");
    table.setAttribute("cellspacing", "0");
    table.setAttribute("class", "table table-condensed");
    tableDiv.appendChild(table);

    table.appendChild(document.createElement("thead"));

    var footerDiv = document.createElement("div");
    footerDiv.setAttribute("class", "pagedtable-footer");
    tableDiv.appendChild(footerDiv);

    // if the host has not yet provided horizontal space, render hidden
    if (tableDiv.clientWidth <= 0) {
      tableDiv.style.opacity = "0";
    }

    me.render();

    // retry seizing columns later if the host has not provided space
    function retryFit() {
      if (tableDiv.clientWidth <= 0) {
        setTimeout(retryFit, 100);
      } else {
        me.render();
        triggerOnChange();
      }
    }
    if (tableDiv.clientWidth <= 0) {
      retryFit();
    }
  };

  var registerWidths = function() {
    columns.subset = columns.subset.map(function(column) {
      column.width = columns.widths[column.name].inner;
      return column;
    });
  };

  var parsePadding = function(value) {
    return parseInt(value) >= 0 ? parseInt(value) : 0;
  };

  me.fixedHeight = function() {
    return options.rows.max != null;
  }

  me.fitRows = function() {
    if (me.fixedHeight())
      return;

    measurer.calculate(measuresCell);

    var rows = options.rows.min !== null ? options.rows.min : 0;
    var headerHeight = header !== null && header.offsetHeight > 0 ? header.offsetHeight : 0;
    var footerHeight = footer !== null && footer.offsetHeight > 0 ? footer.offsetHeight : 0;

    if (pagedTable.offsetHeight > 0) {
      var availableHeight = pagedTable.offsetHeight - headerHeight - footerHeight;
      rows = Math.floor((availableHeight) / measurer.measures.height);
    }

    rows = options.rows.min !== null ? Math.max(options.rows.min, rows) : rows;

    page.setRows(rows);
  }

  // The goal of this function is to add as many columns as possible
  // starting from left-to-right, when the right most limit is reached
  // it tries to add columns from the left as well.
  //
  // When startBackwards is true columns are added from right-to-left
  me.fitColumns = function(startBackwards) {
    measurer.calculate(measuresCell);
    columns.calculateWidths(measurer.measures);

    if (tableDiv.clientWidth > 0) {
      tableDiv.style.opacity = 1;
    }

    var visibleColumns = tableDiv.clientWidth <= 0 ? Math.max(columns.min, 1) : 1;
    var columnNumber = columns.number;
    var paddingCount = 0;

    // track a list of added columns as we build the visible ones to allow us
    // to remove columns when they don't fit anymore.
    var columnHistory = [];

    var lastTableHeight = 0;
    var backwards = startBackwards;

    var tableDivStyle = window.getComputedStyle(tableDiv, null);
    var tableDivPadding = parsePadding(tableDivStyle.paddingLeft) +
      parsePadding(tableDivStyle.paddingRight);

    var addPaddingCol = false;
    var currentWidth = 0;

    while (true) {
      columns.setVisibleColumns(columnNumber, visibleColumns, paddingCount);
      currentWidth = columns.getWidth();

      if (tableDiv.clientWidth - tableDivPadding < currentWidth) {
        break;
      }

      columnHistory.push({
        columnNumber: columnNumber,
        visibleColumns: visibleColumns,
        paddingCount: paddingCount
      });

      if (columnHistory.length > 100) {
        console.error("More than 100 tries to fit columns, aborting");
        break;
      }

      if (columns.max !== null &&
        columns.visible + columns.getPaddingCount() >= columns.max) {
        break;
      }

      // if we run out of right-columns
      if (!backwards && columnNumber + columns.visible >= columns.total) {
        // if we started adding right-columns, try adding left-columns
        if (!startBackwards && columnNumber > 0) {
          backwards = true;
        }
        else if (columns.min === null || visibleColumns + columns.getPaddingCount() >= columns.min) {
          break;
        }
        else {
          paddingCount = paddingCount + 1;
        }
      }

      // if we run out of left-columns
      if (backwards && columnNumber == 0) {
        // if we started adding left-columns, try adding right-columns
        if (startBackwards && columnNumber + columns.visible < columns.total) {
          backwards = false;
        }
        else if (columns.min === null || visibleColumns + columns.getPaddingCount() >= columns.min) {
          break;
        }
        else {
          paddingCount = paddingCount + 1;
        }
      }

      // when moving backwards try fitting left columns first
      if (backwards && columnNumber > 0) {
        columnNumber = columnNumber - 1;
      }

      if (columnNumber + visibleColumns < columns.total) {
        visibleColumns = visibleColumns + 1;
      }
    }

    var lastRenderableColumn = {
        columnNumber: columnNumber,
        visibleColumns: visibleColumns,
        paddingCount: paddingCount
    };

    if (columnHistory.length > 0) {
      lastRenderableColumn = columnHistory[columnHistory.length - 1];
    }

    columns.setVisibleColumns(
      lastRenderableColumn.columnNumber,
      lastRenderableColumn.visibleColumns,
      lastRenderableColumn.paddingCount);

    if (pagedTable.offsetWidth > 0) {
      page.setVisiblePages(Math.max(Math.ceil(1.0 * (pagedTable.offsetWidth - 250) / 40), 2));
    }

    registerWidths();
  };

  me.fit = function(startBackwards) {
    me.fitRows();
    me.fitColumns(startBackwards);
  }

  me.render = function() {
    me.fitColumns(false);

    // render header/footer to measure height accurately
    renderHeader();
    renderFooter();

    me.fitRows();
    renderBody();

    // re-render footer to match new rows
    renderFooter();
  }

  var resizeLastWidth = -1;
  var resizeLastHeight = -1;
  var resizeNewWidth = -1;
  var resizeNewHeight = -1;
  var resizePending = false;

  me.resize = function(newWidth, newHeight) {

    function resizeDelayed() {
      resizePending = false;

      if (
        (resizeNewWidth !== resizeLastWidth) ||
        (!me.fixedHeight() && resizeNewHeight !== resizeLastHeight)
      ) {
        resizeLastWidth = resizeNewWidth;
        resizeLastHeight = resizeNewHeight;

        setTimeout(resizeDelayed, 200);
        resizePending = true;
      } else {
        me.render();
        triggerOnChange();

        resizeLastWidth = -1;
        resizeLastHeight = -1;
      }
    }

    resizeNewWidth = newWidth;
    resizeNewHeight = newHeight;

    if (!resizePending) resizeDelayed();
  };
};

var PagedTableDoc;
(function (PagedTableDoc) {
  var allPagedTables = [];

  PagedTableDoc.initAll = function() {
    allPagedTables = [];

    var pagedTables = [].slice.call(document.querySelectorAll('[data-pagedtable="false"],[data-pagedtable=""]'));
    pagedTables.forEach(function(pagedTable, idx) {
      pagedTable.setAttribute("data-pagedtable", "true");
      pagedTable.setAttribute("pagedtable-page", 0);
      pagedTable.setAttribute("class", "pagedtable-wrapper");

      var pagedTableInstance = new PagedTable(pagedTable);
      pagedTableInstance.init();

      allPagedTables.push(pagedTableInstance);
    });
  };

  PagedTableDoc.resizeAll = function() {
    allPagedTables.forEach(function(pagedTable) {
      pagedTable.render();
    });
  };

  window.addEventListener("resize", PagedTableDoc.resizeAll);

  return PagedTableDoc;
})(PagedTableDoc || (PagedTableDoc = {}));

window.onload = function() {
  PagedTableDoc.initAll();
};
</script>
  <meta name="duration" content="180" />
</head>
<body>
<div class="slide titlepage">
  <h1 class="title">FE8828 Programming Web Applications in Finance</h1>
  <h1 class="subtitle"><sub> Week 5 <br> Building Financial Applications </sub></h1>
  <p class="author">
Dr.Â Yang Ye <sub> &lt;Email:<a href="mailto:yy@runchee.com">yy@runchee.com</a>&gt; </sub>
  </p>
  <p class="date">Nov 19, 2018</p>
</div>
<div class="slide section level1">

<style type="text/css">
code.r{ /* Code block */
    font-size: 20px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 17px;
}
</style>
</div>
<div id="lecture-10-building-financial-applications" class="slide section level1">
<h1>Lecture 10: Building Financial Applications</h1>
</div>
<div id="starter" class="slide section level1">
<h1>Starter</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># biorhythm.R</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7">biorhythm &lt;-<span class="st"> </span><span class="cf">function</span>(dob, <span class="dt">target =</span> <span class="kw">Sys.Date</span>()) {</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  dob &lt;-<span class="st"> </span><span class="kw">as.Date</span>(dob)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  target &lt;-<span class="st"> </span><span class="kw">as.Date</span>(target)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">  t &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">as.numeric</span>(<span class="kw">difftime</span>(target, dob)))</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">  days &lt;-<span class="st"> </span>(t <span class="op">-</span><span class="st"> </span><span class="dv">14</span>) <span class="op">:</span><span class="st"> </span>(t <span class="op">+</span><span class="st"> </span><span class="dv">14</span>)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">  period &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Date =</span> <span class="kw">seq.Date</span>(<span class="dt">from =</span> target <span class="op">-</span><span class="st"> </span><span class="dv">15</span>, <span class="dt">by =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">29</span>),</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">                       <span class="dt">Physical =</span> <span class="kw">sin</span> (<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>days <span class="op">/</span><span class="st"> </span><span class="dv">23</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, </a>
<a class="sourceLine" id="cb1-14" data-line-number="14">                       <span class="dt">Emotional =</span> <span class="kw">sin</span> (<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>days <span class="op">/</span><span class="st"> </span><span class="dv">28</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, </a>
<a class="sourceLine" id="cb1-15" data-line-number="15">                       <span class="dt">Intellectual =</span> <span class="kw">sin</span> (<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">*</span><span class="st"> </span>days <span class="op">/</span><span class="st"> </span><span class="dv">33</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">  period &lt;-<span class="st"> </span><span class="kw">gather</span>(period, <span class="dt">key =</span> <span class="st">&quot;Biorhythm&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;Percentage&quot;</span>, <span class="op">-</span>Date)</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">  <span class="kw">ggplot</span>(period, <span class="kw">aes</span>(<span class="dt">x =</span> Date, <span class="dt">y =</span> Percentage, <span class="dt">col =</span> Biorhythm)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="kw">paste</span>(<span class="st">&quot;DoB:&quot;</span>, <span class="kw">format</span>(dob, <span class="st">&quot;%d %B %Y&quot;</span>))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">as.numeric</span>(target)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</a>
<a class="sourceLine" id="cb1-22" data-line-number="22">}</a></code></pre></div>
</div>
<div id="starter---result" class="slide section level1">
<h1>Starter - Result</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># I took four people's birthdays. Hope they are in good mode today.</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">g1 &lt;-<span class="st"> </span><span class="kw">biorhythm</span>(<span class="st">&quot;1964-01-12&quot;</span>, <span class="kw">Sys.Date</span>())</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">g2 &lt;-<span class="st"> </span><span class="kw">biorhythm</span>(<span class="st">&quot;1971-06-28&quot;</span>, <span class="kw">Sys.Date</span>())</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">g3 &lt;-<span class="st"> </span><span class="kw">biorhythm</span>(<span class="st">&quot;1971-10-29&quot;</span>, <span class="kw">Sys.Date</span>())</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">g4 &lt;-<span class="st"> </span><span class="kw">biorhythm</span>(<span class="st">&quot;1957-08-11&quot;</span>, <span class="kw">Sys.Date</span>())</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="kw">grid.arrange</span>(g1, g2, g3, g4, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="main-course" class="slide section level1">
<h1>Main course</h1>
<ul>
<li>We need following packages as a start. Use c() to install multiple packages.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="kw">c</span>(<span class="st">&quot;tidyquant&quot;</span>, <span class="st">&quot;Quandl&quot;</span>, <span class="st">&quot;fOptions&quot;</span>, <span class="st">&quot;fExoticOptions&quot;</span>, <span class="st">&quot;dygraph&quot;</span>, <span class="st">&quot;forecast&quot;</span>))</a></code></pre></div>
<ul>
<li><p><code>tidyquant</code> is also a collection of packages: <code>xts</code>, <code>quantmod</code>.</p></li>
<li>Please validate option pricing code.
<ul>
<li>For example, I found Asian Option <code>TurnbullWakemanAsianApproxOption()</code> in <code>fExoticOptions</code> is strangely implemented. Maybe I am wrong.</li>
</ul></li>
</ul>
</div>
<div id="tidyquant-or-quandl" class="slide section level1">
<h1>tidyquant or Quandl?</h1>
<p>Determining factors:</p>
<ul>
<li><code>tidyquant/quantmod</code> can connect to various services: <sub>google</sub>, yahoo (still active), av (AlphaAdvantage).</li>
<li>Quandl only connects to Quandl</li>
<li>Itâs subjected to where you can find the data.
<ul>
<li>US ETF on Quandl is a premium service.</li>
<li>ETF in Google/AlphaAdvantage is free.</li>
</ul></li>
</ul>
</div>
<div id="tidyquant-or-quandl-1" class="slide section level1">
<h1>tidyquant or Quandl?</h1>
<p>Technical details:</p>
<ul>
<li>quantmod returns <code>xts</code> object. Quandl returns data frame or <code>xts</code></li>
<li>xts object is can <code>collapse</code> to daily, weekly, monthly price.</li>
</ul>
</div>
<div id="tidyquantquantmod" class="slide section level1">
<h1>Tidyquant/quantmod</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># library(tidyquant)</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co"># use Google</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw">getSymbols</span>(<span class="st">'SPY'</span>, <span class="dt">src =</span> <span class="st">'yahoo'</span>, <span class="dt">adjusted =</span> <span class="ot">TRUE</span>, <span class="dt">output.size =</span> <span class="st">'full'</span>)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">## </span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">## </span><span class="al">WARNING</span><span class="co">: There have been significant changes to Yahoo Finance data.</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">## Please see the Warning section of '?getSymbols.yahoo' for details.</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">## </span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">## This message is shown once per session and may be disabled by setting</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">## options(&quot;getSymbols.yahoo.warning&quot;=FALSE).</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">## [1] &quot;SPY&quot;</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="kw">str</span>(SPY)</a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">## An 'xts' object on 2007-01-03/2018-11-09 containing:</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">##   Data: num [1:2987, 1:6] 142 141 141 141 141 ...</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">##  - attr(*, &quot;dimnames&quot;)=List of 2</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">##   ..$ : NULL</span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">##   ..$ : chr [1:6] &quot;SPY.Open&quot; &quot;SPY.High&quot; &quot;SPY.Low&quot; &quot;SPY.Close&quot; ...</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">##   Indexed by objects of class: [Date] TZ: UTC</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">##   xts Attributes:  </span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">## List of 2</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">##  $ src    : chr &quot;yahoo&quot;</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"><span class="co">##  $ updated: POSIXct[1:1], format: &quot;2018-11-10 23:40:06&quot;</span></a>
<a class="sourceLine" id="cb4-23" data-line-number="23"></a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co"># Sign up with AlphaAdvantage to get a token</span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co"># getSymbols('SPY', src = 'av', output.size = 'full', api.key = token_av)</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co"># str(SPY)</span></a></code></pre></div>
</div>
<div id="tidyquantquantmod-1" class="slide section level1">
<h1>Tidyquant/quantmod</h1>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># What's get returned?</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">head</span>(SPY)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">##            SPY.Open SPY.High SPY.Low SPY.Close SPY.Volume SPY.Adjusted</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">## 2007-01-03   142.25   142.86  140.57    141.37   94807600     111.1660</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">## 2007-01-04   141.23   142.05  140.61    141.67   69620600     111.4019</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">## 2007-01-05   141.33   141.40  140.38    140.54   76645300     110.5134</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">## 2007-01-08   140.82   141.41  140.25    141.19   71655000     111.0245</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">## 2007-01-09   141.31   141.60  140.40    141.07   75680100     110.9301</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">## 2007-01-10   140.58   141.57  140.30    141.54   72428000     111.2997</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="kw">tail</span>(SPY)</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">##            SPY.Open SPY.High SPY.Low SPY.Close SPY.Volume SPY.Adjusted</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">## 2018-11-02   274.75   275.23  269.59    271.89  122634100       271.89</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">## 2018-11-05   272.44   274.01  271.35    273.39   65622500       273.39</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">## 2018-11-06   273.32   275.30  273.25    275.12   60085900       275.12</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">## 2018-11-07   277.56   281.10  277.08    281.01  102752100       281.01</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">## 2018-11-08   280.11   281.22  279.22    280.50   65584900       280.50</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">## 2018-11-09   279.03   279.24  276.18    277.76   98767900       277.76</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"></a>
<a class="sourceLine" id="cb5-19" data-line-number="19">symbols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;MSFT&quot;</span>, <span class="st">&quot;AAPL&quot;</span>)</a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="kw">getSymbols</span>(symbols, <span class="dt">src =</span> <span class="st">'yahoo'</span>, <span class="dt">adjusted =</span> <span class="ot">TRUE</span>, <span class="dt">from =</span> <span class="st">&quot;2016-01-01&quot;</span>)</a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">## [1] &quot;MSFT&quot; &quot;AAPL&quot;</span></a></code></pre></div>
</div>
<div id="xts-object" class="slide section level1">
<h1><code>xts</code> object</h1>
<ul>
<li>xts is a wide format. In contrast, ggplot/tidy uses long format.</li>
<li>We have gather/spread to convert between long/wide format.</li>
<li>Create xts object:
<ul>
<li>Put index aside, which is usually date</li>
<li>Store prices in columns.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">library</span>(xts)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co"># if df is a data frame.</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># Date | V | GS</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">xts1 &lt;-<span class="st"> </span><span class="kw">xts</span>(<span class="dt">x=</span>df[, <span class="dv">-1</span>, <span class="dt">drop =</span> F], <span class="dt">order.by =</span> df[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co"># coredata: returns a matrix from xts objects</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8">core_data &lt;-<span class="st"> </span><span class="kw">coredata</span>(xts2)</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co"># index: vector of any Date, POSIXct, chron, yearmon, yearqtr, or DateTime classes</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="kw">index</span>(xts1)</a></code></pre></div>
</div>
<div id="get-data-from-xts-object" class="slide section level1">
<h1>Get data from <code>xts</code> object</h1>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># What price history is stored here.</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">str</span>(SPY)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">## An 'xts' object on 2007-01-03/2018-11-09 containing:</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">##   Data: num [1:2987, 1:6] 142 141 141 141 141 ...</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">##  - attr(*, &quot;dimnames&quot;)=List of 2</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">##   ..$ : NULL</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">##   ..$ : chr [1:6] &quot;SPY.Open&quot; &quot;SPY.High&quot; &quot;SPY.Low&quot; &quot;SPY.Close&quot; ...</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">##   Indexed by objects of class: [Date] TZ: UTC</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">##   xts Attributes:  </span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">## List of 2</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">##  $ src    : chr &quot;yahoo&quot;</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">##  $ updated: POSIXct[1:1], format: &quot;2018-11-10 23:40:06&quot;</span></a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">SPY2003 &lt;-<span class="st"> </span>SPY[<span class="st">&quot;2003&quot;</span>]</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">SPY2 &lt;-<span class="st"> </span>SPY[<span class="st">&quot;2003/2007&quot;</span>]</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">SPY3 &lt;-<span class="st"> </span>SPY[<span class="st">&quot;2003-03-01/2007-07-01&quot;</span>]</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">SPY4 &lt;-<span class="st"> </span>SPY[<span class="st">&quot;/2007-07-01&quot;</span>] <span class="co"># till </span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">SPY5 &lt;-<span class="st"> </span>SPY[<span class="st">&quot;2007-07-01/&quot;</span>] <span class="co"># from</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6">SPY6 &lt;-<span class="st"> </span>SPY[<span class="st">&quot;2007-07-01/&quot;</span>, <span class="st">&quot;SPY.High&quot;</span>]</a>
<a class="sourceLine" id="cb8-7" data-line-number="7">SPY7 &lt;-<span class="st"> </span>SPY[<span class="st">&quot;2007-07-01/&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;SPY.High&quot;</span>, <span class="st">&quot;SPY.Close&quot;</span>)]</a></code></pre></div>
</div>
<div id="quandl" class="slide section level1">
<h1>Quandl</h1>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">library</span>(Quandl)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3"></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co"># Sign up with Quandl to get a token</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co"># token_qd &lt;- &quot;xxxx&quot;</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="kw">Quandl.api_key</span>(token_qd)</a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">## You don't get SPY: SPDR 500 ETF from Quandl from free service.</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">## rates &lt;- Quandl(c(&quot;EOD/SPY&quot;), start_date=&quot;2000-01-01&quot;, end_date=&quot;2013-06-07&quot;)</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co"># You get price for Visa</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10">rates &lt;-<span class="st"> </span><span class="kw">Quandl</span>(<span class="kw">c</span>(<span class="st">&quot;EOD/V&quot;</span>), <span class="dt">start_date=</span><span class="st">&quot;2000-01-01&quot;</span>, <span class="dt">end_date=</span><span class="st">&quot;2013-06-07&quot;</span> )</a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co"># Get price for GS in xts</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12">rates &lt;-<span class="st"> </span><span class="kw">Quandl</span>(<span class="kw">c</span>(<span class="st">&quot;EOD/GS&quot;</span>), <span class="dt">start_date=</span><span class="st">&quot;2000-01-01&quot;</span>, <span class="dt">end_date=</span><span class="st">&quot;2013-06-07&quot;</span>,</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">                <span class="dt">type =</span> <span class="st">&quot;xts&quot;</span>)</a></code></pre></div>
</div>
<div id="quandl-1" class="slide section level1">
<h1>Quandl</h1>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">library</span>(Quandl)                 <span class="co"># Quandl package</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">library</span>(ggplot2)                <span class="co"># Package for plotting</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw">library</span>(tidyverse)              <span class="co"># Package for reshaping data</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="kw">Quandl.api_key</span>(token_qd)                <span class="co"># Authenticate your token</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co"># Build vector of currencies</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7">rates &lt;-<span class="st"> </span><span class="kw">Quandl</span>(<span class="kw">c</span>(<span class="st">&quot;FRED/DEXUSAL&quot;</span>, <span class="st">&quot;FRED/DEXBZUS&quot;</span>, <span class="st">&quot;FRED/DEXUSUK&quot;</span>, <span class="st">&quot;FRED/DEXCHUS&quot;</span>),</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">                <span class="dt">start_date=</span><span class="st">&quot;2000-01-01&quot;</span>,</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">                <span class="dt">end_date =</span> <span class="st">&quot;2018-11-28&quot;</span>)</a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="kw">colnames</span>(rates) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Date&quot;</span>, <span class="st">&quot;AUD/USD&quot;</span>, <span class="st">&quot;USD/BRL&quot;</span>, <span class="st">&quot;GBP/USD&quot;</span>, <span class="st">&quot;USD/CNY&quot;</span>)</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">meltdf &lt;-<span class="st"> </span><span class="kw">gather</span>(rates, <span class="dt">key =</span> <span class="st">&quot;CCY&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;Rate&quot;</span>, <span class="op">-</span>Date)</a>
<a class="sourceLine" id="cb10-12" data-line-number="12"></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="kw">ggplot</span>(meltdf, <span class="kw">aes</span>(<span class="dt">x =</span> Date, <span class="dt">y =</span> Rate, <span class="dt">colour =</span> CCY, <span class="dt">group =</span> CCY)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values=</span><span class="dv">1</span><span class="op">:</span><span class="dv">22</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Major Currency Exchange Rates in USD&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="st">  </span><span class="kw">theme_minimal</span>()</a></code></pre></div>
<p><img src="data:image/png;base64,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" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="quandl-and-forecast" class="slide section level1">
<h1>Quandl and forecast</h1>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># 52-quandl-forecast.R</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co"># Quandl and Forecast</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co"># Forecast using state space models and automatic ARIMA modelling.</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="kw">library</span>(Quandl)</a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="kw">library</span>(xts)</a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="kw">library</span>(lubridate)</a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="kw">library</span>(forecast)</a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="kw">library</span>(dygraphs)</a>
<a class="sourceLine" id="cb11-11" data-line-number="11"></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co"># Start with daily data. Note that &quot;type = raw&quot; will download a data frame.</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13">oil_daily &lt;-<span class="st"> </span><span class="kw">Quandl</span>(<span class="st">&quot;FRED/DCOILWTICO&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;raw&quot;</span>, <span class="dt">collapse =</span> <span class="st">&quot;daily&quot;</span>,  </a>
<a class="sourceLine" id="cb11-14" data-line-number="14">                    <span class="dt">start_date=</span><span class="st">&quot;2006-01-01&quot;</span>, <span class="dt">end_date=</span><span class="kw">Sys.Date</span>())</a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co"># Now weekely and let's use xts as the type.</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16">oil_weekly &lt;-<span class="st"> </span><span class="kw">Quandl</span>(<span class="st">&quot;FRED/DCOILWTICO&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;xts&quot;</span>, <span class="dt">collapse =</span> <span class="st">&quot;weekly&quot;</span>,</a>
<a class="sourceLine" id="cb11-17" data-line-number="17">                     <span class="dt">start_date=</span><span class="st">&quot;2006-01-01&quot;</span>, <span class="dt">end_date =</span> <span class="kw">Sys.Date</span>())</a>
<a class="sourceLine" id="cb11-18" data-line-number="18">oil_monthly &lt;-<span class="st"> </span><span class="kw">Quandl</span>(<span class="st">&quot;FRED/DCOILWTICO&quot;</span>, <span class="dt">type =</span> <span class="st">&quot;xts&quot;</span>, <span class="dt">collapse =</span> <span class="st">&quot;monthly&quot;</span>,  </a>
<a class="sourceLine" id="cb11-19" data-line-number="19">                      <span class="dt">start_date=</span><span class="st">&quot;2006-01-01&quot;</span>, <span class="dt">end_date =</span> <span class="st">&quot;2017-02-28&quot;</span>)</a>
<a class="sourceLine" id="cb11-20" data-line-number="20"></a>
<a class="sourceLine" id="cb11-21" data-line-number="21"><span class="co"># Have a quick look at our three  objects. </span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="kw">str</span>(oil_daily)</a>
<a class="sourceLine" id="cb11-23" data-line-number="23"><span class="kw">str</span>(oil_weekly)</a>
<a class="sourceLine" id="cb11-24" data-line-number="24"><span class="kw">str</span>(oil_monthly)</a>
<a class="sourceLine" id="cb11-25" data-line-number="25"></a>
<a class="sourceLine" id="cb11-26" data-line-number="26"><span class="co"># Change index from month to day</span></a>
<a class="sourceLine" id="cb11-27" data-line-number="27"><span class="kw">head</span>(<span class="kw">index</span>(oil_monthly))</a>
<a class="sourceLine" id="cb11-28" data-line-number="28"><span class="kw">index</span>(oil_monthly) &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="kw">mdy</span>(<span class="st">'01/01/2006'</span>), <span class="kw">mdy</span>(<span class="st">'02/28/2017'</span>), <span class="dt">by =</span> <span class="st">'months'</span>)</a>
<a class="sourceLine" id="cb11-29" data-line-number="29"><span class="kw">str</span>(oil_monthly)</a>
<a class="sourceLine" id="cb11-30" data-line-number="30"><span class="kw">head</span>(<span class="kw">index</span>(oil_monthly))</a>
<a class="sourceLine" id="cb11-31" data-line-number="31"></a>
<a class="sourceLine" id="cb11-32" data-line-number="32"><span class="kw">dygraph</span>(oil_monthly, <span class="dt">main =</span> <span class="st">&quot;Monthly oil Prices&quot;</span>)</a>
<a class="sourceLine" id="cb11-33" data-line-number="33"></a>
<a class="sourceLine" id="cb11-34" data-line-number="34">forebase1 &lt;-<span class="st"> </span>oil_weekly[<span class="st">&quot;/2016-02-28&quot;</span>]</a>
<a class="sourceLine" id="cb11-35" data-line-number="35">forecast1 &lt;-<span class="st"> </span><span class="kw">forecast</span>(forebase1, <span class="dt">h =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">24</span>)</a>
<a class="sourceLine" id="cb11-36" data-line-number="36"></a>
<a class="sourceLine" id="cb11-37" data-line-number="37"><span class="kw">plot</span>(forecast1, <span class="dt">main =</span> <span class="st">&quot;Oil Forecast1&quot;</span>)</a>
<a class="sourceLine" id="cb11-38" data-line-number="38"></a>
<a class="sourceLine" id="cb11-39" data-line-number="39">oil_forecast_data1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb11-40" data-line-number="40">  <span class="dt">date =</span> <span class="kw">seq</span>(<span class="kw">last</span>(<span class="kw">index</span>(forebase1)), </a>
<a class="sourceLine" id="cb11-41" data-line-number="41">             <span class="dt">by =</span> <span class="st">'week'</span>, <span class="dt">length.out =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">24</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)[<span class="op">-</span><span class="dv">1</span>],</a>
<a class="sourceLine" id="cb11-42" data-line-number="42">  <span class="dt">Forecast =</span> forecast1<span class="op">$</span>mean,</a>
<a class="sourceLine" id="cb11-43" data-line-number="43">  <span class="dt">Hi_95 =</span> forecast1<span class="op">$</span>upper[,<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb11-44" data-line-number="44">  <span class="dt">Lo_95 =</span> forecast1<span class="op">$</span>lower[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb11-45" data-line-number="45"></a>
<a class="sourceLine" id="cb11-46" data-line-number="46">oil_forecast_xts1 &lt;-<span class="st"> </span><span class="kw">xts</span>(oil_forecast_data1[,<span class="op">-</span><span class="dv">1</span>],</a>
<a class="sourceLine" id="cb11-47" data-line-number="47">                         <span class="dt">order.by =</span> oil_forecast_data1[,<span class="dv">1</span>])</a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">forebase2 &lt;-<span class="st"> </span>oil_weekly[<span class="st">&quot;/2018-11-30&quot;</span>]</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">forecast2 &lt;-<span class="st"> </span><span class="kw">forecast</span>(forebase2, <span class="dt">h =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw">plot</span>(forecast2, <span class="dt">main =</span> <span class="st">&quot;Oil Forecast2&quot;</span>)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"></a>
<a class="sourceLine" id="cb12-6" data-line-number="6">oil_forecast_data2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb12-7" data-line-number="7">  <span class="dt">date =</span> <span class="kw">seq</span>(<span class="kw">last</span>(<span class="kw">index</span>(forebase2)), </a>
<a class="sourceLine" id="cb12-8" data-line-number="8">             <span class="dt">by =</span> <span class="st">'week'</span>, <span class="dt">length.out =</span> <span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)[<span class="op">-</span><span class="dv">1</span>],</a>
<a class="sourceLine" id="cb12-9" data-line-number="9">  <span class="dt">Forecast2 =</span> forecast2<span class="op">$</span>mean,</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">  <span class="dt">Hi_95_2 =</span> forecast2<span class="op">$</span>upper[,<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb12-11" data-line-number="11">  <span class="dt">Lo_95_2 =</span> forecast2<span class="op">$</span>lower[,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb12-12" data-line-number="12"></a>
<a class="sourceLine" id="cb12-13" data-line-number="13">oil_forecast_xts2 &lt;-<span class="st"> </span><span class="kw">xts</span>(oil_forecast_data2[,<span class="op">-</span><span class="dv">1</span>],</a>
<a class="sourceLine" id="cb12-14" data-line-number="14">                         <span class="dt">order.by =</span> oil_forecast_data2[,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb12-15" data-line-number="15"></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co"># Combine the xts objects with cbind.</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17">oil_combined_xts &lt;-<span class="st"> </span><span class="kw">merge</span>(oil_weekly, oil_forecast_xts1, oil_forecast_xts2)</a>
<a class="sourceLine" id="cb12-18" data-line-number="18"></a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co"># Add a nicer name for the first column.</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="kw">colnames</span>(oil_combined_xts)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;Actual&quot;</span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="kw">dygraph</span>(oil_combined_xts, <span class="dt">main =</span> <span class="st">&quot;Oil Prices: Historical and Forecast&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="st">  </span><span class="kw">dySeries</span>(<span class="st">&quot;Actual&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Actual&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-24" data-line-number="24"><span class="st">  </span><span class="kw">dySeries</span>(<span class="kw">c</span>(<span class="st">&quot;Lo_95&quot;</span>, <span class="st">&quot;Forecast&quot;</span>, <span class="st">&quot;Hi_95&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-25" data-line-number="25"><span class="st">  </span><span class="kw">dySeries</span>(<span class="kw">c</span>(<span class="st">&quot;Lo_95_2&quot;</span>, <span class="st">&quot;Forecast2&quot;</span>, <span class="st">&quot;Hi_95_2&quot;</span>))</a></code></pre></div>
</div>
<div id="dygraph" class="slide section level1">
<h1>dygraph</h1>
<p>dygraph for xts <a href="https://rstudio.github.io/dygraphs/shiny.html" class="uri">https://rstudio.github.io/dygraphs/shiny.html</a></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw">dygraphOutput</span>(<span class="st">&quot;dygraph&quot;</span>)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw">dygraph</span>(oil_combined_xts, <span class="dt">main =</span> <span class="st">&quot;Oil Prices: Historical and Forecast&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="st">  </span><span class="co"># Add the actual series</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="st">  </span><span class="kw">dySeries</span>(<span class="st">&quot;Actual&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;Actual&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="st">  </span><span class="co"># Add the three forecasted series</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="st">  </span><span class="kw">dySeries</span>(<span class="kw">c</span>(<span class="st">&quot;Lo_95&quot;</span>, <span class="st">&quot;Forecast&quot;</span>, <span class="st">&quot;Hi_95&quot;</span>))</a></code></pre></div>
</div>
<div id="quandlshinydygraph" class="slide section level1">
<h1>Quandl/Shiny/dygraph</h1>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># shiny-51-quandl.R</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="kw">library</span>(shiny)</a>
<a class="sourceLine" id="cb14-4" data-line-number="4"></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="kw">library</span>(tidyverse) </a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="kw">library</span>(Quandl)</a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="kw">library</span>(xts)</a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="kw">library</span>(dygraphs)</a>
<a class="sourceLine" id="cb14-9" data-line-number="9"></a>
<a class="sourceLine" id="cb14-10" data-line-number="10">goldChoice &lt;-<span class="st"> &quot;CHRIS/CME_GC1.1&quot;</span> <span class="co"># gold data from CME</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"></a>
<a class="sourceLine" id="cb14-12" data-line-number="12">dataChoices &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;WTI oil&quot;</span> =<span class="st"> &quot;FRED/DCOILWTICO&quot;</span>, <span class="co">#oil data from Fred</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13">                 <span class="st">&quot;Copper&quot;</span> =<span class="st"> &quot;ODA/PCOPP_USD&quot;</span>, <span class="co"># copper data from ODA</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14">                 <span class="st">&quot;Gold&quot;</span> =<span class="st"> &quot;CHRIS/CME_GC1.1&quot;</span>,</a>
<a class="sourceLine" id="cb14-15" data-line-number="15">                 <span class="st">&quot;Silver&quot;</span> =<span class="st"> &quot;LBMA/SILVER.1&quot;</span>,</a>
<a class="sourceLine" id="cb14-16" data-line-number="16">                 <span class="st">&quot;Copper&quot;</span> =<span class="st"> &quot;CHRIS/CME_HG1.1&quot;</span>,</a>
<a class="sourceLine" id="cb14-17" data-line-number="17">                 <span class="st">&quot;Iron Ore&quot;</span> =<span class="st"> &quot;ODA/PIORECR_USD&quot;</span>,</a>
<a class="sourceLine" id="cb14-18" data-line-number="18">                 <span class="st">&quot;Platinum&quot;</span> =<span class="st"> &quot;LPPM/PLAT.1&quot;</span>,</a>
<a class="sourceLine" id="cb14-19" data-line-number="19">                 <span class="st">&quot;Palladium&quot;</span> =<span class="st"> &quot;LPPM/PALL.1&quot;</span>,</a>
<a class="sourceLine" id="cb14-20" data-line-number="20">                 <span class="st">&quot;Bitcoin&quot;</span> =<span class="st"> &quot;BCHARTS/WEXUSD.1&quot;</span>)</a>
<a class="sourceLine" id="cb14-21" data-line-number="21"></a>
<a class="sourceLine" id="cb14-22" data-line-number="22">frequencyChoices &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;days&quot;</span> =<span class="st"> &quot;daily&quot;</span>,</a>
<a class="sourceLine" id="cb14-23" data-line-number="23">                      <span class="st">&quot;weeks&quot;</span> =<span class="st"> &quot;weekly&quot;</span>, </a>
<a class="sourceLine" id="cb14-24" data-line-number="24">                      <span class="st">&quot;months&quot;</span> =<span class="st"> &quot;monthly&quot;</span>)</a>
<a class="sourceLine" id="cb14-25" data-line-number="25"></a>
<a class="sourceLine" id="cb14-26" data-line-number="26">ui &lt;-<span class="st"> </span><span class="kw">fluidPage</span>(</a>
<a class="sourceLine" id="cb14-27" data-line-number="27">  <span class="kw">titlePanel</span>(<span class="st">&quot;Commodity&quot;</span>),</a>
<a class="sourceLine" id="cb14-28" data-line-number="28">  </a>
<a class="sourceLine" id="cb14-29" data-line-number="29">  <span class="kw">sidebarLayout</span>(</a>
<a class="sourceLine" id="cb14-30" data-line-number="30">    <span class="kw">sidebarPanel</span>(</a>
<a class="sourceLine" id="cb14-31" data-line-number="31">      <span class="kw">selectInput</span>(<span class="st">&quot;dataSet&quot;</span>,</a>
<a class="sourceLine" id="cb14-32" data-line-number="32">                  <span class="st">&quot;Commodity&quot;</span>,</a>
<a class="sourceLine" id="cb14-33" data-line-number="33">                  <span class="dt">choices =</span> dataChoices, <span class="co">#Freddie mac</span></a>
<a class="sourceLine" id="cb14-34" data-line-number="34">                  <span class="dt">selected =</span> <span class="st">&quot;WTI oil&quot;</span>),</a>
<a class="sourceLine" id="cb14-35" data-line-number="35">      </a>
<a class="sourceLine" id="cb14-36" data-line-number="36">      <span class="kw">selectInput</span>(<span class="st">&quot;frequency&quot;</span>,</a>
<a class="sourceLine" id="cb14-37" data-line-number="37">                  <span class="st">&quot;freq&quot;</span>,</a>
<a class="sourceLine" id="cb14-38" data-line-number="38">                  <span class="dt">choices =</span> frequencyChoices, </a>
<a class="sourceLine" id="cb14-39" data-line-number="39">                  <span class="dt">selected =</span> <span class="st">&quot;months&quot;</span>),</a>
<a class="sourceLine" id="cb14-40" data-line-number="40"></a>
<a class="sourceLine" id="cb14-41" data-line-number="41">      <span class="kw">dateRangeInput</span>(<span class="st">&quot;dateRange&quot;</span>,</a>
<a class="sourceLine" id="cb14-42" data-line-number="42">                     <span class="st">&quot;Date range&quot;</span>,</a>
<a class="sourceLine" id="cb14-43" data-line-number="43">                     <span class="dt">start =</span> <span class="st">&quot;1980-01-01&quot;</span>,</a>
<a class="sourceLine" id="cb14-44" data-line-number="44">                     <span class="dt">end   =</span> <span class="kw">Sys.Date</span>())</a>
<a class="sourceLine" id="cb14-45" data-line-number="45">    ),</a>
<a class="sourceLine" id="cb14-46" data-line-number="46">    <span class="kw">mainPanel</span>(</a>
<a class="sourceLine" id="cb14-47" data-line-number="47">      <span class="kw">dygraphOutput</span>(<span class="st">&quot;commodity&quot;</span>),</a>
<a class="sourceLine" id="cb14-48" data-line-number="48">      <span class="kw">dygraphOutput</span>(<span class="st">&quot;commodity_gold&quot;</span>)</a>
<a class="sourceLine" id="cb14-49" data-line-number="49">    )</a>
<a class="sourceLine" id="cb14-50" data-line-number="50">  )</a>
<a class="sourceLine" id="cb14-51" data-line-number="51">)</a>
<a class="sourceLine" id="cb14-52" data-line-number="52"></a>
<a class="sourceLine" id="cb14-53" data-line-number="53">server &lt;-<span class="st"> </span><span class="cf">function</span>(input, output, session) {</a>
<a class="sourceLine" id="cb14-54" data-line-number="54">  <span class="kw">Quandl.api_key</span>(<span class="st">&quot;d9EidiiDWoFESfdk5nPy&quot;</span>)</a>
<a class="sourceLine" id="cb14-55" data-line-number="55">  </a>
<a class="sourceLine" id="cb14-56" data-line-number="56">  gold &lt;-<span class="st"> </span><span class="kw">reactive</span>({</a>
<a class="sourceLine" id="cb14-57" data-line-number="57">    gold &lt;-<span class="st"> </span><span class="kw">Quandl</span>(goldChoice,</a>
<a class="sourceLine" id="cb14-58" data-line-number="58">                   <span class="dt">start_date =</span> <span class="kw">format</span>(input<span class="op">$</span>dateRange[<span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb14-59" data-line-number="59">                   <span class="dt">end_date =</span> <span class="kw">format</span>(input<span class="op">$</span>dateRange[<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb14-60" data-line-number="60">                   <span class="dt">order =</span> <span class="st">&quot;asc&quot;</span>,</a>
<a class="sourceLine" id="cb14-61" data-line-number="61">                   <span class="dt">type =</span> <span class="st">&quot;xts&quot;</span>,</a>
<a class="sourceLine" id="cb14-62" data-line-number="62">                   <span class="dt">collapse =</span> <span class="kw">as.character</span>(input<span class="op">$</span>frequency)</a>
<a class="sourceLine" id="cb14-63" data-line-number="63">    )</a>
<a class="sourceLine" id="cb14-64" data-line-number="64">  })  </a>
<a class="sourceLine" id="cb14-65" data-line-number="65">  </a>
<a class="sourceLine" id="cb14-66" data-line-number="66">  commodity &lt;-<span class="st"> </span><span class="kw">reactive</span>({</a>
<a class="sourceLine" id="cb14-67" data-line-number="67">    commodity &lt;-<span class="st"> </span><span class="kw">Quandl</span>(input<span class="op">$</span>dataSet,</a>
<a class="sourceLine" id="cb14-68" data-line-number="68">                        <span class="dt">start_date =</span> <span class="kw">format</span>(input<span class="op">$</span>dateRange[<span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb14-69" data-line-number="69">                        <span class="dt">end_date =</span> <span class="kw">format</span>(input<span class="op">$</span>dateRange[<span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb14-70" data-line-number="70">                        <span class="dt">order =</span> <span class="st">&quot;asc&quot;</span>,</a>
<a class="sourceLine" id="cb14-71" data-line-number="71">                        <span class="dt">type =</span> <span class="st">&quot;xts&quot;</span>,</a>
<a class="sourceLine" id="cb14-72" data-line-number="72">                        <span class="dt">collapse =</span> <span class="kw">as.character</span>(input<span class="op">$</span>frequency)</a>
<a class="sourceLine" id="cb14-73" data-line-number="73">    )</a>
<a class="sourceLine" id="cb14-74" data-line-number="74">  })</a>
<a class="sourceLine" id="cb14-75" data-line-number="75">  </a>
<a class="sourceLine" id="cb14-76" data-line-number="76">  output<span class="op">$</span>commodity &lt;-<span class="st"> </span><span class="kw">renderDygraph</span>({</a>
<a class="sourceLine" id="cb14-77" data-line-number="77">    dd &lt;-<span class="st"> </span><span class="kw">merge</span>(<span class="kw">gold</span>(), <span class="kw">commodity</span>())</a>
<a class="sourceLine" id="cb14-78" data-line-number="78">    dd<span class="op">$</span>ratio &lt;-<span class="st"> </span>dd[,<span class="dv">1</span>]<span class="op">/</span>dd[,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb14-79" data-line-number="79">    dd &lt;-<span class="st"> </span>dd[, <span class="dv">-1</span>, drop =<span class="st"> </span>F]</a>
<a class="sourceLine" id="cb14-80" data-line-number="80">    <span class="kw">colnames</span>(dd) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">names</span>(dataChoices)[dataChoices <span class="op">==</span><span class="st"> </span><span class="kw">isolate</span>(input<span class="op">$</span>dataSet)],</a>
<a class="sourceLine" id="cb14-81" data-line-number="81">                      <span class="st">&quot;Gold ratio&quot;</span>)</a>
<a class="sourceLine" id="cb14-82" data-line-number="82">    </a>
<a class="sourceLine" id="cb14-83" data-line-number="83">    <span class="kw">dygraph</span>(dd, </a>
<a class="sourceLine" id="cb14-84" data-line-number="84">            <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;Price history of&quot;</span>,</a>
<a class="sourceLine" id="cb14-85" data-line-number="85">                         <span class="kw">names</span>(dataChoices[dataChoices<span class="op">==</span>input<span class="op">$</span>dataSet]), </a>
<a class="sourceLine" id="cb14-86" data-line-number="86">                         <span class="dt">sep =</span> <span class="st">&quot; &quot;</span>),</a>
<a class="sourceLine" id="cb14-87" data-line-number="87">            <span class="dt">group =</span> <span class="st">&quot;gold group&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-88" data-line-number="88"><span class="st">      </span><span class="kw">dyAxis</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;$&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-89" data-line-number="89"><span class="st">      </span><span class="kw">dySeries</span>(<span class="st">&quot;Gold ratio&quot;</span>, <span class="dt">axis =</span> <span class="st">'y2'</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-90" data-line-number="90"><span class="st">      </span><span class="kw">dyOptions</span>(<span class="dt">axisLineWidth =</span> <span class="fl">1.5</span>, <span class="dt">fillGraph =</span> <span class="ot">TRUE</span>, <span class="dt">drawGrid =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb14-91" data-line-number="91">                <span class="dt">colors =</span> RColorBrewer<span class="op">::</span><span class="kw">brewer.pal</span>(<span class="dv">3</span>, <span class="st">&quot;Set1&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-92" data-line-number="92"><span class="st">      </span><span class="kw">dyRangeSelector</span>()</a>
<a class="sourceLine" id="cb14-93" data-line-number="93">  })</a>
<a class="sourceLine" id="cb14-94" data-line-number="94">  </a>
<a class="sourceLine" id="cb14-95" data-line-number="95">  output<span class="op">$</span>commodity_gold &lt;-<span class="st"> </span><span class="kw">renderDygraph</span>({</a>
<a class="sourceLine" id="cb14-96" data-line-number="96">    <span class="kw">dygraph</span>(<span class="kw">gold</span>(), </a>
<a class="sourceLine" id="cb14-97" data-line-number="97">            <span class="dt">main =</span> <span class="kw">paste0</span>(<span class="st">&quot;Ratio history of &quot;</span>,</a>
<a class="sourceLine" id="cb14-98" data-line-number="98">                          <span class="kw">names</span>(dataChoices[dataChoices<span class="op">==</span>input<span class="op">$</span>dataSet]),</a>
<a class="sourceLine" id="cb14-99" data-line-number="99">                                <span class="st">&quot;/Gold&quot;</span>),</a>
<a class="sourceLine" id="cb14-100" data-line-number="100">            <span class="dt">group =</span> <span class="st">&quot;gold group&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-101" data-line-number="101"><span class="st">      </span><span class="kw">dyAxis</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;$&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-102" data-line-number="102"><span class="st">      </span><span class="kw">dyOptions</span>(<span class="dt">axisLineWidth =</span> <span class="fl">1.5</span>, <span class="dt">fillGraph =</span> <span class="ot">TRUE</span>, <span class="dt">drawGrid =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb14-103" data-line-number="103"><span class="st">      </span><span class="kw">dyRangeSelector</span>()</a>
<a class="sourceLine" id="cb14-104" data-line-number="104">  })</a>
<a class="sourceLine" id="cb14-105" data-line-number="105">}</a>
<a class="sourceLine" id="cb14-106" data-line-number="106"></a>
<a class="sourceLine" id="cb14-107" data-line-number="107"><span class="kw">shinyApp</span>(ui, server)</a></code></pre></div>
</div>
<div id="portfolio-analysis" class="slide section level1">
<h1>Portfolio analysis</h1>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># 53-portfolio-2.R</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="kw">library</span>(tidyquant)</a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="kw">library</span>(dygraphs)</a>
<a class="sourceLine" id="cb15-7" data-line-number="7"></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co"># SPY: SPDR S&amp;P 500 ETF Trust</span></a>
<a class="sourceLine" id="cb15-9" data-line-number="9"><span class="co"># IJS: iShares S&amp;P SmallCap 600 Value Idx</span></a>
<a class="sourceLine" id="cb15-10" data-line-number="10"><span class="co"># EFA: iShares MSCI EAFE Index Fund (ETF): large- and mid-capitalization developed market equities, excluding the U.S. and Canada.</span></a>
<a class="sourceLine" id="cb15-11" data-line-number="11"><span class="co"># EEM: iShares MSCI Emerging Markets Indx (ETF)</span></a>
<a class="sourceLine" id="cb15-12" data-line-number="12"><span class="co"># AGG: iShares Barclays Aggregate Bond Fund: total U.S. investment-grade bond </span></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"></a>
<a class="sourceLine" id="cb15-14" data-line-number="14">symbols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;SPY&quot;</span>,<span class="st">&quot;IJS&quot;</span>,<span class="st">&quot;EFA&quot;</span>,<span class="st">&quot;EEM&quot;</span>,<span class="st">&quot;AGG&quot;</span>)</a>
<a class="sourceLine" id="cb15-15" data-line-number="15"></a>
<a class="sourceLine" id="cb15-16" data-line-number="16">prices &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="st">  </span><span class="kw">getSymbols</span>(symbols, <span class="dt">src =</span> <span class="st">'yahoo'</span>, <span class="dt">from =</span> <span class="st">&quot;2005-01-01&quot;</span>, </a>
<a class="sourceLine" id="cb15-18" data-line-number="18">             <span class="dt">auto.assign =</span> <span class="ot">TRUE</span>, <span class="dt">warnings =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-19" data-line-number="19"><span class="st">  </span>purrr<span class="op">::</span><span class="kw">map</span>(<span class="op">~</span><span class="kw">Cl</span>(<span class="kw">get</span>(.))) <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># Cl is from quantmod: get Close price</span></a>
<a class="sourceLine" id="cb15-20" data-line-number="20"><span class="st">  </span><span class="kw">reduce</span>(merge) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-21" data-line-number="21"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span>(symbols)</a>
<a class="sourceLine" id="cb15-22" data-line-number="22"></a>
<a class="sourceLine" id="cb15-23" data-line-number="23">prices_monthly &lt;-<span class="st"> </span><span class="kw">to.monthly</span>(prices, <span class="dt">indexAt =</span> <span class="st">&quot;first&quot;</span>, <span class="dt">OHLC =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb15-24" data-line-number="24">portfolioComponentReturns &lt;-<span class="st"> </span><span class="kw">na.omit</span>(<span class="kw">Return.calculate</span>(prices_monthly,</a>
<a class="sourceLine" id="cb15-25" data-line-number="25">                                                      <span class="dt">method =</span> <span class="st">&quot;log&quot;</span>))</a>
<a class="sourceLine" id="cb15-26" data-line-number="26"></a>
<a class="sourceLine" id="cb15-27" data-line-number="27">plot_ticker &lt;-<span class="st"> </span><span class="cf">function</span>(ticker) {</a>
<a class="sourceLine" id="cb15-28" data-line-number="28">  ts &lt;-<span class="st"> </span>portfolioComponentReturns[, ticker, drop =<span class="st"> </span>F]</a>
<a class="sourceLine" id="cb15-29" data-line-number="29">  sd_lt &lt;-<span class="st"> </span><span class="kw">StdDev</span>(ts)</a>
<a class="sourceLine" id="cb15-30" data-line-number="30">  </a>
<a class="sourceLine" id="cb15-31" data-line-number="31">  sd_overtime &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">rollapply</span>(ts, <span class="dv">20</span>, <span class="cf">function</span>(x) <span class="kw">StdDev</span>(x)), <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb15-32" data-line-number="32">  </a>
<a class="sourceLine" id="cb15-33" data-line-number="33">  sd_overtime<span class="op">$</span>SD_Longterm &lt;-<span class="st"> </span>sd_lt</a>
<a class="sourceLine" id="cb15-34" data-line-number="34">  </a>
<a class="sourceLine" id="cb15-35" data-line-number="35">  <span class="kw">dygraph</span>(sd_overtime,</a>
<a class="sourceLine" id="cb15-36" data-line-number="36">          <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;Volatility history of &quot;</span>, ticker)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-37" data-line-number="37"><span class="st">    </span><span class="kw">dyAxis</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;%&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-38" data-line-number="38"><span class="st">    </span><span class="kw">dyOptions</span>(<span class="dt">axisLineWidth =</span> <span class="fl">1.5</span>, <span class="dt">fillGraph =</span> <span class="ot">FALSE</span>, <span class="dt">drawGrid =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-39" data-line-number="39"><span class="st">    </span><span class="kw">dyRangeSelector</span>()</a>
<a class="sourceLine" id="cb15-40" data-line-number="40">}</a>
<a class="sourceLine" id="cb15-41" data-line-number="41"></a>
<a class="sourceLine" id="cb15-42" data-line-number="42"><span class="kw">plot_ticker</span>(<span class="st">&quot;SPY&quot;</span>)</a>
<a class="sourceLine" id="cb15-43" data-line-number="43"><span class="kw">plot_ticker</span>(<span class="st">&quot;IJS&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">w =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span>, <span class="fl">0.25</span>, <span class="fl">0.10</span>)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2"></a>
<a class="sourceLine" id="cb16-3" data-line-number="3">w_<span class="dv">1</span> &lt;-<span class="st"> </span>w[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">w_<span class="dv">2</span> &lt;-<span class="st"> </span>w[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">w_<span class="dv">3</span> &lt;-<span class="st"> </span>w[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb16-6" data-line-number="6">w_<span class="dv">4</span> &lt;-<span class="st"> </span>w[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">w_<span class="dv">5</span> &lt;-<span class="st"> </span>w[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb16-8" data-line-number="8"></a>
<a class="sourceLine" id="cb16-9" data-line-number="9">asset1 &lt;-<span class="st"> </span>portfolioComponentReturns[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb16-10" data-line-number="10">asset2 &lt;-<span class="st"> </span>portfolioComponentReturns[,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb16-11" data-line-number="11">asset3 &lt;-<span class="st"> </span>portfolioComponentReturns[,<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb16-12" data-line-number="12">asset4 &lt;-<span class="st"> </span>portfolioComponentReturns[,<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb16-13" data-line-number="13">asset5 &lt;-<span class="st"> </span>portfolioComponentReturns[,<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb16-14" data-line-number="14"></a>
<a class="sourceLine" id="cb16-15" data-line-number="15">portfolio_returns_byhand &lt;-<span class="st">   </span></a>
<a class="sourceLine" id="cb16-16" data-line-number="16"><span class="st">  </span>(w_<span class="dv">1</span> <span class="op">*</span><span class="st"> </span>asset1) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-17" data-line-number="17"><span class="st">  </span>(w_<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>asset2) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-18" data-line-number="18"><span class="st">  </span>(w_<span class="dv">3</span> <span class="op">*</span><span class="st"> </span>asset3) <span class="op">+</span></a>
<a class="sourceLine" id="cb16-19" data-line-number="19"><span class="st">  </span>(w_<span class="dv">4</span> <span class="op">*</span><span class="st"> </span>asset4) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-20" data-line-number="20"><span class="st">  </span>(w_<span class="dv">5</span> <span class="op">*</span><span class="st"> </span>asset5)</a>
<a class="sourceLine" id="cb16-21" data-line-number="21"></a>
<a class="sourceLine" id="cb16-22" data-line-number="22"><span class="kw">names</span>(portfolio_returns_byhand) &lt;-<span class="st"> &quot;abs returns&quot;</span></a>
<a class="sourceLine" id="cb16-23" data-line-number="23"></a>
<a class="sourceLine" id="cb16-24" data-line-number="24">portfolio_returns_xts_rebalanced_monthly &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb16-25" data-line-number="25"><span class="st">  </span><span class="kw">Return.portfolio</span>(portfolioComponentReturns, <span class="dt">weights =</span> w,</a>
<a class="sourceLine" id="cb16-26" data-line-number="26">                   <span class="dt">rebalance_on =</span> <span class="st">&quot;months&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-27" data-line-number="27"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span>(<span class="st">&quot;month-rebal returns&quot;</span>)</a>
<a class="sourceLine" id="cb16-28" data-line-number="28"></a>
<a class="sourceLine" id="cb16-29" data-line-number="29">portfolio_returns_xts_rebalanced_yearly &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb16-30" data-line-number="30"><span class="st">  </span><span class="kw">Return.portfolio</span>(portfolioComponentReturns, <span class="dt">weights =</span> w,</a>
<a class="sourceLine" id="cb16-31" data-line-number="31">                   <span class="dt">rebalance_on =</span> <span class="st">&quot;years&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-32" data-line-number="32"><span class="st">  `</span><span class="dt">colnames&lt;-</span><span class="st">`</span>(<span class="st">&quot;year-rebal returns&quot;</span>)</a>
<a class="sourceLine" id="cb16-33" data-line-number="33"></a>
<a class="sourceLine" id="cb16-34" data-line-number="34"><span class="kw">head</span>(portfolio_returns_byhand)</a>
<a class="sourceLine" id="cb16-35" data-line-number="35"><span class="kw">head</span>(portfolio_returns_xts_rebalanced_monthly)</a>
<a class="sourceLine" id="cb16-36" data-line-number="36"><span class="kw">head</span>(portfolio_returns_xts_rebalanced_yearly)</a>
<a class="sourceLine" id="cb16-37" data-line-number="37"></a>
<a class="sourceLine" id="cb16-38" data-line-number="38">plot_portfolio &lt;-<span class="st"> </span><span class="cf">function</span>(portfolio_returns) {</a>
<a class="sourceLine" id="cb16-39" data-line-number="39">  portfolio_returns_cum &lt;-<span class="st"> </span><span class="kw">cumprod</span>(portfolio_returns <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb16-40" data-line-number="40">  </a>
<a class="sourceLine" id="cb16-41" data-line-number="41">  <span class="kw">library</span>(htmltools)</a>
<a class="sourceLine" id="cb16-42" data-line-number="42">  </a>
<a class="sourceLine" id="cb16-43" data-line-number="43">  g1 &lt;-<span class="st"> </span><span class="kw">dygraph</span>(portfolio_returns,</a>
<a class="sourceLine" id="cb16-44" data-line-number="44">          <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;Return&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-45" data-line-number="45"><span class="st">    </span><span class="kw">dyAxis</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;%&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-46" data-line-number="46"><span class="st">    </span><span class="kw">dyOptions</span>(<span class="dt">axisLineWidth =</span> <span class="fl">1.5</span>, <span class="dt">fillGraph =</span> <span class="ot">FALSE</span>, <span class="dt">drawGrid =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-47" data-line-number="47"><span class="st">    </span><span class="kw">dyRangeSelector</span>()</a>
<a class="sourceLine" id="cb16-48" data-line-number="48">  </a>
<a class="sourceLine" id="cb16-49" data-line-number="49">  g2 &lt;-<span class="st"> </span><span class="kw">dygraph</span>(portfolio_returns_cum, </a>
<a class="sourceLine" id="cb16-50" data-line-number="50">          <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;Cumulative Return&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-51" data-line-number="51"><span class="st">    </span><span class="kw">dyAxis</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;%&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-52" data-line-number="52"><span class="st">    </span><span class="kw">dyOptions</span>(<span class="dt">axisLineWidth =</span> <span class="fl">1.5</span>, <span class="dt">fillGraph =</span> <span class="ot">FALSE</span>, <span class="dt">drawGrid =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-53" data-line-number="53"><span class="st">    </span><span class="kw">dyRangeSelector</span>()</a>
<a class="sourceLine" id="cb16-54" data-line-number="54">  </a>
<a class="sourceLine" id="cb16-55" data-line-number="55">  sd_lt &lt;-<span class="st"> </span><span class="kw">StdDev</span>(portfolio_returns)</a>
<a class="sourceLine" id="cb16-56" data-line-number="56">  </a>
<a class="sourceLine" id="cb16-57" data-line-number="57">  sd_overtime &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb16-58" data-line-number="58"><span class="st">    </span><span class="kw">round</span>(<span class="kw">rollapply</span>(portfolio_returns, <span class="dv">20</span>, <span class="cf">function</span>(x) <span class="kw">StdDev</span>(x)), <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb16-59" data-line-number="59">  </a>
<a class="sourceLine" id="cb16-60" data-line-number="60">  sd_overtime<span class="op">$</span>SD_Longterm &lt;-<span class="st"> </span>sd_lt</a>
<a class="sourceLine" id="cb16-61" data-line-number="61">  </a>
<a class="sourceLine" id="cb16-62" data-line-number="62">  g3 &lt;-<span class="st"> </span><span class="kw">dygraph</span>(sd_overtime, </a>
<a class="sourceLine" id="cb16-63" data-line-number="63">          <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;Volatility history of &quot;</span>, <span class="st">&quot;portfolio_returns_cum&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-64" data-line-number="64"><span class="st">    </span><span class="kw">dyAxis</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;%&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-65" data-line-number="65"><span class="st">    </span><span class="kw">dyOptions</span>(<span class="dt">axisLineWidth =</span> <span class="fl">1.5</span>, <span class="dt">fillGraph =</span> <span class="ot">FALSE</span>, <span class="dt">drawGrid =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-66" data-line-number="66"><span class="st">    </span><span class="kw">dyRangeSelector</span>()</a>
<a class="sourceLine" id="cb16-67" data-line-number="67">  </a>
<a class="sourceLine" id="cb16-68" data-line-number="68">  <span class="kw">browsable</span>(</a>
<a class="sourceLine" id="cb16-69" data-line-number="69">    <span class="kw">tagList</span>(g1, g2, g3)</a>
<a class="sourceLine" id="cb16-70" data-line-number="70">  )</a>
<a class="sourceLine" id="cb16-71" data-line-number="71">}</a>
<a class="sourceLine" id="cb16-72" data-line-number="72"></a>
<a class="sourceLine" id="cb16-73" data-line-number="73"><span class="kw">plot_portfolio</span>(portfolio_returns_byhand)</a>
<a class="sourceLine" id="cb16-74" data-line-number="74"><span class="kw">plot_portfolio</span>(portfolio_returns_xts_rebalanced_monthly)</a>
<a class="sourceLine" id="cb16-75" data-line-number="75"><span class="kw">plot_portfolio</span>(portfolio_returns_xts_rebalanced_yearly)</a>
<a class="sourceLine" id="cb16-76" data-line-number="76"></a>
<a class="sourceLine" id="cb16-77" data-line-number="77">plot_bband &lt;-<span class="st"> </span><span class="cf">function</span>(ticker, <span class="dt">n_days =</span> <span class="dv">93</span>) {</a>
<a class="sourceLine" id="cb16-78" data-line-number="78">  ts &lt;-<span class="st"> </span>prices[, ticker, drop =<span class="st"> </span>F]</a>
<a class="sourceLine" id="cb16-79" data-line-number="79">  sd_overtime &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">rollapply</span>(ts, n_days, <span class="cf">function</span>(x) <span class="kw">StdDev</span>(x)), <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb16-80" data-line-number="80">  mean_overtime &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">rollapply</span>(ts, n_days, <span class="cf">function</span>(x) <span class="kw">mean</span>(x)), <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb16-81" data-line-number="81">  new_ts &lt;-<span class="st"> </span>ts</a>
<a class="sourceLine" id="cb16-82" data-line-number="82">  new_ts<span class="op">$</span>ma &lt;-<span class="st"> </span>mean_overtime</a>
<a class="sourceLine" id="cb16-83" data-line-number="83">  new_ts<span class="op">$</span>u2 &lt;-<span class="st"> </span>mean_overtime <span class="op">+</span><span class="st"> </span>sd_overtime <span class="op">*</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb16-84" data-line-number="84">  new_ts<span class="op">$</span>d2 &lt;-<span class="st"> </span>mean_overtime <span class="op">-</span><span class="st"> </span>sd_overtime <span class="op">*</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb16-85" data-line-number="85">  </a>
<a class="sourceLine" id="cb16-86" data-line-number="86">  <span class="kw">dygraph</span>(new_ts,</a>
<a class="sourceLine" id="cb16-87" data-line-number="87">          <span class="dt">main =</span> <span class="kw">paste0</span>(<span class="st">&quot;Bollinger Bands &quot;</span>, ticker)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-88" data-line-number="88"><span class="st">    </span><span class="kw">dyAxis</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">label =</span> <span class="st">&quot;&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-89" data-line-number="89"><span class="st">    </span><span class="kw">dySeries</span>(<span class="st">&quot;ma&quot;</span>, <span class="dt">strokePattern =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-90" data-line-number="90"><span class="st">    </span><span class="kw">dyOptions</span>(<span class="dt">axisLineWidth =</span> <span class="fl">1.5</span>, <span class="dt">fillGraph =</span> <span class="ot">FALSE</span>, <span class="dt">drawGrid =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-91" data-line-number="91"><span class="st">    </span><span class="kw">dyRangeSelector</span>()</a>
<a class="sourceLine" id="cb16-92" data-line-number="92">}</a>
<a class="sourceLine" id="cb16-93" data-line-number="93"></a>
<a class="sourceLine" id="cb16-94" data-line-number="94"><span class="kw">plot_bband</span>(<span class="st">&quot;SPY&quot;</span>)</a></code></pre></div>
</div>

  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

</body>
</html>
