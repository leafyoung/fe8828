---
title: "Assignment4"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidyr)
library(lubridate)
library(bizdays)
library(grid)
library(dplyr)
library(knitr)
library(DT)
library(xtable)
library(kableExtra)
library(formattable)
library(ggplot2)
library(gridExtra)
bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
```

## Finding 1
  * Age vs balance for each job category
```{r}
ggplot(bank, aes(age, balance, color = job)) + geom_point() + geom_smooth()

```

#Finding 2
  * Education distribution in each job
```{r}
ggplot(data = bank, mapping = aes(x = job, fill = education)) +
geom_bar() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

#Finding 3 
  * Max and min balance for each age category
```{r echo=FALSE}
ggplot(data = bank) +
stat_summary(
mapping = aes(x = age, y = balance,color=age),
fun.ymin = min,
fun.ymax = max,
fun.y = median
)

```


#Finding 4
  * Call duration vs education grouped by education
```{r echo=FALSE}
ggplot(data = bank) +
geom_point(mapping = aes(x = age, y = duration)) +
facet_grid( ~ education)

```

#Finding 5
  * Previous campaigns vs marital density
```{r echo=FALSE}
ggplot(bank, aes(previous)) +
geom_density(aes(fill = marital), alpha = 0.7) +
xlim(1, 10)

```


# Finding #6 Median call duration vs job
```{r echo=FALSE}
df6 <- bank  %>%
  group_by(job) %>% summarize(count=n(),'mean duration'=mean(duration),'median duration'=median(duration)) 
#select(age,job,marital,education, duration) %>%
ggplot(df6,aes(`median duration`,job)) +
  geom_point(aes(`median duration`,job,color=job))+
  geom_smooth(data=df6, aes(`median duration`,job), method = 'loess', formula ='y ~ x',colour="green")
 
```

#Finding 7
  * Relationship between way of contacts vs call duration
  
```{r echo=FALSE}
df7 <- bank %>% dplyr::filter(contact!="unknown") %>% group_by(contact,marital) %>% summarize(ave_duration=mean(duration))
ggplot(df7) +
  geom_point(aes(x = contact, y = ave_duration,color=marital))+
  coord_flip() 

```

#Finding 8
  * Ave call duration vs call month
```{r}
df8 <- bank %>% group_by(month, job) %>% summarise(`Mean Contact`=mean(duration))
ggplot(df8,aes(month,`Mean Contact`))  +
  geom_point(aes(month,`Mean Contact`,color=month))+
  geom_line(data=df8, 
              aes(month,`Mean Contact`),colour="orange")
```

#Finding 9
  * Bank Balance vs Marital Status
```{r}
ggplot(bank) +
  geom_point(data=dplyr::filter(bank, marital %in% c("married","single","divorced")), aes(age,balance,color=marital)) + 
  geom_smooth(data=filter(bank, marital=="married"), 
              aes(age,balance),color="red")+
  geom_smooth(data=filter(bank, marital=="single"), 
              aes(age,balance),color="blue")+
  geom_smooth(data=filter(bank, marital=="divorced"), 
              aes(age,balance),color="green")
```

#Finding 10
  * Relationship between default and number of loans, categorized by education
```{r}
housing_loan <- ggplot(bank) + 
  geom_bar(data=dplyr::filter(bank,housing=="yes" & loan=="yes"),aes(x=education,fill=default)) + 
  coord_flip()
housing <- ggplot(bank) + 
  geom_bar(data=dplyr::filter(bank,housing=="yes" & loan=="no"),aes(x=education,fill=default)) + 
  coord_flip()
loan <- ggplot(bank) + 
  geom_bar(data=dplyr::filter(bank,housing=="no" & loan=="yes"),aes(x=education,fill=default)) + 
  coord_flip()
neither <- ggplot(bank) + 
  geom_bar(data=dplyr::filter(bank,housing=="no" & loan=="no"),aes(x=education,fill=default)) + 
  coord_flip()

grid.arrange(housing_loan, housing, loan, neither, ncol=2, nrow=2)
```

