---
title: "OptimalChoice"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## How long to make a choice
step1: make_choice <- function(N, split_number){}
```{r makeChoice}
make_choice <- function(N, split_number){
  input_list <- sample(1:N, N, replace = FALSE)
  if(split_number == 0){
    best_n<-0} #when split_number == 0 (size of evaluation group is 0), best_n is assigned to be zero (best_n <- 1 should also work in this case, since the condition below is >=)
  else{
  best_n <- max(input_list[1:split_number])}
  for (i in (split_number+1):N){
    in_n <- input_list[i]
    if(in_n >= best_n){  
      break
      }
  }
  in_n
}

find_optimal <- function(N){
  split_res <- 1:N #a vector to store the mean of the choices for each different split_number of a particular N
  countOptimal <- rep(0,N)
  res <- rep(0,1000)
for(split_number in 0: (N-1)){
    for(j in 1:1000){
    choice <- make_choice(N,split_number)
    if (choice == N) {
      countOptimal[split_number+1] <- countOptimal[split_number+1]+1/1000}
    #each time choice == N (optimal choice made), the probability increase by 1/1000 (1000 is the number of times make_choice is called for each split_number)
    res[j]<-choice
    }
  split_res[split_number+1] <- mean(res)
}
  plot(0:(N-1),split_res, main = "Average Choice with different split number", sub = paste("N =",N), xlab = "split_number", ylab = "Average choice")
  plot(0:(N-1),countOptimal, main = "Probability of making the best choice with different split number", sub = paste("N =",N), xlab = "split_number", ylab = "Probability")
  best <- match(max(countOptimal), countOptimal)-1
  cat("best split number for N =", N, "is", best, ", and the probability of getting the optimal choice is ", countOptimal[best+1])
}

find_optimal(3)
find_optimal(10)
find_optimal(100)
find_optimal(200)
```
It could be observed that the optimal split number is roughly 0.4*N and the probability of getting the optimal choice is around 40%.


## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.