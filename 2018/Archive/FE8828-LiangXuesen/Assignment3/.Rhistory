mutate(.,Valuation=.$Open_Interest*(.$Bid+.$Ask)*0.5)
## 1.2
df2 <- group_by(df,Call_Put) %>% summarise(Valuation_Sum=sum(Valuation)) %>% rbind(.,data.frame(Call_Put="C&P",Valuation_Sum=sum(.$Valuation_Sum)))
## 1.3
df <- mutate(df,In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% filter(In_Money=="Y") %>% summarise(OI_Sum=sum(Open_Interest))
## 1.1
df <- read_xlsx("Q3OptionData.xlsx", sheet="data") %>%
rename(.,Expiry_Date=E, Strike=X,Open_Interest=OI,Underlying=S,Call_Put=CP,Bid=B,Ask=A) %>%
mutate(.,Valuation=.$Open_Interest*(.$Bid+.$Ask)*0.5)
## 1.2
df2 <- group_by(df,Call_Put) %>% summarise(Valuation_Sum=sum(Valuation)) %>% rbind(.,data.frame(Call_Put="C&P",Valuation_Sum=sum(.$Valuation_Sum)))
## 1.3
df <- mutate(df,In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% filter(In_Money=="Y") %>% summarise(OI_Sum=sum(Open_Interest))
df <- mutate(df,In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% filter(In_Money=="Y") %>% summarise(OI_Sum=sum(Open_Interest))
## 1.1
df <- read_xlsx("Q3OptionData.xlsx", sheet="data") %>%
rename(.,Expiry_Date=E, Strike=X,Open_Interest=OI,Underlying=S,Call_Put=CP,Bid=B,Ask=A) %>%
mutate(.,Valuation=.$Open_Interest*(.$Bid+.$Ask)*0.5)
## 1.2
df2 <- group_by(df,Call_Put) %>% summarise(Valuation_Sum=sum(Valuation)) %>% rbind(.,data.frame(Call_Put="C&P",Valuation_Sum=sum(.$Valuation_Sum)))
## 1.3
df <- mutate(df,In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% filter(In_Money=="Y") %>% summarise(OI_Sum=sum(Open_Interest))
View(df)
df3 <- group_by(df,Call_Put) %>% filter(In_Money=="Y") %>% summarise(OI_Sum=sum(Open_Interest))
df3 <- group_by(df,Call_Put) %>% filter(In_Money=="Y") %>% summarise(.,OI_Sum=sum(Open_Interest))
df3 <- group_by(df,Call_Put) %>% filter(In_Money=="Y") %>% summarise(.,OI_Sum=sum(Open_Interest))
df <- mutate(df,In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
View(df)
## 1.1
df <- read_xlsx("Q3OptionData.xlsx", sheet="data") %>%
rename(.,Expiry_Date=E, Strike=X,Open_Interest=OI,Underlying=S,Call_Put=CP,Bid=B,Ask=A) %>%
mutate(.,Valuation=.$Open_Interest*(.$Bid+.$Ask)*0.5)
## 1.2
df2 <- group_by(df,Call_Put) %>% summarise(Valuation_Sum=sum(Valuation)) %>% rbind(.,data.frame(Call_Put="C&P",Valuation_Sum=sum(.$Valuation_Sum)))
## 1.3
df <- mutate(df,In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% filter(In_Money=="Y") %>% summarise(OI_Sum=sum(Open_Interest))
df3 <- group_by(df,Call_Put) %>% filter(.,In_Money=="Y") %>% summarise(OI_Sum=sum(Open_Interest))
df3 <- group_by(df,Call_Put,In_Money) %>% filter(.,In_Money=="Y") %>% summarise(OI_Sum=sum(Open_Interest))
library(tidyverse)
library(tidyr)
library(readxl)
library(fOptions)
## 1.1
df <- read_xlsx("Q3OptionData.xlsx", sheet="data") %>%
rename(.,Expiry_Date=E, Strike=X,Open_Interest=OI,Underlying=S,Call_Put=CP,Bid=B,Ask=A) %>%
mutate(.,Valuation=.$Open_Interest*(.$Bid+.$Ask)*0.5)
## 1.2
df2 <- group_by(df,Call_Put) %>% summarise(Valuation_Sum=sum(Valuation)) %>% rbind(.,data.frame(Call_Put="C&P",Valuation_Sum=sum(.$Valuation_Sum)))
## 1.3
df <- mutate(df,In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% filter(In_Money=="Y") %>% summarise(OI_Sum=sum(Open_Interest))
for(i in c(1:nrow(df))){
df[i,]$Volty <- GBSVolatility(0.5*(df[i,]$Bid+df[i,]$Ask), df[i,]$Call_Put, df[i,]$Underlying, df[i,]$Strike, as.numeric((as.Date(df[i,]$Expiry_Date) - as.Date(Sys.Date())))/365, 0.03, 0)
}
for(i in c(1:nrow(df))){
GBSVolatility(0.5*(df[i,]$Bid+df[i,]$Ask), df[i,]$Call_Put, df[i,]$Underlying, df[i,]$Strike, as.numeric((as.Date(df[i,]$Expiry_Date) - as.Date(Sys.Date())))/365, 0.03, 0)
}
View(df)
group_by(df,Call_Put)
group_by(df,Call_Put) %>% filter(In_Money=='Y')
filter(df,In_Money=='Y')
df <- read_xlsx("Q3OptionData.xlsx", sheet="data") %>%
rename(.,Expiry_Date=E, Strike=X,Open_Interest=OI,Underlying=S,Call_Put=CP,Bid=B,Ask=A) %>%
mutate(.,Valuation=.$Open_Interest*(.$Bid+.$Ask)*0.5)
View(df)
df2 <- group_by(df,Call_Put) %>% summarise(Valuation_Sum=sum(Valuation)) %>% rbind(.,data.frame(Call_Put="C&P",Valuation_Sum=sum(.$Valuation_Sum)))
View(df2)
df <- mutate(df,In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
View(df)
filter(df,In_Money='Y')
filter(df,In_Money =='Y')
filter_(df,In_Money =='Y')
filter_(df,In_Money =='Y')
df <- mutate(df, In_Money_Test=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
## 1.1
df <- read_xlsx("Q3OptionData.xlsx", sheet="data") %>%
rename(.,Expiry_Date=E, Strike=X,Open_Interest=OI,Underlying=S,Call_Put=CP,Bid=B,Ask=A) %>%
mutate(.,Valuation=.$Open_Interest*(.$Bid+.$Ask)*0.5)
## 1.2
df2 <- group_by(df,Call_Put) %>% summarise(Valuation_Sum=sum(Valuation)) %>% rbind(.,data.frame(Call_Put="C&P",Valuation_Sum=sum(.$Valuation_Sum)))
## 1.3
df <- mutate(df, In_Money_Test=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- filter(df,In_Money_Test =='Y') %>% summarise(OI_Sum=sum(Open_Interest))
View(df)
filter(df,In_Money_Test =='Y')
filter(df,Call_Put=='c')
Filter(df,Call_Put=='c')
filter(df,In_Money_Test == 'Y')
## 1.1
df <- read_xlsx("Q3OptionData.xlsx", sheet="data") %>%
rename(.,Expiry_Date=E, Strike=X,Open_Interest=OI,Underlying=S,Call_Put=CP,Bid=B,Ask=A) %>%
mutate(.,Valuation=.$Open_Interest*(.$Bid+.$Ask)*0.5)
## 1.2
df2 <- group_by(df,Call_Put) %>% summarise(Valuation_Sum=sum(Valuation)) %>% rbind(.,data.frame(Call_Put="C&P",Valuation_Sum=sum(.$Valuation_Sum)))
## 1.3
df <- mutate(df, In_Money_Test=ifelse(df$Call_Put=='C',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- filter(df,In_Money_Test == 'Y') %>% summarise(OI_Sum=sum(Open_Interest))
View(df)
library(tidyverse)
library(tidyr)
library(readxl)
df <- read_xlsx("Q3OptionData.xlsx", sheet="data") %>%
rename(.,Expiry_Date=E, Strike=X,Open_Interest=OI,Underlying=S,Call_Put=CP,Bid=B,Ask=A) %>%
mutate(.,Valuation=.$Open_Interest*(.$Bid+.$Ask)*0.5)
df2 <- group_by(df,Call_Put) %>% summarise(Valuation_Sum=sum(Valuation)) %>% rbind(.,data.frame(Call_Put="C&P",Valuation_Sum=sum(.$Valuation_Sum)))
df <- mutate(df, In_Money_Test=ifelse(df$Call_Put=='C',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
group_by(df,Call_Put) %>% filter(In_Money_Test == 'Y')
df3 <- group_by(df,Call_Put) %>% filter(In_Money_Test == 'Y') %>% summarise(OI_Sum=sum(Open_Interest))
View(df3)
df <- mutate(df, In_Money=ifelse(df$Call_Put=='C',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% filter(In_Money == "Y") %>% summarise(OI_Sum=sum(Open_Interest))
View(df3)
df <- mutate(df, In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% filter(In_Money == "Y") %>% summarise(OI_Sum=sum(Open_Interest))
View(df3)
for(i in c(1:5)){
cat(GBSVolatility(0.5*(df[i,]$Bid+df[i,]$Ask), df[i,]$Call_Put, df[i,]$Underlying, df[i,]$Strike, as.numeric((as.Date(df[i,]$Expiry_Date) - as.Date(Sys.Date())))/365, 0.03, 0))
}
library(fOptions)
df <- mutate(df, In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% filter(In_Money == "Y") %>% summarise(OI_Sum=sum(Open_Interest))
for(i in c(1:5)){
cat(GBSVolatility(0.5*(df[i,]$Bid+df[i,]$Ask), df[i,]$Call_Put, df[i,]$Underlying, df[i,]$Strike, as.numeric((as.Date(df[i,]$Expiry_Date) - as.Date(Sys.Date())))/365, 0.03, 0))
}
library(tidyverse)
library(fOptions)
library(tidyverse)
library(tidyr)
library(readxl)
df <- mutate(df, In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% filter(In_Money == "Y") %>% summarise(OI_Sum=sum(Open_Interest))
df <- mutate(df, In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% filter(In_Money == "Y") %>% summarise(OI_Sum=sum(Open_Interest))
df <- mutate(df, In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% filter(In_Money == "Y") %>% summarise(OI_Sum=sum(Open_Interest))
df <- mutate(df, In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% filter(In_Money == "Y") %>% summarise(OI_Sum=sum(Open_Interest))
df3 <- group_by(df,Call_Put) %>% dplyr::filter(In_Money == "Y") %>% summarise(OI_Sum=sum(Open_Interest))
View(df3)
df<- mutate(df,Vol=0)
df<- mutate(df,Vol=0)
for(i in c(1:5)){
df[i,]$Vol = GBSVolatility(0.5*(df[i,]$Bid+df[i,]$Ask), df[i,]$Call_Put, df[i,]$Underlying, df[i,]$Strike, as.numeric((as.Date(df[i,]$Expiry_Date) - as.Date(Sys.Date())))/365, 0.03, 0)
}
View(df)
library(fOptions)
library(tidyverse)
library(tidyr)
library(readxl)
## 1.1
df <- read_xlsx("Q3OptionData.xlsx", sheet="data") %>%
rename(.,Expiry_Date=E, Strike=X,Open_Interest=OI,Underlying=S,Call_Put=CP,Bid=B,Ask=A) %>%
mutate(.,Valuation=.$Open_Interest*(.$Bid+.$Ask)*0.5)
## 1.2
df2 <- group_by(df,Call_Put) %>% summarise(Valuation_Sum=sum(Valuation)) %>% rbind(.,data.frame(Call_Put="C&P",Valuation_Sum=sum(.$Valuation_Sum)))
## 1.3
df <- mutate(df, In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% dplyr::filter(In_Money == "Y") %>% summarise(OI_Sum=sum(Open_Interest))
## 1.4
df<- mutate(df,Volatility_Value=0)
for(i in c(1:nrow(df))){
df[i,]$Volatility_Value = round(GBSVolatility(0.5*(df[i,]$Bid+df[i,]$Ask), df[i,]$Call_Put, df[i,]$Underlying, df[i,]$Strike, as.numeric((as.Date(df[i,]$Expiry_Date) - as.Date(Sys.Date())))/365, 0.03, 0),4)
}
View(df)
put_vol <- dplyer::filter(df,Call_Put='c' & Strike > Underlying)
put_vol <- dplyr::filter(df,Call_Put='c' & Strike > Underlying)
put_vol <- dplyr::filter(df,Call_Put=='c' & Strike > Underlying)
View(put_vol)
put_volatility <- dplyr::filter(df,Call_Put=='c' & Strike > Underlying) %>% select(df, Strike, Volatility_Value)
call_volatility <- dplyr::filter(df,Call_Put=='p' & Strike < Underlying) %>% select(df, Strike, Volatility_Value)
put_volatility <- dplyr::filter(df,Call_Put=='c' & Strike > Underlying) %>% select(., Strike, Volatility_Value)
call_volatility <- dplyr::filter(df,Call_Put=='p' & Strike < Underlying) %>% select(., Strike, Volatility_Value)
View(put_vol)
## 1.1
df <- read_xlsx("Q3OptionData.xlsx", sheet="data") %>%
rename(.,Expiry_Date=E, Strike=X,Open_Interest=OI,Underlying=S,Call_Put=CP,Bid=B,Ask=A) %>%
mutate(.,Valuation=.$Open_Interest*(.$Bid+.$Ask)*0.5)
## 1.2
df2 <- group_by(df,Call_Put) %>% summarise(Valuation_Sum=sum(Valuation)) %>% rbind(.,data.frame(Call_Put="C&P",Valuation_Sum=sum(.$Valuation_Sum)))
## 1.3
df <- mutate(df, In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% dplyr::filter(In_Money == "Y") %>% summarise(OI_Sum=sum(Open_Interest))
## 1.4
df<- mutate(df,Volatility_Value=0)
for(i in c(1:nrow(df))){
df[i,]$Volatility_Value = round(GBSVolatility(0.5*(df[i,]$Bid+df[i,]$Ask), df[i,]$Call_Put, df[i,]$Underlying, df[i,]$Strike, as.numeric((as.Date(df[i,]$Expiry_Date) - as.Date(Sys.Date())))/365, 0.03, 0),4)
}
put_volatility <- dplyr::filter(df,Call_Put=='c' & Strike > Underlying) %>% select(., Strike, Volatility_Value)
call_volatility <- dplyr::filter(df,Call_Put=='p' & Strike < Underlying) %>% select(., Strike, Volatility_Value)
View(put_volatility)
call_volatility <- dplyr::filter(df,Call_Put=='p' & Strike < Underlying) %>% select(., Strike, Volatility_Value)
dplyr::filter(df,Call_Put=='p' & Strike < Underlying) %>% select(., Strike, Volatility_Value)
put_volatility <- dplyr::filter(df,Call_Put=='c' & Strike > Underlying) %>% select(., Strike, Volatility_Value)
call_volatility <- dplyr::filter(df,Call_Put=='p' & Strike < Underlying) %>% select(., Strike, Volatility_Value)
dplyr::filter(df,Call_Put=='c' & Strike > Underlying) %>% select(., Strike, Volatility_Value)
dplyr::filter(df,Call_Put=='p' & Strike < Underlying) %>% select(., Strike, Volatility_Value)
putVolatility <- dplyr::filter(df,Call_Put=='c' & Strike > Underlying) %>% select(., Strike, Volatility_Value)
callVolatility <- dplyr::filter(df,Call_Put=='p' & Strike < Underlying) %>% select(., Strike, Volatility_Value)
## 1.1
df <- read_xlsx("Q3OptionData.xlsx", sheet="data") %>%
rename(.,Expiry_Date=E, Strike=X,Open_Interest=OI,Underlying=S,Call_Put=CP,Bid=B,Ask=A) %>%
mutate(.,Valuation=.$Open_Interest*(.$Bid+.$Ask)*0.5)
## 1.2
df2 <- group_by(df,Call_Put) %>% summarise(Valuation_Sum=sum(Valuation)) %>% rbind(.,data.frame(Call_Put="C&P",Valuation_Sum=sum(.$Valuation_Sum)))
## 1.3
df <- mutate(df, In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% dplyr::filter(In_Money == "Y") %>% summarise(OI_Sum=sum(Open_Interest))
## 1.4
df<- mutate(df,Volatility_Value=0)
for(i in c(1:nrow(df))){
df[i,]$Volatility_Value = round(GBSVolatility(0.5*(df[i,]$Bid+df[i,]$Ask), df[i,]$Call_Put, df[i,]$Underlying, df[i,]$Strike, as.numeric((as.Date(df[i,]$Expiry_Date) - as.Date(Sys.Date())))/365, 0.03, 0),4)
}
library(fOptions)
callVolatility <- dplyr::filter(df,Call_Put=='p' & Strike < Underlying) %>% select(., Strike, Volatility_Value)
putVolatility <- dplyr::filter(df,Call_Put=='c' & Strike > Underlying) %>% select(., Strike, Volatility_Value)
library(fOptions)
library(tidyverse)
library(tidyr)
library(readxl)
## 1.1
df <- read_xlsx("Q3OptionData.xlsx", sheet="data") %>%
rename(.,Expiry_Date=E, Strike=X,Open_Interest=OI,Underlying=S,Call_Put=CP,Bid=B,Ask=A) %>%
mutate(.,Valuation=.$Open_Interest*(.$Bid+.$Ask)*0.5)
## 1.2
df2 <- group_by(df,Call_Put) %>% summarise(Valuation_Sum=sum(Valuation)) %>% rbind(.,data.frame(Call_Put="C&P",Valuation_Sum=sum(.$Valuation_Sum)))
## 1.3
df <- mutate(df, In_Money=ifelse(df$Call_Put=='c',ifelse(df$Strike < df$Underlying,"Y","N"),ifelse(df$Strike > df$Underlying,"Y","N")))
df3 <- group_by(df,Call_Put) %>% dplyr::filter(In_Money == "Y") %>% summarise(OI_Sum=sum(Open_Interest))
## 1.4
df<- mutate(df,Volatility_Value=0)
for(i in c(1:nrow(df))){
df[i,]$Volatility_Value = round(GBSVolatility(0.5*(df[i,]$Bid+df[i,]$Ask), df[i,]$Call_Put, df[i,]$Underlying, df[i,]$Strike, as.numeric((as.Date(df[i,]$Expiry_Date) - as.Date(Sys.Date())))/365, 0.03, 0),4)
}
putVolatility <- dplyr::filter(df,Call_Put=='c' & Strike > Underlying) %>% select(., Strike, Volatility_Value)
callVolatility <- dplyr::filter(df,Call_Put=='p' & Strike < Underlying) %>% select(., Strike, Volatility_Value)
Strike_Vol <- bind_rows(callVolatility,putVolatility)
View(Strike_Vol)
Strike_Vol <- bind_rows(callVolatility,putVolatility) %>% arrange(.,Strike)
library(ggplot2)
ggplot(Strike_Vol,aes(x=Strike, y=Volatility_Value))+geom_curve()
ggplot(Strike_Vol,aes(x=Strike, y=Volatility_Value))+geom_line()
View(Strike_Vol)
View(df)
View(Strike_Vol)
View(df)
library(tidyverse)
library(tidyr)
library(readxl)
library(ggplot2)
library(knitr)
library(readr)
bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
res <- bank %>% group_by(age_group = (age %/% 10) * 10) %>%  summarise(count = n()) %>%  arrange(age_group)
library(tidyverse)
library(tidyr)
library(ggplot2)
library(knitr)
library(readr)
res <- bank %>% group_by(age_group = (age %/% 10) * 10) %>%  summarise(count = n()) %>%  arrange(age_group)
ibrary(dplyr)
library(tidyverse)
library(tidyr)
library(ggplot2)
library(knitr)
library(readr)
library(dplyr)
res <- bank %>% group_by(age_group = (age %/% 10) * 10) %>%  summarise(count = n()) %>%  arrange(age_group)
res <- bank %>% group_by(age_group = (age %/% 10) * 10) %>%  summarise(count = n()) %>%  arrange(age_group)
res
plot(res$age_group, res$count)
select(bank,age,default)
select(bank,age,default) %>% filter(.,default='Y')
select(bank,age,default) %>% filter(.,default=='Y')
select(bank,age,default) %>% filter(.,default=='yes')
select(bank,age,default) %>% filter(.,default=='yes') %>% group_by(.,age)
select(bank,age,default) %>% filter(.,default=='yes') %>% group_by(.,age) %>% summarise(total default = n())
select(bank,age,default) %>% filter(.,default=='yes') %>% group_by(.,age) %>% summarise(total_default = n())
plot(defalut_age$age,defalut_age$total_default)
defalut_age <- select(bank,age,default) %>% filter(.,default=='yes') %>% group_by(.,age) %>% summarise(total_default = n())
plot(defalut_age$age,defalut_age$total_default)
View(defalut_age)
View(res)
defalut_age <- bank %>% group_by(age_group = (age %/% 10) * 10) %>%  summarise(count = sum(ifelse(default=="yes"))/n()) %>%  arrange(age_group)
defalut_age <- bank %>% group_by(age_group = (age %/% 10) * 10) %>%  summarise(count = sum(ifelse(default=="yes",1,0))/n()) %>%  arrange(age_group)
plot(defalut_age$age,defalut_age$total_default)
View(defalut_age)
plot(defalut_age$age,defalut_age$defaultCount)
defalut_age <- bank %>% group_by(age_group = (age %/% 10) * 10) %>%  summarise(defaultCount = sum(ifelse(default=="yes",1,0))/n()) %>%  arrange(age_group)
plot(defalut_age$age,defalut_age$defaultCount)
defalutAge <- bank %>% group_by(age_group = (age %/% 10) * 10) %>%  summarise(defaultCount = sum(ifelse(default=="yes",1,0))/n()) %>%  arrange(age_group)
plot(defalutAge$age_group,defalutAge$defaultCount)
longestDuration <- filter(bank,max(duration))
longestDuration <- filter(bank,duration == max(duration))
View(longestDuration)
eldest <- filter(bank,age==max(age))
View(eldest)
loanNoHousing <- bank <- filter(loan == "yes" && housing == "no")
loanNoHousing <- bank %>% filter(loan == "yes" && housing == "no")
View(loanNoHousing)
loanNoHousing <- bank %>% filter(loan == "yes" & housing == "no")
View(loanNoHousing)
View(bank)
bank %>% group_by(.,job)
jobs <-bank %>% group_by(.,job)
View(jobs)
jobs <- group_by(bank,job)
View(jobs)
jobs <- group_by(bank,job) %>% summarise(.,n())
View(jobs)
age20_40_withJob <- bank %>% filter(age>=20 & age <= 40 & !(job %in% c("housemaid","retired","student","unemployed")))
View(age20_40_withJob)
age20_40_withJob <- bank %>% filter(age>=20 & age <= 40 & !(job %in% c("housemaid","retired","student","unemployed"))) %>%
group_by(.,job) %>% summarise(n())
View(age20_40_withJob)
age20_40_withJob <- bank %>% filter(age>=20 & age <= 40 & !(job %in% c("housemaid","retired","student","unemployed"))) %>%
group_by(.,job) %>% summarise(count = n())
ageGroup <- bank %>% group_by(age_group = (age %/% 10) * 10) %>%
summarise(count = n()) %>%  arrange(age_group)
plot(ageGroup$age_group, ageGroup$count)
jobs_count <- group_by(bank,job) %>% summarise(.,n())
library(tidyverse)
library(tidyr)
library(ggplot2)
library(knitr)
library(readr)
library(dplyr)
bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
loanNoHousing <- bank %>% filter(loan == "yes" & housing == "no")
View(loanNoHousing)
View(bank)
loanNoHousing <- bank %>% filter(loan == "yes" & housing == "no") %>% group_by(.,job) %>% summarise(count = n())
View(loanNoHousing)
View(bank)
job_Category <- distinct(bank, job) %>% arrange(job)
View(job_Category)
default_BalNJob <- filter(bank,default == "yes") %>% select(.,job, balance) %>% group_by("job")
View(default_BalNJob)
default_BalNJob <- filter(bank,default == "yes") %>% select(.,job, balance) %>% group_by(job) summarise(balance)
View(default_BalNJob)
default_BalNJob <- filter(bank,default == "yes") %>% select(.,job, balance) %>% group_by(.,job) summarise(.,balance)
default_BalNJob <- filter(bank, default == "yes") %>% group_by(.,job) summarise(.,balance)
default_BalNJob <- filter(bank, default == "yes") %>% group_by(.,job) summarise(., sum(balance))
default_BalNJob <- filter(bank, default == "yes") %>% group_by(.,job) summarise(sum(balance))
default_BalNJob <- filter(bank, default == "yes") %>% group_by(.,job) summarise(balance = sum(balance))
filter(bank, default == "yes")
default_BalNJob <- filter(bank, default == "yes") %>% group_by(.,job) %>% summarise(balance = sum(balance))
View(default_BalNJob)
default_BalNJob <- filter(bank, default == "yes") %>% group_by(.,job) %>% summarise(balance = sum(balance)) %>% arrange(balance)
View(default_BalNJob)
defalutRate_age <- bank %>% group_by(age_group = (age %/% 10) * 10) %>%
summarise(defaultCount = sum(ifelse(default=="yes",1,0))/n()) %>%  arrange(age_group)
plot(defalutAge$age_group,defalutAge$defaultCount)
job_category <- distinct(bank, job) %>% arrange(job)
default_BalNJob <- filter(bank, default == "yes") %>% group_by(.,job) %>% summarise(balance = sum(balance)) %>% arrange(balance)
defalutRate_age <- bank %>% group_by(age_group = (age %/% 10) * 10) %>%
summarise(defaultCount = sum(ifelse(default=="yes",1,0))/n()) %>%  arrange(age_group)
plot(defalutRate_age$age_group,defalutRate_age$defaultCount)
View(defalutRate_age)
15%/%10
loan_no_housing <- bank %>% filter(loan == "yes" & housing == "no") %>% group_by(.,job) %>% summarise(count = n())
age20to40_withJob <- bank %>% filter(age>=20 & age <= 40 & !(job %in% c("housemaid","retired","student","unemployed"))) %>%
group_by(.,job) %>% summarise(count = n())
bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
View(bank)
View(bank)
bank %>% filter(poutcome == "success")
success <- bank %>% filter(poutcome == "success")
View(success)
success <- bank %>% group_by(job) %>% summarize(sum(ifelse(poutcome=="success",1,0))/n()) %>% arrange(job)
View(success)
successRate_byJob <- bank %>% group_by(job) %>% summarize(success_rate = round(sum(ifelse(poutcome=="success",1,0))/n(),3)) %>% arrange(success_rate)
View(success)
View(successRate_byJob)
defalutRate_byAge <- bank %>% group_by(age_group = (age %/% 10) * 10) %>%
summarise(default_rate = round(sum(ifelse(default=="yes",1,0))/n(),3)) %>%  arrange(default_rate)
plot(defalutRate_byAge$age_group,defalutRate_byAge$default_rate)
View(defalutRate_byAge)
married_group <- filter(bank, marital="married") %>% group_by(education) %>%
summarize(aveage_balance=sum(balance)/n(), default_rate=sum(ifelse(default="yes",1,0)/n())) %>% arrange(education)
single_group <- filter(bank, marital="single") %>% group_by(education) %>%
summarize(aveage_balance=sum(balance)/n(), default_rate=sum(ifelse(default="yes",1,0)/n())) %>% arrange(education)
### Marital status, education level, average bank balance, default rate in respective group.
married_group <- filter(bank, marital=="married") %>% group_by(education) %>%
summarize(aveage_balance=sum(balance)/n(), default_rate=sum(ifelse(default="yes",1,0)/n())) %>% arrange(education)
single_group <- filter(bank, marital=="single") %>% group_by(education) %>%
summarize(aveage_balance=sum(balance)/n(), default_rate=sum(ifelse(default="yes",1,0)/n())) %>% arrange(education)
married_group <- filter(bank, marital=="married") %>% group_by(education) %>%
summarize(aveage_balance=sum(balance)/n(), default_rate=sum(ifelse(default=="yes",1,0)/n())) %>% arrange(education)
single_group <- filter(bank, marital=="single") %>% group_by(education) %>%
summarize(aveage_balance=sum(balance)/n(), default_rate=sum(ifelse(default=="yes",1,0)/n())) %>% arrange(education)
View(married_group)
married_group <- filter(bank, marital=="married") %>% group_by(education) %>%
summarize(aveage_balance=round(sum(balance)/n(),0), default_rate=round(sum(ifelse(default=="yes",1,0))/n(),3)) %>% arrange(education)
single_group <- filter(bank, marital=="single") %>% group_by(education) %>%
summarize(aveage_balance=round(sum(balance)/n(),0), default_rate=round(sum(ifelse(default=="yes",1,0))/n(),3)) %>% arrange(education)
View(single_group)
married_group <- filter(bank, marital=="married") %>% group_by(education) %>%
summarize(aveage_balance=round(sum(balance)/n(),0), default_rate=round(sum(ifelse(default=="yes",1,0))/n(),3)) %>% arrange(education)
single_group <- filter(bank, marital=="single") %>% group_by(education) %>%
summarize(aveage_balance=round(sum(balance)/n(),0), default_rate=round(sum(ifelse(default=="yes",1,0))/n(),3)) %>% arrange(education)
married_group <- mutate(married_group, marital="married")
single_group <- mutate(married_group, marital="single")
marital_df <- bind_rows(married_group,single_group)
View(marital_df)
marital_df <- bind_rows(married_group,single_group) %>% arrange(default_rate)
View(marital_df)
View(married_group)
View(single_group)
View(married_group)
married_group <- filter(bank, marital=="married") %>% group_by(education) %>%
summarize(aveage_balance=round(sum(balance)/n(),0), default_rate=round(sum(ifelse(default=="yes",1,0))/nrow(.),3)) %>% arrange(education)
View(married_group)
married_group <- filter(bank, marital=="married") %>% group_by(education) %>%
summarize(aveage_balance=round(sum(balance)/n(),0), default_rate=round(sum(ifelse(default=="yes",1,0))/nrow(.),3)) %>% arrange(education)
single_group <- filter(bank, marital=="single") %>% group_by(education) %>%
summarize(aveage_balance=round(sum(balance)/n(),0), default_rate=round(sum(ifelse(default=="yes",1,0))/nrow(.),3)) %>% arrange(education)
married_group <- mutate(married_group, marital="married")
single_group <- mutate(married_group, marital="single")
marital_df <- bind_rows(married_group,single_group) %>% arrange(default_rate)
View(marital_df)
View(single_group)
View(marital_df)
View(married_group)
View(single_group)
married_group <- filter(bank, marital=="married") %>% group_by(education) %>%
summarize(aveage_balance=round(sum(balance)/nrow(.),0), default_rate=round(sum(ifelse(default=="yes",1,0))/nrow(.),3)) %>% arrange(education)
single_group <- filter(bank, marital=="single") %>% group_by(education) %>%
summarize(aveage_balance=round(sum(balance)/nrow(.),0), default_rate=round(sum(ifelse(default=="yes",1,0))/nrow(.),3)) %>% arrange(education)
married_group <- mutate(married_group, marital="married")
single_group <- mutate(married_group, marital="single")
marital_df <- bind_rows(married_group,single_group) %>% arrange(default_rate)
View(marital_df)
married_group <- filter(bank, marital=="married") %>% group_by(education) %>%
summarize(aveage_balance=round(sum(.$balance)/nrow(.),0), default_rate=round(sum(ifelse(default=="yes",1,0))/nrow(.),3)) %>% arrange(education)
single_group <- filter(bank, marital=="single") %>% group_by(education) %>%
summarize(aveage_balance=round(sum(balance)/nrow(.),0), default_rate=round(sum(ifelse(default=="yes",1,0))/nrow(.),3)) %>% arrange(education)
married_group <- mutate(married_group, marital="married")
single_group <- mutate(married_group, marital="single")
marital_df <- bind_rows(married_group,single_group) %>% arrange(default_rate)
View(married_group)
filter(bank, marital=="married") %>% group_by(education) %>% summarise(sum(balance))
filter(bank, marital=="married") %>% group_by(education) %>% summarise(mean(balance))
married_group <- filter(bank, marital=="married") %>% group_by(education) %>%
summarize(aveage_balance=round(mean(balance),0), default_rate=round(sum(ifelse(default=="yes",1,0))/nrow(.),3))
married_group <- filter(bank, marital=="married") %>% group_by(education) %>%
summarize(aveage_balance=round(mean(balance),0), default_rate=round(sum(ifelse(default=="yes",1,0))/nrow(.),3)) %>% arrange(education)
single_group <- filter(bank, marital=="single") %>% group_by(education) %>%
summarize(aveage_balance=round(mean(balance),0), default_rate=round(sum(ifelse(default=="yes",1,0))/nrow(.),3)) %>% arrange(education)
married_group <- mutate(married_group, marital="married")
single_group <- mutate(married_group, marital="single")
View(marital_df)
filter(bank, marital=="married") %>% group_by(education) %>% summarise(mean(balance))
filter(bank, marital=="married") %>% group_by(education) %>% summarise(mean(balance),default_rate=round(sum(ifelse(default=="yes",1,0))/n(),3))
View(married_group)
View(married_group)
View(single_group)
View(married_group)
View(single_group)
View(married_group)
View(single_group)
single_group <- filter(bank, marital=="single") %>% group_by(education) %>% summarize(aveage_balance=round(mean(balance),0)
View(single_group)
single_group <- filter(bank, marital=="single") %>% group_by(education) %>% summarize(aveage_balance=round(mean(balance),0))
View(single_group)
View(married_group)
single_group <- filter(bank, marital=="single") %>% group_by(education) %>% summarize(aveage_balance=round(mean(balance),0), default_rate=round(sum(ifelse(default=="yes",1,0))/n(),3))
View(married_group)
View(single_group)
married_group <- mutate(married_group, marital="married")
single_group <- mutate(married_group, marital="single")
marital_df <- bind_rows(married_group,single_group) %>% arrange(default_rate)
View(marital_df)
married_group <- filter(bank, marital=="married") %>% group_by(education) %>%
summarise(mean(balance),default_rate=round(sum(ifelse(default=="yes",1,0))/n(),3))
single_group <- filter(bank, marital=="single") %>% group_by(education) %>%
summarize(aveage_balance=round(mean(balance),0), default_rate=round(sum(ifelse(default=="yes",1,0))/n(),3))
View(married_group)
View(single_group)
married_group <- filter(bank, marital=="married") %>% group_by(education) %>%
summarise(aveage_balance=mean(balance),default_rate=round(sum(ifelse(default=="yes",1,0))/n(),3))
single_group <- filter(bank, marital=="single") %>% group_by(education) %>%
summarize(aveage_balance=round(mean(balance),0), default_rate=round(sum(ifelse(default=="yes",1,0))/n(),3))
married_group <- filter(bank, marital=="married") %>% group_by(education) %>%
summarise(aveage_balance=mean(balance),default_rate=round(sum(ifelse(default=="yes",1,0))/n(),3))
single_group <- filter(bank, marital=="single") %>% group_by(education) %>%
summarize(aveage_balance=round(mean(balance),0), default_rate=round(sum(ifelse(default=="yes",1,0))/n(),3))
View(married_group)
View(single_group)
marital_df <- bind_rows(married_group,single_group)
View(marital_df)
marital_df <- bind_rows(married_group,single_group) %>% arrange(default_rate)
View(marital_df)
married_group <- mutate(married_group, marital="married")
single_group <- mutate(married_group, marital="single")
View(married_group)
View(single_group)
View(married_group)
View(single_group)
married_group <- filter(bank, marital=="married") %>% group_by(education) %>%
summarise(aveage_balance=mean(balance),default_rate=round(sum(ifelse(default=="yes",1,0))/n(),3))
single_group <- filter(bank, marital=="single") %>% group_by(education) %>%
summarize(aveage_balance=round(mean(balance),0), default_rate=round(sum(ifelse(default=="yes",1,0))/n(),3))
married_group <- mutate(married_group, marital="married")
single_group <- mutate(single_group, marital="single")
marital_df <- bind_rows(married_group,single_group) %>% arrange(default_rate)
View(marital_df)
install.packages("lubridate")
