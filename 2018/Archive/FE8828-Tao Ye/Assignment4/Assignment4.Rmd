---
title: "Assignment4"
author: "ye"
date: "2018Äê12ÔÂ10ÈÕ"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(lubridate)
library(bizdays)
library(ggplot2)
# Use echo = TRUE for assignment is an exception, so code is visible.
knitr::opts_chunk$set(echo = TRUE, fig.align="center", collapse = TRUE, cache = TRUE)
bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
```

## 1) age vs balance
## 70-years-old old people have the largest average balance.
```{r age vs balance}
ggplot(bank, aes(age, balance)) + geom_point()+geom_smooth()
```

## 2) age vs duration
## Mid aged people are more likely to have longer duration.
```{r age vs duration}
g <- ggplot(bank, aes(x=age,y=duration))
g + geom_point(color = "steelblue", size = 4, alpha = 1/2)
```

## 3) age vs job
## Students are younger and retired are older.
```{r age vs job}
ggplot(bank, aes(age, job)) +
geom_point() +
scale_y_discrete(limit = rev(levels(bank$job)))
```

## 4) age vs education
## In all age range, people with secondary or tertiary education are left partial distribution, while those with primary or unknown education are close to normal distribution.
```{r age vs duration}
ggplot(bank, aes(age, color = education, fill = education, alpha = 0.3)) + geom_density()
```

## 5) age vs duration
## Most people retire at about 60-years-old.
```{r age vs duration}
ggplot(bank) +
geom_bar(mapping = aes(x = age, fill = job), position = "fill") +
coord_polar()
```

## 5) balance vs duration
## Most accounts have duration less than 1500 and balance less than 20000. Longer duration is more likely to correspond to small balance and larger balance is more likely to correpond to shorter duration.
```{r age vs duration}
ggplot(bank,aes(balance, duration)) + geom_point() 
```

## 6) education vs married
## Single people are more likely to have high education level.
```{r education vs married}
group_by(bank, marital, education) %>% summarise(n=n())
```

## 6) duration vs default
## Accounts without credit are more liky have longer duration.
```{r duration vs default}
ggplot(bank, aes(default, duration)) + geom_point()
```

## 7) age vs duration vs married
## No matter divorced, married or signle, people with same age tend to have same duration account.
```{r age vs duration vs married}
ggplot(bank, aes(x = age, y = duration, color = marital)) +
geom_point() +
theme(legend.position="right")

```

## 8) month vs duration
## Accounts tend to have shorter duration when the last contact month is Dec, Mar and Sep.
```{r month vs duration}
ggplot(bank, aes(month, duration)) + geom_point()
```

## 9) contact vs age
## Single people are more likely to have high education level.
```{r age vs duration}
ggplot(bank) + geom_bar(mapping = aes(x = age, fill = contact))
```

## 10) age vs balance vs education
## 70-years-old people with secondary education has above-average balance.
```{r age vs balance vs education}
ggplot(bank, aes(age, balance)) + geom_point(aes(color = education)) +
geom_smooth() +
facet_grid(. ~ education)
```
