---
title: "Assignment 3 BankDataframe Insights"
author: "GundaSuman"
date: "November 29, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(lubridate)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(quantmod)
library(xlsx)
library(fOptions)
```

## R Markdown

10 insights from bank dataset .
Shown in plots and tables.

##1)Let's just start by seeing which job professions has most "single"" status
Just taking this is a sample from population.Let'see what this data says
Observation:Most of Technician,Managemnt are single.May be  psycologist might explain why with this job professions relative to others.
```{r bank,echo=FALSE}
bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
Totalcount<-group_by(bank,marital,job)%>%dplyr::filter(marital=="single")%>%summarise(count=n())%>%arrange(count)
knitr::kable(
Totalcount,
caption = "Number of people with 'single' status for each profession:Sorted"
)
z<-group_by(bank,marital)%>%dplyr::filter(marital=="single")%>%summarise(totalsingle=n())

x<-group_by(bank,marital,job)%>%dplyr::filter(marital=="single")%>%summarise(percentage=n()/1196)%>%arrange(percentage)

knitr::kable(
x,
caption = "Percentage of people with 'single' status  for each profession:Sorted"
)

# YY: This is the correct percentage.
x<-group_by(bank,job)%>%summarise(percentage=sum(ifelse(marital=="single", 1, 0)/n()))%>%arrange(percentage)

knitr::kable(
x,
caption = "Percentage of people with 'single' status  for each profession:Sorted"
)

```

##2)For each job,finding out Mean age of those who possess loan and housing . Repeat the same with all possible combinations of housing,loan
Just taking this is a sample from population.Let'see what this data says
Observation:Most of Technician,Managemnt are single.May be  psycologist might explain why with this job professions relative to others.
```{r finding2,echo=FALSE}

HYLY<-group_by(bank,job)%>%dplyr::filter(housing=="yes"&loan=="yes")%>%summarise(x=mean(age))%>%arrange(x)
HYLN<-group_by(bank,job)%>%dplyr::filter(housing=="yes"&loan=="no")%>%summarise(x=mean(age))%>%arrange(x)
HNLY<-group_by(bank,job)%>%dplyr::filter(housing=="no"&loan=="yes")%>%summarise(x=mean(age))%>%arrange(x)
HNLN<-group_by(bank,job)%>%dplyr::filter(housing=="no"&loan=="no")%>%summarise(x=mean(age))%>%arrange(x)

# YY: better to join them to show then side-by-side

knitr::kable(
HYLY,
caption = "MEAN AGE BASED ON JOB HAVING LOAN AND HOUSING"
)

knitr::kable(
HYLN,
caption = "MEAN AGE BASED ON JOB HAVING HOUSING AND NO LOAN"
)

knitr::kable(
HNLY,
caption = "MEAN AGE OF BASED ON JOB HAVING LOAN AND NO HOUSING"
)

knitr::kable(
HNLN,
caption = "MEAN AGE OF BASED ON JOB WITH NO LOAN AND NO HOUSING"
)

```

## 3)AVERAGE DURATION OF CALL - MONTHLY DATA
Observation:I find December to  deviate from rest


```{r finding3, echo=FALSE}
# YY: slight change: from sum()/n() to mean(duration)
AVGDURATIONMONTH<-group_by(bank,month)%>%summarise(y=sum(duration)/n())%>%arrange(y)
knitr::kable(
AVGDURATIONMONTH,
caption = "AVEARGE DURATION OF CALL FOR EACH MONTH"
)
```

## 4)BASED ON JOB PROFESSION,LET'S SEE WHICH EDUCATION BACKGROUND MOST NUMBER OF PEOPLE HAVE

Observation:Understandably,most of the entreprenuer,manager,self employed have higher education background.Also most of the housemaids just have primary education 


```{r finding4, echo=FALSE}
HIGHESTEDUCATIONBGFORMAJORITY<-bank %>% group_by(job,education) %>% summarize(count = n()) %>% dplyr::filter(count == max(count))

# YY: Percentage of that education group of all is better.
High2 <- group_by(bank, job) %>% summarise(total = n())

High3 <- left_join(HIGHESTEDUCATIONBGFORMAJORITY, High2, by = "job") %>% ungroup() %>% mutate(perc = count / total) %>% arrange(perc) %>% select(-count, -total) %>% arrange(perc)

knitr::kable(
High3,
caption = "HIGHEST EDCUATION BACKGROUND FOR MAJORITY @ JOB"
)

```

## 5)ANY CORRELATION BETWEEN BANK BALANCE AND EDUCATION

Intuitively we feel people with higher eductaion back ground earn more.Let's see if it's true.

Observation:ForRetiredpeople job doesn't matter? NO. Wealth of individual cannot be decided based on bank data.May be people have just accumulated in bank instead investing as they get retired unlike young.
Also interesting to see technincian and management where primary education people earn more than secondary and teritiary.May be acumen and skillset matters in those sectors nothing to do with education background.


```{r finding5, echo=FALSE}
EDUCATIONMONEY<-bank%>%group_by(job,education)%>%summarise(Meanbalance=mean(balance))
knitr::kable(
EDUCATIONMONEY,
caption = "MEAN BALANCE FOR EACH PROFESSION  BASED ON RESPECTIVE JOB EDUCATION"
)

```

## 6)AVERAGE BANK BALANCE BASED ON AGE

Observation:Intuitively we feel people with higher age might be having good bank balance ,data reconfirms the same


```{r finding6, echo=FALSE}
Averagebalance_basedonage<-bank%>%group_by(age)%>%summarise(balance=mean(balance))
ggplot(Averagebalance_basedonage,aes(age,balance))+geom_line()+theme_classic()+
  labs(title="Mean balance based on age")+
  labs(x="Age",y="Mean Balance")
```

## 7)PLOT: PEOPLE WITH CELLULAR VS AGE

Observation:I see that mostly people in between 30 to 40 have cellular


```{r finding7, echo=FALSE}
age_contact<-dplyr::filter(bank,contact=="cellular")
age_contact<-age_contact%>%group_by(age)%>%summarise(`NumberofPeople with cellular` = n())
# YY: Use `` for the column names with space and punctuation marks.

# colnames(age_contact)=c("age","NumberofPeople with cellular")
plot(age_contact$age,age_contact$`NumberofPeople with cellular`,type="l")

```

```{r finding7, echo=FALSE}
# YY: Use percentage to normalize the data 
age_group <- group_by(bank, age) %>% summarize(total = n())
age_contact1 <- left_join(age_contact, age_group) %>% ungroup %>% mutate(perc = `NumberofPeople with cellular` / total)
plot(age_contact1$age,age_contact1$perc,type="l")
```

## 8)ANALYSING DEFAULT COUNT BASED ON  JOB PROFESSION

Following plots shows Default count based on job for given sample data  and also percentage of default  for  each profession.
observation-Entrepreneurs who takes more risk has highest default rate which is understandable.


```{r finding8, echo=FALSE}
TotalDefaultCount<-bank%>%group_by(job)%>%summarise(default_countbasedonjobtype=sum(ifelse(default=="no",0,1)))
plot(TotalDefaultCount$job,TotalDefaultCount$default_countbasedonjobtype)
Meandefaultrate<-bank%>%group_by(job)%>%summarise(default_countbasedonjobtype=sum(ifelse(default=="no",0,1))/n())
plot(Meandefaultrate$job,Meandefaultrate$default_countbasedonjobtype)
```

##9)Difference of balance between people having loans and not 

Observation:Interestingly,I find huge difference interestingly between people having loans and those who doesn't fro goven sample. Anyways shouldn't jump into  any concrete conclusion based on this sample

```{r finding9,echo=FALSE}
# YY: mean is better indicatior than sum.
bank1<-bank%>%group_by(loan)%>%summarise(mean(balance))
knitr::kable(
  bank1,
  caption = ""
)
```

##10)Which jobclients are contaced more by bank employees?

Observation:As a whole bank employees has contacted more  Managemnt,blue collar,technician. 

```{r finding10,echo=FALSE}
Contactedbasedonjobprofession<-bank%>%group_by(job)%>%summarise(Numberoftimescontacted=sum(campaign))
ggplot(Contactedbasedonjobprofession,aes(job,Numberoftimescontacted))+geom_point()+theme_bw()+
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```
