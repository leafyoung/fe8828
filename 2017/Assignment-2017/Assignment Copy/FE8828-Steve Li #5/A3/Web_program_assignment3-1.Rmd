---
title: "“FE8828” Assignment for Exploratory Data Analysis"
author: "Steve Li"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(lubridate)
library(bizdays)
knitr::opts_chunk$set(echo = TRUE, fig.align = "center", collapse = TRUE, cache=TRUE)
bank<-read.csv("https://goo.gl/PBQnBt",sep=";")
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

1. Provide the summary of the bank.csv, we can also use the table to check the answer
```{r echo=TRUE}
summary(bank)
```
2. Find the number of people who is between 25 to 35 in age, and balanece > 500

```{r echo=TRUE}
nrow(dplyr::filter(bank, age %in% 25:35 & balance>500))
```
3. The number and percentage of people whose job is management

```{r 3, echo=TRUE}
nrow(dplyr::filter(bank, job == "management"))
nrow(dplyr::filter(bank, job == "management"))/nrow(bank)*100
```

4. list each education level and calculate the percentage of each education 
```{r 4, echo=TRUE}
distinct(bank, education)
nrow(dplyr::filter(bank, education == "primary"))/nrow(bank)*100
nrow(dplyr::filter(bank, education == "secondary"))/nrow(bank)*100
nrow(dplyr::filter(bank, education == "tertiary"))/nrow(bank)*100
nrow(dplyr::filter(bank, education == "unknown"))/nrow(bank)*100
```

5. default age min/max/mean
```{r 5, echo = TRUE}
a<-select(bank, age, default)
b <- dplyr::filter(a,default=="yes")
summarize(b, min(age))
summarize(b, mean(age))
summarize(b, max(age))

```
6. list the number of people based on education and number of default
```{r 6, echo=TRUE}
group_by(bank, education, default="yes") %>%
   summarise(n = n())
```
7. list the max, mean, min balance for different jobs.
```{r 7, echo=TRUE}
group_by(bank, job) %>%
  summarise(count = n(),
            max_balance = max(balance),
            mean_balance = mean(balance),
            min_balance= min(balance))
```
8. find the number who is unemployed based on the marital status
```{r 8, echo=TRUE}
group_by(bank, marital, job) %>%
  summarise(count = n()) %>%
  dplyr::filter (., job=="unemployed")
```
9. Marital status and loan level
```{r 9, echo= TRUE}
group_by(bank, marital, loan) %>%
  summarise(count = n()) %>%
  dplyr::filter (., loan=="yes")

```
10. the summary of age and having no house
```{r 10}
summarise(bank, with_housing=sum(housing =="no")/n(),
          age_min=min(age),
          age_max=max(age),
          duration_mean = mean(duration))
```

11. the balance vs job plot
```{r 11}
# group_by(bank, job) %>% summarise (n=n()) %>% plot
group_by(bank, job) %>% summarise (median_balance=median(balance)) %>% plot
```


