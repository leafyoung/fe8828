---------
title: "FE8828 Assignment for Exploratory Data Analysis"
author: "ZHENG CHEN"
date: "December-04-2017"
output: html_document
---------
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(bizdays)
knitr::opts_chunk$set(echo = TRUE, fig.align="center", collapse=TRUE, cache=TRUE)
bank <- read.csv("https://goo.gl/PBQnBt", sep = ";") 
```

ggplot(bank, aes(age, default)) + geom_point()
## R Markdown


#Finding 1

Relationship between loan and age

We can see that people with loan are the age between 20 and 65.

```{r finding1, echo=TRUE}
ggplot(bank, aes(age, loan)) + geom_point()

```

#Finding 2
Count people in each age groups who default and don't default
people who are elder than 60 don't default 

```{r finding2, echo=TRUE}
ggplot(bank)+geom_histogram(mapping=aes(x=age,fill=default),bins = 25, position="dodge")
```


#Finding 3

Elder people tend to get lower education but Youngster people receive higher education.
```{r finding3, echo=TRUE}
ggplot(bank) +
geom_bar(mapping = aes(x = age, fill = education), position = "fill") +
coord_polar()
```

#Finding 4

Relationship between job and default:

Results show that the customers who default have a good mix of job backgrounds and elder people without default are mainly who do management job.And all of those who default are below 60 years old. 

```{r finding4, echo=TRUE}
ggplot(bank, aes(x = age, y = default, color = job)) +
geom_point() +theme(legend.position="right")
```




#Finding 5

Different duration depending on job and by contact group


```{r finding5, echo=TRUE}
ggplot(bank) + geom_point(aes(job, duration, color = contact))
  

```

#Finding 6

Relationship between hausing and balance in different age

```{r finding6, echo=TRUE}
ggplot(bank, aes(age,balance)) +
  geom_bar(aes(fill = housing), stat = "identity") +
  ggtitle("relationship between housing and balance")

```

#Finding 7
the relationship between job and education
```{r finding7, echo=TRUE}
ggplot(bank, mapping = aes(x = job, fill = education)) +
geom_bar() + coord_flip()+
ggtitle("housing vs education")

```


#Finding 8

marital status in different kind of education

```{r finding8, echo=TRUE}
ggplot(data = bank, mapping=aes(x=reorder(education, age, FUN=mean), fill=marital))+
  geom_bar()+coord_flip()
```



#Finding 9

Relationship between marital and age
we can see that the married people have the widest age range 

```{r finding9, echo=TRUE}
ggplot(bank, aes(age, marital)) + geom_point()
```



#Finding 10

Plot of balance depending on age, grouped by marital and education


```{r finding10, echo=TRUE}
ggplot(data = bank) +
geom_point(mapping = aes(age,balance)) +
facet_wrap(marital ~ education, nrow = 1)
```

