---------
title: "FE8828 Assignment for Exploratory Data Analysis"
author: "ZHENG CHEN"
date: "November 26, 2017"
output: html_document
---------

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(bizdays)
knitr::opts_chunk$set(echo = FALSE, fig.align="center", collapse=TRUE, cache=TRUE)
bank <- read.csv("https://goo.gl/PBQnBt", sep = ";") 
```

## R Markdown

#Finding 1
The number of loan 
the percentage of loan
The number of people with house
the percentage of house

```{r finding1, echo=TRUE}
nrow(filter(bank,loan=="yes")) 
nrow(filter(bank,loan=="yes"))*100/nrow(bank)
nrow(filter(bank,housing=="yes"))
nrow(filter(bank,housing=="yes"))*100/nrow(bank)
```

#Finding 2
Plot -> The number of people with balance <2000:

```{r finding2, echo=TRUE}
group_by(bank,age)%>%
  filter(.,balance<2000)%>%
  summarise(count=n())->p1
p1
plot(p1$age,p1$count)

```

#Finding 3
The number of people in different education 
percentage of primary
percentage of secondary
percentage of tertiary

```{r finding3, echo=TRUE}
group_by(bank,education)%>% 
  summarise(n = n())
nrow(filter(bank,education=="primary"))*100/nrow(bank)
nrow(filter(bank,education=="secondary"))*100/nrow(bank)
nrow(filter(bank,education=="tertiary"))*100/nrow(bank)
```
#Finding 4
mean, max,min, median and sd age of those who are single

```{r finding4,echo=TRUE}
x <- select(bank,age,marital)
y<- filter(x,marital=="single")
summarize(y,mean(age),max(age),min(age),median(age),sd(age))

```

#Finding 5
people without house at different education level(%)

```{r finding5, echo=TRUE}
group_by(bank, housing, education) %>%
  summarise(count = n(),
            percent = n()/nrow(bank)*100) %>%
  filter (., housing=="no")
```

#Finding 6
The number of people and percent in each education group
The number of people in each contact type
The number of people in each poutcome
```{r finding6, echo=TRUE}
group_by(bank, education) %>% 
  summarise(n = n(),
            percent=n()/nrow(bank)*100)
group_by(bank,contact)%>% 
  summarise(n = n())
group_by(bank,poutcome)%>% 
  summarise(n = n())
```

#Finding 7
The mean balance of single with housing and  mean balance of married with housing

```{r finding7, echo=TRUE}
select(bank,marital,housing,balance) %>%
  filter(.,marital=="single", housing=="yes") %>%
  summarize(.,n(),mean(balance))

select(bank,marital,housing,balance) %>%
  filter(.,marital=="married", housing=="yes") %>%
  summarize(.,n(),mean(balance)) 
```

#Finding 8
the number of different marital situation who are unemployed


```{r finding8,echo=TRUE}
group_by(bank, job, marital) %>%
  summarise(count = n()) %>%
  filter (., job=="unemployed")
```

#Finding 9
min, max and mean balance in each job
```{r finding9, echo=TRUE}
group_by(bank, job) %>%
  summarise(count = n(),
            min_balance=min(balance),
            max_balance = max(balance),
            mean_balance = mean(balance)
            )
```


#Finding 10
Plot -> age vs sum(balance) of who single and married

```{r finding10, echo=TRUE}
group_by(bank, age) %>%
  filter(., marital=="married") %>%
  summarise(sum_balance = mean(balance),
            count = n()) -> p1
group_by(bank, age) %>%
  filter(., marital=="single") %>%
  summarise(sum_balance = mean(balance),
            count = n()) -> p2
p1
p2
plot(p1$age, p1$sum_balance)
plot(p2$age, p2$sum_balance)

# This could be better.
library(ggplot2)
group_by(bank, age, marital) %>% summarise(mean_balance = mean(balance)) %>%
ggplot(aes(age, mean_balance)) + geom_smooth(aes(color = marital))

```

