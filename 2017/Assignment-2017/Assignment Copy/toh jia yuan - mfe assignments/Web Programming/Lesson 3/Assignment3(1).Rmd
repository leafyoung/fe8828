---
title: "Assignment3(1)"
author: "Toh Jia Yuan"
date: "23 November 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(bizdays)
knitr::opts_chunk$set(echo = TRUE, fig.align="center", collapse=TRUE, cache=T)
# bank <- read.csv("C:/Users/JY Toh/Desktop/MFE/Mini Term 3/Web programming/bank.csv", sep=";")
bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
```

## R Markdown

#Finding 1
The number and % of default cases are: 

```{r finding1, echo=TRUE}
nrow(filter(bank,default=="yes")) 
nrow(filter(bank,default=="yes"))/nrow(bank)*100
```

#Finding 2
The type and number of categories of jobs are: 

```{r finding2, echo=TRUE}
distinct(bank,job)
nrow(distinct(bank,job))
```

#Finding 3
The mean, max and min age of those who default:

```{r finding3, echo=TRUE}
subset1 <- select(bank,age,default)
subset2 <- filter(subset1,default=="yes")
summarize(subset2,mean(age)) 
summarize(subset2,max(age))
summarize(subset2,min(age)) 
```

#Finding 4
The mean balance of single with housing, vs. mean balance of married with housing:

```{r finding4, echo=TRUE}
select(bank,marital,housing,balance) %>%
  filter(.,marital=="single", housing=="yes") %>%
  summarize(.,mean(balance))

select(bank,marital,housing,balance) %>%
  filter(.,marital=="married", housing=="yes") %>%
  summarize(.,mean(balance)) 
```

#Finding 5
The number of people in each job group:

```{r finding5,echo=TRUE}
group_by(bank, job) %>% 
  summarise(n = n())
```

#Finding 6
The mean balance of each age group (excluding vs including those who default):

```{r finding6,echo=TRUE}
group_by(bank, age) %>%
  filter(., default=="no") %>%
  summarise(balance_mean = mean(balance),
            count = n(),
            default_count = sum(ifelse(default == "no", 0, 1))) -> p1
group_by(bank, age) %>%
  summarise(balance_mean = mean(balance),
            count = n(),
            default_count = sum(ifelse(default == "no", 0, 1))) -> p2

p1
p2
plot(p1$balance_mean, p1$count)
plot(p2$balance_mean, p2$count)
```


#Finding 7
Education level vs max and mean balance:

```{r finding7, echo=TRUE}
group_by(bank, education) %>%
  summarise(count = n(),
            max_balance = max(balance),
            mean_balance = mean(balance))
```

#Finding 8
Unemployment vs education level:

```{r finding8, echo=TRUE}
group_by(bank, job, education) %>%
  summarise(count = n()) %>%
  filter (., job=="unemployed")
```

#Finding 9
Unemployment vs loan level: 

```{r finding9, echo=TRUE}
group_by(bank, job, loan) %>%
  summarise(count = n()) %>%
  filter (., job=="unemployed")
```

#Finding 10
The number of people aged between 25 and 60 with balance >1000:

```{r finding10, echo=TRUE}
nrow(filter(bank, age %in% 25:60 & balance>1000)) 
```
