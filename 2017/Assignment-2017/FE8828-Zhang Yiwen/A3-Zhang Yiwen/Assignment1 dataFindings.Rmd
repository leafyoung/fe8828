---
title: "FE 8828 Assignment for Exploratory Data Analysis"
author: "Zhang Yiwen"
date: "2017 26 NOV"
output:
  html_document: default
---

## R Markdown
```{r setup, include=FALSE}
library(tidyverse)
library(lubridate)
library(bizdays)
library(ggplot2)
knitr::opts_chunk$set(echo = TRUE, fig.align="center", collapse = TRUE, cache = TRUE)
bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
```

#finding 1
```{r summary}
summary(bank)
```

#finding 2  
Find total default ratio:
```{r defaultPercentage}
a<-filter(bank,default == "yes")
nrow(a)/nrow(bank)
```

#finding 3 
Find default number with respect to age, those under 60 is more likely to default.
```{r Plotage,echo = TRUE}
ggplot(bank,aes(default,age,color= job,alpha = 1/3))+geom_point()
```



#finding 4
Divide age group into 2, there are more elder people in retired, housemaid and unknown group.
```{r Age60,echo = TRUE}
a <- group_by(bank, job) %>%
summarise(`age > 50` = sum(age > 50))
b <- group_by(bank, job) %>%
summarise(`age <= 50` = sum(age <= 50))
d <- distinct(bank, job) %>% arrange(job)
d <- left_join(d, a, by = "job")
d <- left_join(d, b, by = "job")
d <- mutate(d, total = `age > 50` + `age <= 50`)
d <- mutate(d, total = `age > 50` + `age <= 50`,percentage_over50 = `age > 50`/total)
d

```

#finding 5 
Default number of diffenrent job group
```{r JobDefault,echo = TRUE}
a<-filter(bank, default == "yes")
group_by(a, job) %>%
   summarise(n = n())
```

#finding 6 
Total number of people from different education level: Most customers have an education background of secondary school.
```{r job,echo = TRUE}
group_by(bank,education) %>%
  summarise(n = n())%>%
  plot

```


#finding 7  
mean balance of different job group, entrepreneur has the largest default percentage
```{r balanceTable, echo=TRUE}
group_by(bank, job) %>%
  summarise(count = n(),
            mean_balance = mean(balance),
            mean_duration = mean(duration),
            default_percentage = sum(default =="yes")/count)


```

#finding 8 
Plot defualt with respect to balance and loan, calculate a table of default ratio: those with loan have a greater ratio of default.
```{r Loan, echo=TRUE,warning=FALSE}
b<-select(bank,loan,balance,default)

g<-ggplot(b,aes(loan,balance,color = default,size = default))
g+ geom_point(alpha = 1/2)
group_by(b,loan)%>% 
  summarise(total = n(),
            default_ratio = sum(default == "yes")/total)
```
#finding 9 
plot balance and default amount by job group:those with lower balance are more likely to default  
```{r JobLB, echo=TRUE,warning=FALSE}
g<-ggplot(bank,aes(default,balance,job,color = default))
g+ geom_point(alpha = 1/2)+ facet_grid(.~job)
```

#finding 10 
plot duration with respect to balance group by job: the average duration are approximately the same between different job groups, but the unemployeed group have a larger volitality than others.
```{r JobBalanceD, echo=TRUE}
g<-ggplot(bank,aes(balance,duration,job))
g+ geom_point(alpha = 1/2)+geom_smooth()+ facet_grid(.~job)
```