---
title: "Assignment 4"
author: "Bryan Lim"
date: "3 December 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(bizdays)
knitr::opts_chunk$set(echo = TRUE, fig.align="center", collapse = TRUE, cache = T)
bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
```

#Finding 1
The number of total default cases is:
```{r Finding 1, echo=TRUE}
nrow(filter(bank, default == "yes"))

```
This represents (in %)
```{r}
nrow(filter(bank, default == "yes"))/nrow(bank) * 100
```
of the total cases.


#Finding 2
The proportion (%) of default cases that have a housing loan is:
```{r, Finding 2, echo=TRUE}
default_housing_balance <- filter(select(bank, default, housing, balance), default == "yes")
nrow(filter(default_housing_balance, housing == "yes"))/nrow(default_housing_balance) * 100

```


#Finding 3
The average yearly balance of cases with a housing loan is:
```{r, Finding 3, echo=TRUE}
housing_balance <- filter(select(bank, housing, balance),housing == "yes")
summarize(housing_balance, mean(balance))
ggplot(bank, aes(housing, balance)) + geom_point()

```


#Finding 4
This is compared with the average for default cases with a housing loan:
```{r, Finding 4, echo=TRUE}
summarize(default_housing_balance, mean(balance))
ggplot(bank, aes(age, housing)) + geom_point()
```


#Finding 5 
The mean, maximum and minimum age of the default cases are:
```{r, Finding 5 , echo=TRUE}
default_age <- filter(select(bank, default,age), default == "yes")
mean_age <- summarize(group_by(default_age, default), age = mean(age))
max_age <- summarize(group_by(default_age, default), age = max(age))
min_age <- summarize(group_by(default_age, default), age = min(age))
# ggplot(bank, aes(age, default)) + geom_point()
ggplot(default_age, aes(age, default)) + geom_point() +
  geom_point(data = mean_age, color = 'blue', size = 5, alpha = 0.3) +
  geom_point(data = max_age, color = 'green', size = 5, alpha = 0.3) +
  geom_point(data = min_age, color = 'red', size = 5, alpha = 0.3)
```


#Finding 6
The proportion (%) of default cases that were from unemployed persons is:
```{r, Finding 6 , echo=TRUE}
default_job <- filter(select(bank, default, job), default == "yes")
nrow(filter(default_job, job == "unemployed"))/nrow(default_job) * 100
ggplot(bank) + geom_bar(aes( x = job))
```


#Finding 7
The breakdown of employment type for default cases is:
```{r, Fiding 7, echo=TRUE}
group_by(default_job, job) %>%
  summarize(n=n())
ggplot(bank) + geom_bar(mapping = aes( x = job, fill = default))
```


#Finding 8 
The breakdown of default cases by education levels with their respective mean balances is:
```{r Finding 8, echo=TRUE}
default <- filter(bank, default == "yes")
group_by(default, education) %>%
  summarise(count = n(),
            mean_balance = mean(balance))
ggplot(data = bank, mapping = aes(x = balance, fill = education)) + geom_histogram()

```


#Finding 9
The breakdown of default cases by marital status with their respective mean balances is:
```{r, Finding 9, echo=TRUE}
group_by(default, marital) %>%
  summarise(count = n(),
            mean_balance = mean(balance))
ggplot(data = bank, mapping = aes(x = balance, fill = marital)) + geom_histogram()

```


#Finding 10
The proportion of default cases that are married, have a secondary education, and have a housing loan is:
```{r, Fiding 10, echo = TRUE}
default_married_secondary_housing <- filter(bank, default == "yes"& marital == "married" & education == "secondary" & housing == "yes")
nrow(default_married_secondary_housing)/nrow(default)
ggplot(bank) + geom_bar(mapping = aes(x = education, fill = housing))
```

