---
title: "FE8828 Assignment for Exploratory Data Analysis"
author: "Wu Kaibin"
date: "November 28, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(lubridate)
library(bizdays)
knitr::opts_chunk$set(echo = TRUE, fig.align="center", collapse=TRUE, cache=TRUE)
bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
```

#Finding 1
The number of default cases 
% of default case
The number of loan
% of loan

```{r finding1, echo=TRUE}
nrow(filter(bank,default=="yes")) 
nrow(filter(bank,default=="yes"))*100/nrow(bank)
nrow(filter(bank,loan=="yes"))
nrow(filter(bank,loan=="yes"))*100/nrow(bank)
```

#Finding 2
The number of people in each education 
%primary
%secondary
%tertiary

```{r finding2, echo=TRUE}
group_by(bank,education)%>% 
  summarise(n = n())
nrow(filter(bank,education=="primary"))*100/nrow(bank)
nrow(filter(bank,education=="secondary"))*100/nrow(bank)
nrow(filter(bank,education=="tertiary"))*100/nrow(bank)
```

#Finding 3
The number of people and percent in each job group
The number of people in each contact type
The number of people in each poutcome
```{r finding3, echo=TRUE}
group_by(bank, job) %>% 
  summarise(n = n(),
            percent=n()/nrow(bank)*100)
group_by(bank,contact)%>% 
  summarise(n = n())
group_by(bank,poutcome)%>% 
  summarise(n = n())
```

#Finding 4
The mean balance of single with housing, vs. mean balance of married with housing

```{r finding4, echo=TRUE}
select(bank,marital,housing,balance) %>%
  filter(.,marital=="single", housing=="yes") %>%
  summarize(.,n(),mean(balance))

select(bank,marital,housing,balance) %>%
  filter(.,marital=="married", housing=="yes") %>%
  summarize(.,n(),mean(balance)) 
```

#Finding 5
mean, max,min, median and sd age of those who married


```{r finding5,echo=TRUE}
x <- select(bank,age,marital)
y<- filter(x,marital=="married")
summarize(y,mean(age),max(age),min(age),median(age),sd(age))

```

#Finding 6
Unemployment vs marital


```{r finding6,echo=TRUE}
group_by(bank, job, marital) %>%
  summarise(count = n()) %>%
  filter (., job=="unemployed")
```


#Finding 7
min, max and mean balance in each education

```{r finding7, echo=TRUE}
group_by(bank, education) %>%
  summarise(count = n(),
            min_balance=min(balance),
            max_balance = max(balance),
            mean_balance = mean(balance)
            )
```

#Finding 8
Unemployment vs education level(%)

```{r finding8, echo=TRUE}
group_by(bank, job, education) %>%
  summarise(count = n(),
            percent = n()/nrow(bank)*100) %>%
  filter (., job=="unemployed")
```

#Finding 9
Plot -> age vs sum(balance) of who default and not default

```{r finding9, echo=TRUE}
group_by(bank, age) %>%
  filter(., default=="no") %>%
  summarise(sum_balance = sum(balance),
            count = n()) -> p1
group_by(bank, age) %>%
  filter(., default=="yes") %>%
  summarise(sum_balance = sum(balance),
            count = n()) -> p2
p1
p2
plot(p1$age, p1$sum_balance)
plot(p2$age, p2$sum_balance)

```

#Finding 10
Plot -> The number of people with balance >1000:

```{r finding10, echo=TRUE}
group_by(bank,age)%>%
  filter(.,balance>1000)%>%
  summarise(count=n())->p1
p1
plot(p1$age,p1$count)

```
