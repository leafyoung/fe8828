
library(dplyr)
library(tidyverse)
library(lubridate)


df1<- data_frame(AccountNo=c(101:110), Name=c("Andy","Ben","Claire","Derek","Ester","Frederic","Gilbert","Hazel","Inman","Jack"))

df2<- data_frame(TransactionNo=c(10001:10010), Date=as.Date("2017-06-30"), AccountNo=c(101:110), TransactionType="deposit", Amount=runif(10,100000,999999), Balance=Amount, Currency="SGD")

df3<- data_frame(Currency, Conversion, Date)

#creating exchange rate table
Ex_rates<-data_frame(Date=seq(as.Date("2017-07-01"), as.Date("2017-09-30"), by="days"), USDCNY=c(6.7765,6.777059,6.78689,6.79918,6.798688,6.801557,6.801697,6.803930,6.804584,6.801144,6.801887,6.789104,6.7826,6.779731,6.777700,6.7708,6.7722,6.7538,6.7536,6.7625,6.7653,6.7653,6.755,6.7534,6.7499,6.753980,6.73907,6.7411,6.73568,6.7357,6.7247,6.7191,6.72259,6.7203,6.7222,6.7316,6.7239,6.7199,6.7057,6.6818,6.6573,6.665119,6.6645,6.6644,6.6673,6.679,6.6907,6.6746,6.6738,6.670896,6.67017,6.668152,6.6584,6.6607,6.6609,6.65697,6.6467,6.63262,6.627,6.601,6.5912,6.593,6.568,6.560,6.5579,6.5332,6.5401,6.5283,6.500,6.467,6.47,6.49,6.51,6.53,6.53,6.55,6.54,6.55,6.55,6.56,6.58,6.57,6.58,6.59,6.59,6.59,6.59,6.61,6.62,6.63,6.66,6.65), SGDUSD=c(1.3755,1.3798,1.3821,1.3820,1.3821,1.3820,1.3816,1.3816,1.3839,1.3836,1.3792,1.3763,1.3729,1.3692,1.3706,1.3693,1.3670,1.3678,1.3679,1.3636,1.3617,1.3623,1.3615,1.3616,1.3609,1.3576,1.3584,1.3559,1.3569,1.3566,1.3569,1.3592,1.3596,1.3585,1.3599,1.3605,1.3621,1.3618,1.3634,1.3636,1.3619,1.3601,1.3595,1.3615,1.3655,1.3662,1.3646,1.3637,1.3625,1.3635,1.3616,1.3615,1.3617,1.3617,1.3613,1.3583,1.3551,1.3555,1.3547,1.3533,1.3563,1.3578,1.3562,1.3530,1.3575,1.3569,1.3540,1.3513,1.3439,1.3389,1.3414,1.3413,1.3442,1.3465,1.3473,1.3495,1.3454,1.3440,1.3450,1.3461,1.4373,1.3458,1.3510,1.3465,1.3455,1.3474,1.3493,1.3534,1.3582,1.3596,1.3574,1.3574), SGDCNY="")
Ex_rates<-mutate(Ex_rates, SGDCNY=  USDCNY/SGDCNY)

#generate 20 random transactions

for (i in 1:20){
df2<-rbind(df2, df6<-data_frame(TransactionNo=tail(df2$TransactionNo,1)+1, Date=as.Date(tail(df2$Date,1)+runif(1,0,4)), AccountNo=as.integer(runif(1,101,110)), TransactionType=sample(c("deposit", "withdraw"),1), Amount=runif(1,3000,5000)*(ifelse(TransactionType=="withdraw",-1,1)), Balance="", Currency="SGD"))
df7<-aggregate(Amount~AccountNo,df2,sum)
df2$Balance[nrow(df2)]=df7[df6$AccountNo-100,2]
}







