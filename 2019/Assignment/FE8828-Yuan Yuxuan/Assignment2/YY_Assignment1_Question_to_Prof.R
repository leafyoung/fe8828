#This R script is used to cross check my answer for Assignment1 and bizdays library answer

library(bizdays)

#Bacuase bizdays exlusdes starting day, I put start date as the last day of the prevous year
bizdays("1999-12-31", "2000-12-31", "weekends")
##[1] 260
count_bizday(2000)
##[1] 260

#Difference Appears
bizdays("2000-12-31", "2001-12-31", "weekends")
##[1] 260
count_bizday(2001)
##[1] 261

bizdays("2001-12-31", "2002-12-31", "weekends")
##[1] 261
count_bizday(2002)
##[1] 261

bizdays("2002-12-31", "2003-12-31", "weekends")
##[1] 261
count_bizday(2003)
##[1] 261

bizdays("2003-12-31", "2004-12-31", "weekends")
##[1] 262
count_bizday(2004)
##[1] 262

bizdays("2004-12-31", "2005-12-31", "weekends")
##[1] 260
count_bizday(2005)
##[1] 260

#Difference Appears
bizdays("2005-12-31", "2006-12-31", "weekends")
##[1] 259
count_bizday(2006)
##[1] 260

#Difference Appears
bizdays("2006-12-31", "2007-12-31", "weekends")
##[1] 260
count_bizday(2007)
##[1] 261

bizdays("2007-12-31", "2008-12-31", "weekends")
##[1] 262
count_bizday(2008)
##[1] 262

bizdays("2008-12-31", "2009-12-31", "weekends")
##[1] 261
count_bizday(2009)
##[1] 261

#Based on the result above, I observed the result difference between my answer and bizdays library for year 2006, 2005 and 2001
#I have mannually counted theses three years' weekdays, I believe my answer is accurate
#Futher looking at the library answer, it's bizseq result does not match its bizdays result. Following is the example for 2006

length(bizseq("2006-01-01", "2006-12-31", cal = "weekends"))
##[1] 260
bizseq("2006-01-01", "2006-12-31", cal = "weekends")
##[1] "2006-01-02" "2006-01-03" "2006-01-04" "2006-01-05" "2006-01-06" "2006-01-09" "2006-01-10" "2006-01-11" "2006-01-12" "2006-01-13" "2006-01-16" "2006-01-17" "2006-01-18"
##[14] "2006-01-19" "2006-01-20" "2006-01-23" "2006-01-24" "2006-01-25" "2006-01-26" "2006-01-27" "2006-01-30" "2006-01-31" "2006-02-01" "2006-02-02" "2006-02-03" "2006-02-06"
##[27] "2006-02-07" "2006-02-08" "2006-02-09" "2006-02-10" "2006-02-13" "2006-02-14" "2006-02-15" "2006-02-16" "2006-02-17" "2006-02-20" "2006-02-21" "2006-02-22" "2006-02-23"
##[40] "2006-02-24" "2006-02-27" "2006-02-28" "2006-03-01" "2006-03-02" "2006-03-03" "2006-03-06" "2006-03-07" "2006-03-08" "2006-03-09" "2006-03-10" "2006-03-13" "2006-03-14"
##[53] "2006-03-15" "2006-03-16" "2006-03-17" "2006-03-20" "2006-03-21" "2006-03-22" "2006-03-23" "2006-03-24" "2006-03-27" "2006-03-28" "2006-03-29" "2006-03-30" "2006-03-31"
##[66] "2006-04-03" "2006-04-04" "2006-04-05" "2006-04-06" "2006-04-07" "2006-04-10" "2006-04-11" "2006-04-12" "2006-04-13" "2006-04-14" "2006-04-17" "2006-04-18" "2006-04-19"
##[79] "2006-04-20" "2006-04-21" "2006-04-24" "2006-04-25" "2006-04-26" "2006-04-27" "2006-04-28" "2006-05-01" "2006-05-02" "2006-05-03" "2006-05-04" "2006-05-05" "2006-05-08"
##[92] "2006-05-09" "2006-05-10" "2006-05-11" "2006-05-12" "2006-05-15" "2006-05-16" "2006-05-17" "2006-05-18" "2006-05-19" "2006-05-22" "2006-05-23" "2006-05-24" "2006-05-25"
##[105] "2006-05-26" "2006-05-29" "2006-05-30" "2006-05-31" "2006-06-01" "2006-06-02" "2006-06-05" "2006-06-06" "2006-06-07" "2006-06-08" "2006-06-09" "2006-06-12" "2006-06-13"
##[118] "2006-06-14" "2006-06-15" "2006-06-16" "2006-06-19" "2006-06-20" "2006-06-21" "2006-06-22" "2006-06-23" "2006-06-26" "2006-06-27" "2006-06-28" "2006-06-29" "2006-06-30"
##[131] "2006-07-03" "2006-07-04" "2006-07-05" "2006-07-06" "2006-07-07" "2006-07-10" "2006-07-11" "2006-07-12" "2006-07-13" "2006-07-14" "2006-07-17" "2006-07-18" "2006-07-19"
##[144] "2006-07-20" "2006-07-21" "2006-07-24" "2006-07-25" "2006-07-26" "2006-07-27" "2006-07-28" "2006-07-31" "2006-08-01" "2006-08-02" "2006-08-03" "2006-08-04" "2006-08-07"
##[157] "2006-08-08" "2006-08-09" "2006-08-10" "2006-08-11" "2006-08-14" "2006-08-15" "2006-08-16" "2006-08-17" "2006-08-18" "2006-08-21" "2006-08-22" "2006-08-23" "2006-08-24"
##[170] "2006-08-25" "2006-08-28" "2006-08-29" "2006-08-30" "2006-08-31" "2006-09-01" "2006-09-04" "2006-09-05" "2006-09-06" "2006-09-07" "2006-09-08" "2006-09-11" "2006-09-12"
##[183] "2006-09-13" "2006-09-14" "2006-09-15" "2006-09-18" "2006-09-19" "2006-09-20" "2006-09-21" "2006-09-22" "2006-09-25" "2006-09-26" "2006-09-27" "2006-09-28" "2006-09-29"
##[196] "2006-10-02" "2006-10-03" "2006-10-04" "2006-10-05" "2006-10-06" "2006-10-09" "2006-10-10" "2006-10-11" "2006-10-12" "2006-10-13" "2006-10-16" "2006-10-17" "2006-10-18"
##[209] "2006-10-19" "2006-10-20" "2006-10-23" "2006-10-24" "2006-10-25" "2006-10-26" "2006-10-27" "2006-10-30" "2006-10-31" "2006-11-01" "2006-11-02" "2006-11-03" "2006-11-06"
##[222] "2006-11-07" "2006-11-08" "2006-11-09" "2006-11-10" "2006-11-13" "2006-11-14" "2006-11-15" "2006-11-16" "2006-11-17" "2006-11-20" "2006-11-21" "2006-11-22" "2006-11-23"
##[235] "2006-11-24" "2006-11-27" "2006-11-28" "2006-11-29" "2006-11-30" "2006-12-01" "2006-12-04" "2006-12-05" "2006-12-06" "2006-12-07" "2006-12-08" "2006-12-11" "2006-12-12"
##[248] "2006-12-13" "2006-12-14" "2006-12-15" "2006-12-18" "2006-12-19" "2006-12-20" "2006-12-21" "2006-12-22" "2006-12-25" "2006-12-26" "2006-12-27" "2006-12-28" "2006-12-29"

#Could you confirm if the library result is wrong

# From Yang Ye:
# Hi, I hope that you could read the doc to find out that bizday needs 
# "Since bizdays function returnsthe amount of business days between 2 dates,
# it must start and end in business days". on Page. 4
# https://cran.r-project.org/web/packages/bizdays/bizdays.pdf near the bottom.

# What it does is to adjust start and end to be business days and output (end - start).
# Therefore, the corresponding case for your customized function count_bizday() is:
bizdays("2005-01-01", "2005-12-31", cal = "weekends") + 1
# 260
count_bizday(2005)
# 260

# Another point is that you didn't explicit write case for leap year but the adjustment based on weekdays should make it right.
# 