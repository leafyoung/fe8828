colnames(noHL)[1] <- "Balance_Without_HousingLoan"
summary(HL)
summary(noHL)
PL <- bank %>%
dplyr::select(balance, loan) %>%
dplyr::filter(loan=="yes")
noPL <- bank %>%
dplyr::select(balance, loan) %>%
dplyr::filter(loan=="no")
ggplot(PL, aes(balance)) +
geom_density(col = "red") +
geom_density(data = noPL, col = "blue")
colnames(PL)[1] <- "Balance_With_PersonalLoan"
colnames(noPL)[1] <- "Balance_Without_PersonalLoan"
summary(PL)
summary(noPL)
str(bank)
ggplot(bank, aes(y, balance)) +
geom_boxplot()
ggplot(bank, aes(y, balance)) +
geom_dotplot()
ggplot(bank, aes(y, balance)) +
geom_dotplot(binaxis="y", stackdir = "center")
summary(bank$y)
Y <- bank %>%
dplyr::select(balance, loan) %>%
dplyr::filter(loan=="yes")
noY <- bank %>%
dplyr::select(balance, loan) %>%
dplyr::filter(loan=="no")
ggplot(Y, aes(balance)) +
geom_density(col = "red") +
geom_density(data = noY, col = "blue")
colnames(Y)[1] <- "Balance_TermDeposit"
colnames(noY)[1] <- "Balance_NoTermDeposit"
summary(Y)
summary(noY)
summary(bank$y)
Y <- bank %>%
dplyr::select(balance, y) %>%
dplyr::filter(y=="yes")
noY <- bank %>%
dplyr::select(balance, y) %>%
dplyr::filter(y=="no")
ggplot(Y, aes(balance)) +
geom_density(col = "red") +
geom_density(data = noY, col = "blue")
colnames(Y)[1] <- "Balance_TermDeposit"
colnames(noY)[1] <- "Balance_NoTermDeposit"
summary(Y)
summary(noY)
str(data)
str(bank)
bank$poutcome
str(bank)
df <- bank %>%
dplyr::select(poutcome, y) %>%
dplyr::group_by(y) %>%
dplyr::summarise(n=n())
df
df <- bank %>%
dplyr::select(poutcome, y) %>%
dplyr::group_by(y) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(y, n, fill=0)
df
df <- bank %>%
dplyr::select(poutcome, y) %>%
dplyr::group_by(y, poutcome) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(y, n, fill=0)
df
summary(bank$poutcome)
df$Pct_Yes <- df$yes / (df$yes + df$no)
df
str(bank)
bank$contact
levels(bank$contact)
str(bank)
plot(bank$previous, bank$campaign)
plot(bank$poutcome, bank$campaign)
plot(bank$previous, bank$campaign)
ggplot(bank, aes(previous, campaign)) +
geom_point() +
geom_smooth(method="lm")
ggplot(bank, aes(poutcome, campaign)) +
geom_dotplot()
ggplot(bank, aes(poutcome, campaign)) +
geom_dotplot(binaxis="y", stackdir = "center")
colnames(bank)
ggplot(bank, aes(pdays, campaign)) +
geom_points()
ggplot(bank, aes(pdays, campaign)) +
geom_points()
ggplot(bank, aes(pdays, campaign)) +
geom_point()
ggplot(bank, aes(pdays, campaign)) +
geom_point() +
geom_smooth(method="lm")
str(data)
str(bank)
ggplot(bank, aes(duration, y)) +
geom_point() +
geom_smooth(method="lm")
ggplot(bank, aes(duration, y)) +
geom_jitter() +
plot(bank$previous, bank$campaign)
ggplot(bank, aes(duration, y)) +
geom_jitter()
ggplot(bank, aes(y, duration)) +
geom_boxplot()
ggplot(bank, aes(y, duration)) +
geom_violin()
ggplot(bank, aes(y, duration)) +
geom_violin(scale="area")
ggplot(bank, aes(y, duration)) +
geom_violin()
ggplot(bank, aes(y, duration)) +
geom_boxplot()
plot(bank$default, bank$campaign)
df <- bank %>%
dplyr::select(poutcome, campaign) %>%
dplyr::group_by(poutcome) %>%
dplyr::summarise(min=min(), max=max(), mean=mean(), median=median())
df
df <- bank %>%
dplyr::select(poutcome, campaign) %>%
dplyr::group_by(poutcome) %>%
dplyr::summarise(min=min(), max=max(), mean=mean(campaign), median=median())
str(bank)
df <- bank %>%
dplyr::select(poutcome, campaign) %>%
dplyr::group_by(poutcome) %>%
dplyr::summarise(mean=mean(campaign), median=median())
df
df <- bank %>%
dplyr::select(poutcome, campaign) %>%
dplyr::group_by(poutcome) %>%
dplyr::summarise(mean=mean(campaign))
df
plot(bank$contact, bank$balance)
plot(bank$campaign, bank$balance)
plot(bank$balance, bank$campaign)
ggplot(bank, aes(balance, campaign)) +
geom_smooth(method="lm")
ggplot(bank, aes(balance, campaign)) +
geom_smooth(method="lm") +
geom_quantile()
ggplot(bank, aes(balance, campaign)) +
geom_smooth(method="lm")
ggplot(bank, aes(job, campaign)) +
geom_jitter()
ggplot(bank, aes(job, campaign)) +
geom_boxplot()
df <- bank %>%
dplyr::select(job, campaign) %>%
dplyr::group_by(job) %>%
dplyr::summarise(mean=mean(campaign))
df
df <- bank %>%
dplyr::select(job, campaign) %>%
dplyr::group_by(job) %>%
dplyr::summarise(mean=mean(campaign))
df
df <- bank %>%
dplyr::select(job, poutcome, y) %>%
dplyr::group_by(job, poutcome, y) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(y, n, fill=0)
df
df <- bank %>%
dplyr::select(job, y) %>%
dplyr::group_by(job, y) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(y, n, fill=0)
df
df$Pct_Yes <- df$yes / (df$yes + df$no)
df
df <- bank %>%
dplyr::select(poutcome, y) %>%
dplyr::group_by(y, poutcome) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(y, n, fill=0)
df$Pct_Yes <- df$yes / (df$yes + df$no)
df <- df[order(df$Pct_Yes)]
df
df <- df[order(df$Pct_Yes)]
df
df <- df[order(df$Pct_Yes),]
df
df <- df[order(df$Pct_Yes, decreasing = T),]
df
df <- bank %>%
dplyr::select(poutcome, y) %>%
dplyr::group_by(y, poutcome) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(y, n, fill=0)
df$Pct_Yes <- df$yes / (df$yes + df$no)
df <- df[order(df$Pct_Yes, decreasing = T),]
df
df <- bank %>%
dplyr::select(job, y) %>%
dplyr::group_by(y, job) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(y, n, fill=0)
df$Pct_Yes <- df$yes / (df$yes + df$no)
df <- df[order(df$Pct_Yes, decreasing = T),]
df
ggplot(bank, aes(education, job)) +
geom_jitter(aes(colour=job))
df <- bank %>%
dplyr::select(education, job) %>%
dplyr::group_by(education, job) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(job, n, fill=0)
col <- df$education
df$education <- NULL
df <- as.data.frame(t(df))
colnames(df) <- col
for (i in 1:ncol(df)){
df[i] <- df[i] / colSums(df)[i] * 100
}
df
str(data)
str(bank)
df <- bank %>%
dplyr::select(job, default) %>%
dplyr::group_by(job, default) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(job, n, fill=0)
df
col <- df$default
df$default <- NULL
df
df <- as.data.frame(t(df))
df
colnames(df) <- col
df
for (i in 1:ncol(df)){
df[i] <- df[i] / colSums(df)[i] * 100
}
df
df <- bank %>%
dplyr::select(job, default) %>%
dplyr::group_by(job, default) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(job, n, fill=0)
col <- df$default
df$default <- NULL
df <- as.data.frame(t(df))
colnames(df) <- col
df
df$Pct_Default <- df$yes / (df$yes + df$no)
df
df
df$Pct_Default <- df$yes / (df$yes + df$no) * 100
df
df
df <- df[order(df$Pct_Default, decreasing = T),]
df
library(caret)
str(bank)
dummyvar <- dummyVars(~., data = bank, fullRank = T)
dummyvar
bank_dummy <- data.frame(predict(dummyvar, newdata = bank))
bank_dummy
colnames(bank_dummy)
corr
?corr
?cor
cor(bank_dummy)
attitude
str(atrtitude)
str(attitude)
fights_stats1$outcome <- as.numeric(fights_stats1$outcome)
dummyvar <- dummyVars(~., data = bank, fullRank = F)
bank_dummy <- data.frame(predict(dummyvar, newdata = bank))
library(reshape2)
qplot(x = Var1, y = Var2,
data = melt(cor(bank_dummy)),
fill = value,
geom = "tile")
str(data)
str(bank)
df <- bank %>%
dplyr::select(loan, housing, default) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(job, n, fill=0)
df
df <- bank %>%
dplyr::select(loan, housing, default) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(default, n, fill=0)
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(default, n, fill=0)
df <- bank %>%
dplyr::select(loan, housing, default) %>%
dplyr::group_by(default, loan) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(default, n, fill=0)
df
df <- bank %>%
dplyr::select(default, housing) %>%
dplyr::group_by(job, default) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(job, n, fill=0)
df <- bank %>%
dplyr::select(default, housing) %>%
dplyr::group_by(housing, default) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(job, n, fill=0)
df <- bank %>%
dplyr::select(default, housing) %>%
dplyr::group_by(housing, default) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(housing, n, fill=0)
df
df_1 <- bank %>%
dplyr::select(default, housing) %>%
dplyr::group_by(housing, default) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(housing, n, fill=0)
df_2 <- bank %>%
dplyr::select(default, loan) %>%
dplyr::group_by(loan, default) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(loan, n, fill=0)
df1
df_1
df_2
sum(df_1[2])
sum(df_1[2,])
sum(df_1[2,c(2,3)])
df <- data.frame(Pct_Default_HousingLoan = df_1[2,3] / sum(df_1[2, c(2,3)]),
Pct_Default_PersonalLoan = df_2[2,3] / sum(df_2[2, c(2,3)]))
df
df
df <- data.frame(Pct_Default_HousingLoan = as.numeric(df_1[2,3] / sum(df_1[2, c(2,3)])),
Pct_Default_PersonalLoan = as.numeric(df_2[2,3] / sum(df_2[2, c(2,3)])))
df
df <- data.frame(Pct_Default_HousingLoan = as.numeric(df_1[2,3] / sum(df_1[, 3])),
Pct_Default_PersonalLoan = as.numeric(df_2[2,3] / sum(df_2[, 3])))
df
45/(2514/45)
45/(2514+45)
setwd("C:/Users/Matthew/Desktop/MFE/MT2/FE8828 - Programming Web Applications in Finance/source/FE8828-Chan Siew Yuen Matthew/Assignment 3")
library(dplyr)
library(tidyr)
bank <- read.csv("https://goo.gl/PBQnBt", sep = ";")
df <- bank %>%
dplyr::select(education, job) %>%
dplyr::group_by(education, job) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(job, n, fill=0)
col <- df$education
df$education <- NULL
df <- as.data.frame(t(df))
colnames(df) <- col
for (i in 1:ncol(df)){
df[i] <- df[i] / colSums(df)[i] * 100
}
df
model <- lm(balance~age, bank)
summary(model)
plot(model$residuals)
bank2 <- bank
bank2$balance <- log(bank2$balance - (min(bank2$balance)-1))
bank2$balance[!is.finite(bank2$balance)] <- NA
bank2 <- na.omit(bank2)
model2 <- lm(balance~age, bank2)
summary(model2)
plot(model2$residuals)
df <- bank %>%
dplyr::select(job, default) %>%
dplyr::group_by(job, default) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(job, n, fill=0)
col <- df$default
df$default <- NULL
df <- as.data.frame(t(df))
colnames(df) <- col
df$Pct_Default <- df$yes / (df$yes + df$no) * 100
df <- df[order(df$Pct_Default, decreasing = T),]
df
df_1 <- bank %>%
dplyr::select(default, housing) %>%
dplyr::group_by(housing, default) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(housing, n, fill=0)
colnames(df_1) <- c("Default_With_HousingLoan", "No_Credit_In_Default", "Has_Credit_In_Default")
df_2 <- bank %>%
dplyr::select(default, loan) %>%
dplyr::group_by(loan, default) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(loan, n, fill=0)
colnames(df_2) <- c("Default_With_PersonalLoan", "No_Credit_In_Default", "Has_Credit_In_Default")
df <- data.frame(Pct_Default_withHousingLoan = as.numeric(df_1[2,3] / sum(df_1[, 3])),
Pct_Default_withPersonalLoan = as.numeric(df_2[2,3] / sum(df_2[, 3])))
df_1
df_2
df
df <- bank %>%
dplyr::select(poutcome, y) %>%
dplyr::group_by(y, poutcome) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(y, n, fill=0)
df$Pct_Yes <- df$yes / (df$yes + df$no)
df <- df[order(df$Pct_Yes, decreasing = T),]
df
df <- bank %>%
dplyr::select(job, y) %>%
dplyr::group_by(y, job) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(y, n, fill=0)
df$Pct_Yes <- df$yes / (df$yes + df$no)
df <- df[order(df$Pct_Yes, decreasing = T),]
df
df <- bank %>%
dplyr::select(poutcome, campaign) %>%
dplyr::group_by(poutcome) %>%
dplyr::summarise(mean=mean(campaign))
df
str(bank)
warnings()
str(bank)
df
df <- bank %>%
dplyr::group_by(default) %>%
dplyr::summarise(mean_contact=mean(contact))
df
df <- bank %>%
dplyr::select(default, contact) %>%
dplyr::group_by(default) %>%
dplyr::summarise(mean_contact=mean(contact))
df
df <- bank %>%
dplyr::group_by(default) %>%
dplyr::summarise(mean_contact=mean(campaign))
df
summary(bank$default)
df
df <- bank %>%
dplyr::select(default, y) %>%
dplyr::group_by(y, default) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(default, n, fill=0)
df
df$Pct_Yes <- df$yes / (df$yes + df$no)
df
df <- bank %>%
dplyr::select(default, y) %>%
dplyr::group_by(y, default) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(default, n, fill=0)
df
summary(bank$default)
df <- bank %>%
dplyr::select(default, y) %>%
dplyr::group_by(default, y) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(default, n, fill=0)
df$Pct_Yes <- df$yes / (df$yes + df$no)
df
df <- bank %>%
dplyr::select(default, y) %>%
dplyr::group_by(default, y) %>%
dplyr::summarise(n=n()) %>%
dplyr::ungroup() %>%
spread(y, n, fill=0)
df$Pct_Yes <- df$yes / (df$yes + df$no)
df
colnames(df) <- c("Default", "Agree_TermDeposit", "Disagree_TermDeposit")
df
df
colnames(df) <- c("CreditInDefault", "Agree_TermDeposit", "Disagree_TermDeposit")
df
df
df1 <- bank %>% dplyr::filter(default=="yes")
str(df1)
summary(df1$balance)
df <- bank %>%
dplyr::group_by(default) %>%
dplyr::summarise(mean_balance=mean(balance))
df
